(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    516411,      13133]
NotebookOptionsPosition[    491192,      12317]
NotebookOutlinePosition[    491828,      12342]
CellTagsIndexPosition[    491740,      12337]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["TexAct", "Title",
 FontColor->RGBColor[1, 0, 0]],

Cell[TextData[{
 "Tex code to format ",
 StyleBox["xAct",
  FontSlant->"Italic"],
 " expressions"
}], "Subtitle",
 FontColor->RGBColor[0, 0, 1]],

Cell[TextData[{
 StyleBox["Thomas B\[ADoubleDot]ckdahl, Jos\[EAcute] M. Mart\[IAcute]n-Garc\
\[IAcute]a and Barry Wardell\n",
  FontSize->18],
 "(c) 2008-2013, under GPL\n\nt.backdahl@ed.ac.uk, jose@xact.es, \
barry.wardell@gmail.com\nhttp://www.xact.es/\n\
http://groups.google.com/group/xact"
}], "Subsubtitle",
 CellChangeTimes->{{3.588319343807869*^9, 3.58831935009468*^9}}],

Cell[TextData[{
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " has a function TeXForm but does not behave well with the indexed \
expressions of ",
 StyleBox["xAct",
  FontSlant->"Italic"],
 ". We construct our own Tex function, which starts from the internal form, \
and not the box-form of the expression. The objective is building a ",
 Cell[BoxData[
  StyleBox[
   RowBox[{"T", 
    AdjustmentBox["E",
     BoxBaselineShift->0.5,
     BoxMargins->{{-0.075, -0.085}, {0, 0}}], "X"}]]]],
 " string from our expression.\n\nJose: This package has been excised from ",
 StyleBox["xTensor",
  FontSlant->"Italic"],
 " in April 2012, to make it easier to mantain, and to acknowledge the \
essential contributions by Thomas and Barry."
}], "Text"],

Cell[CellGroupData[{

Cell["1. Info and copyright", "Section",
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IntegerPart", "/@", 
  RowBox[{"Date", "[", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2014", ",", "9", ",", "24", ",", "11", ",", "16", ",", "10"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.5823477930655117`*^9, 3.5823538523052473`*^9, 3.582353965329653*^9, 
   3.5831307193782206`*^9, 3.5831330395556955`*^9, 3.5831331194434357`*^9, 
   3.5831331943869677`*^9, 3.583133301013155*^9, 3.5831333331336117`*^9, 
   3.583135197961887*^9, 3.583135323417307*^9, 3.583138082159353*^9, 
   3.583138207366173*^9, 3.5831465495820775`*^9, 3.5831466207806025`*^9, 
   3.583146826919365*^9, {3.5831473693021173`*^9, 3.5831473950265627`*^9}, 
   3.583148785146004*^9, 3.58314993244862*^9, 3.5831500174843693`*^9, 
   3.583150170910639*^9, 3.5831502218447285`*^9, 3.5831502703452134`*^9, {
   3.587965182306658*^9, 3.587965191339073*^9}, 3.588079848020785*^9, 
   3.588079928394126*^9, 3.588080068326372*^9, 3.588080145624508*^9, 
   3.588080233577462*^9, 3.588082911717373*^9, 3.5880832163547087`*^9, 
   3.5880836639038944`*^9, 3.5883166135982733`*^9, 3.5883188308633676`*^9, 
   3.5883190060672755`*^9, 3.5883191564671392`*^9, 3.588325825204837*^9, 
   3.5883259566818676`*^9, 3.588326914992551*^9, 3.5883278584988084`*^9, 
   3.5883279276225295`*^9, 3.5883280175098877`*^9, 3.5883284717982855`*^9, 
   3.5883285560072336`*^9, 3.588329395445708*^9, {3.5883296794754066`*^9, 
   3.588329702298247*^9}, 3.5883299107136116`*^9, 3.5915970611588764`*^9, 
   3.615130824346857*^9, 3.6151310067008815`*^9, 3.616396078100806*^9, 
   3.619089164720086*^9, 3.619626213739156*^9, 3.6205425701785765`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xAct`TexAct`$Version", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<0.3.5\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"2014", ",", "9", ",", "24"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"xAct`TexAct`$xTensorVersionExpected", "=", "\[NoBreak]", 
   RowBox[{"{", 
    RowBox[{"\"\<1.1.0\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"2013", ",", "9", ",", "1"}], "}"}]}], "}"}]}], ";"}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{
  3.5823488397659507`*^9, 3.5823539492460246`*^9, {3.5831333219015913`*^9, 
   3.583133322010792*^9}, {3.5879638383954973`*^9, 3.587963840579501*^9}, 
   3.5880787423376427`*^9, 3.588083651205472*^9, 3.5883137977378454`*^9, {
   3.591597033388838*^9, 3.591597036448842*^9}, {3.5954314609808283`*^9, 
   3.5954314632908316`*^9}, {3.600408511015876*^9, 3.60040852208534*^9}, {
   3.6045913980967226`*^9, 3.6045914107867403`*^9}, 3.6045943202781663`*^9, 
   3.605013910401615*^9, {3.60507629620798*^9, 3.6050762966379805`*^9}, {
   3.6057872636435833`*^9, 3.605787266883588*^9}, {3.610714865122167*^9, 
   3.610714868492172*^9}, {3.615198531523444*^9, 3.6151985342034483`*^9}, {
   3.616396057200777*^9, 3.616396063850786*^9}, {3.6165061318174706`*^9, 
   3.6165061322274714`*^9}, {3.6190834395221305`*^9, 
   3.6190834410521326`*^9}, {3.6196262023491397`*^9, 
   3.6196262024891396`*^9}, {3.6205408934909396`*^9, 3.62054089374094*^9}, {
   3.620542560838563*^9, 3.6205425611385636`*^9}}],

Cell[CellGroupData[{

Cell["1.0. TODO LIST", "Subsection"],

Cell["Fix SeriesData.", "Text",
 CellChangeTimes->{{3.6057872245735283`*^9, 3.605787252143567*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["1.1. GPL", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"TexAct", ",", " ", 
    RowBox[{
    "Tex", " ", "code", " ", "to", " ", "format", " ", "xAct", " ", 
     "expressions"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Copyright", " ", 
      RowBox[{"(", "C", ")"}], " ", "2008"}], "-", 
     RowBox[{"2013", " ", "Thomas", " ", "B\[ADoubleDot]ckdahl"}]}], ",", " ", 
    RowBox[{
     RowBox[{"Jose", " ", 
      RowBox[{"M", ".", " ", "Martin"}]}], "-", 
     RowBox[{"Garcia", " ", "and", " ", "Barry", " ", "Wardell"}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "This", " ", "program", " ", "is", " ", "free", " ", "software"}], ";", 
     " ", 
     RowBox[{"you", " ", "can", " ", "redistribute", " ", "it", " ", 
      RowBox[{"and", "/", "or"}], " ", "modify", "\[IndentingNewLine]", " ", 
      "it", " ", "under", " ", "the", " ", "terms", " ", "of", " ", "the", 
      " ", "GNU", " ", "General", " ", "Public", " ", "License", " ", "as", 
      " ", "published", "\[IndentingNewLine]", " ", "by", " ", "the", " ", 
      "Free", " ", "Software", " ", "Foundation"}], ";", " ", 
     RowBox[{
     "either", " ", "version", " ", "2", " ", "of", " ", "the", " ", 
      "License"}]}], ",", "\[IndentingNewLine]", "  ", 
    RowBox[{"or", " ", 
     RowBox[{"(", 
      RowBox[{"at", " ", "your", " ", "option"}], ")"}], " ", "any", " ", 
     "later", " ", 
     RowBox[{
     "version", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "This"}], 
     " ", "program", " ", "is", " ", "distributed", " ", "in", " ", "the", 
     " ", "hope", " ", "that", " ", "it", " ", "will", " ", "be", " ", 
     "useful"}], ",", "\[IndentingNewLine]", "  ", 
    RowBox[{
     RowBox[{"but", " ", "WITHOUT", " ", "ANY", " ", "WARRANTY"}], ";", " ", 
     RowBox[{
     "without", " ", "even", " ", "the", " ", "implied", " ", "warranty", " ",
       "of", "\[IndentingNewLine]", " ", "MERCHANTABILITY", " ", "or", " ", 
      "FITNESS", " ", "FOR", " ", "A", " ", "PARTICULAR", " ", 
      RowBox[{"PURPOSE", ".", " ", "See"}], " ", "the", " ", "GNU", 
      "\[IndentingNewLine]", " ", "General", " ", "Public", " ", "License", 
      " ", "for", " ", "more", " ", 
      RowBox[{
      "details", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "You"}], 
      " ", "should", " ", "have", " ", "received", " ", "a", " ", "copy", " ",
       "of", " ", "the", " ", "GNU", " ", "General", " ", "Public", " ", 
      "License", "\[IndentingNewLine]", " ", "along", " ", "with", " ", 
      "this", " ", "program"}], ";", " ", 
     RowBox[{"if", " ", "not"}]}], ",", " ", 
    RowBox[{
    "write", " ", "to", " ", "the", " ", "Free", " ", "Software", 
     "\[IndentingNewLine]", " ", "Foundation"}], ",", " ", 
    RowBox[{"Inc", "."}], ",", " ", 
    RowBox[{
     RowBox[{"59", " ", "Temple", " ", "Place"}], "-", 
     RowBox[{"Suite", " ", "330"}]}], ",", " ", "Boston", ",", " ", 
    RowBox[{
     RowBox[{"MA", " ", "02111"}], "-", "1307"}], ",", "\[IndentingNewLine]", 
    "  ", 
    RowBox[{"USA", "."}]}], " ", "\[IndentingNewLine]", "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.5449471950564704`*^9, 3.582278943553317*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["1.2. Info package", "Subsection"],

Cell["\<\
(* :Title: TexAct *)

(* :Author: Thomas B\[ADoubleDot]ckdahl, Jose M. Martin-Garcia and Barry \
Wardell *)

(* :Summary: Tex code to format xAct expressions *)

(* :Brief Discussion:
*)
  
(* :Context: xAct`Texsor` *)

(* :Package Version: 0.3.2 *)

(* :Copyright: Thomas B\[ADoubleDot]ckdahl, Jose M. Martin-Garcia and Barry \
Wardell (2008-2013) *)

(* :History: see TexAct.History file *)

(* :Keywords: *)

(* :Source: Texsor.nb *)

(* :Warning: *)

(* :Mathematica Version: 5.1 and later *)

(* :Limitations: *)\
\>", "Input",
 PageWidth->PaperWidth,
 CellMargins->{{60, -272}, {Inherited, Inherited}},
 InitializationCell->True,
 CellChangeTimes->{{3.544946637526091*^9, 3.5449466474633083`*^9}, {
  3.58227895676654*^9, 3.5822789710405655`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["1.3. BeginPackage", "Subsection"],

Cell["Last package read in a session:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Unevaluated", "[", "xAct`xCore`Private`$LastPackage", "]"}], "===",
      "xAct`xCore`Private`$LastPackage"}], ",", 
    RowBox[{
    "xAct`xCore`Private`$LastPackage", "=", "\"\<xAct`TexAct`\>\""}]}], "]"}],
   ";"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData["xAct`xCore`Private`$LastPackage"], "Input"],

Cell[BoxData["\<\"xAct`TexAct`\"\>"], "Output",
 CellChangeTimes->{
  3.582347793096712*^9, 3.582353852367647*^9, 3.5823539653920527`*^9, 
   3.5831307194250207`*^9, 3.5831330396180964`*^9, 3.5831331195058365`*^9, 
   3.5831331944337683`*^9, 3.5831333011223555`*^9, 3.5831333331804113`*^9, 
   3.583135197993087*^9, 3.5831353234641075`*^9, 3.583138082252953*^9, 
   3.583138207444173*^9, 3.583146549722478*^9, 3.5831466208586025`*^9, 
   3.5831468270129647`*^9, {3.5831473693333178`*^9, 3.583147395120163*^9}, 
   3.5831487852396045`*^9, 3.5831499325578203`*^9, 3.5831500175779696`*^9, 
   3.5831501710198393`*^9, 3.5831502219539285`*^9, 3.5831502704544134`*^9, {
   3.5879651823378572`*^9, 3.5879651914014735`*^9}, 3.588079848051985*^9, 
   3.5880799284409266`*^9, 3.588080068373172*^9, 3.5880801456713076`*^9, 
   3.5880802336242623`*^9, 3.5880829117641735`*^9, 3.5880832164015083`*^9, 
   3.588083663950694*^9, 3.588316613629473*^9, 3.5883188309101677`*^9, 
   3.5883190061140757`*^9, 3.5883191564983397`*^9, 3.588325825236037*^9, 
   3.588325956713068*^9, 3.5883269150237513`*^9, 3.5883278585456085`*^9, 
   3.58832792765373*^9, 3.5883280175410876`*^9, 3.588328471829486*^9, 
   3.5883285560384336`*^9, 3.5883293954769077`*^9, {3.588329679506607*^9, 
   3.588329702345047*^9}, 3.588329910744812*^9, 3.615130824386857*^9, 
   3.6151310067476816`*^9, 3.619089164740086*^9, 3.6196262137691555`*^9, 
   3.620542570198576*^9}]
}, Open  ]],

Cell[TextData[{
 "Explicit (not hidden) import of ",
 StyleBox["xCore",
  FontSlant->"Italic"],
 ",  ",
 StyleBox["xPerm",
  FontSlant->"Italic"],
 " and ",
 StyleBox["ExpressionManipulation",
  FontSlant->"Italic"],
 " (the latter is not automatically read from version 0.6.2 of ",
 StyleBox["xCore",
  FontSlant->"Italic"],
 "):"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BeginPackage", "[", 
  RowBox[{"\"\<xAct`TexAct`\>\"", ",", 
   RowBox[{"{", 
    RowBox[{
    "\"\<xAct`xCore`\>\"", ",", "\"\<xAct`xPerm`\>\"", ",", 
     "\"\<xAct`xTensor`\>\""}], "}"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{3.588329702423047*^9, 3.5883299108384123`*^9, 
  3.615130824446857*^9, 3.6151310068256817`*^9, 3.6190891648100863`*^9, 
  3.6196262138391557`*^9, 3.6205425702585764`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`xPerm`  version \"\>", 
   "\[InvisibleSpace]", "\<\"1.2.1\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2014", ",", "2", ",", "15"}], "}"}]}],
  SequenceForm["Package xAct`xPerm`  version ", "1.2.1", ", ", {2014, 2, 15}],
  
  Editable->False]], "Print",
 CellChangeTimes->{3.588329702423047*^9, 3.5883299108384123`*^9, 
  3.615130824446857*^9, 3.6151310068256817`*^9, 3.6190891648100863`*^9, 
  3.6196262138391557`*^9, 3.6205425702585764`*^9}],

Cell[BoxData["\<\"CopyRight (C) 2003-2014, Jose M. Martin-Garcia, under the \
General Public License.\"\>"], "Print",
 CellChangeTimes->{3.588329702423047*^9, 3.5883299108384123`*^9, 
  3.615130824446857*^9, 3.6151310068256817`*^9, 3.6190891648100863`*^9, 
  3.6196262138391557`*^9, 3.6205425702685766`*^9}],

Cell[BoxData["\<\"Connecting to external MinGW executable...\"\>"], "Print",
 CellChangeTimes->{3.588329702423047*^9, 3.5883299108384123`*^9, 
  3.615130824446857*^9, 3.6151310068256817`*^9, 3.6190891648100863`*^9, 
  3.6196262138391557`*^9, 3.6205425702985764`*^9}],

Cell[BoxData["\<\"Connection established.\"\>"], "Print",
 CellChangeTimes->{3.588329702423047*^9, 3.5883299108384123`*^9, 
  3.615130824446857*^9, 3.6151310068256817`*^9, 3.6190891648100863`*^9, 
  3.6196262138391557`*^9, 3.6205425703385763`*^9}],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{3.588329702423047*^9, 3.5883299108384123`*^9, 
  3.615130824446857*^9, 3.6151310068256817`*^9, 3.6190891648100863`*^9, 
  3.6196262138391557`*^9, 3.6205425703485765`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`xTensor`  version \"\>", 
   "\[InvisibleSpace]", "\<\"1.1.1\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2014", ",", "9", ",", "6"}], "}"}]}],
  SequenceForm["Package xAct`xTensor`  version ", "1.1.1", ", ", {2014, 9, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{3.588329702423047*^9, 3.5883299108384123`*^9, 
  3.615130824446857*^9, 3.6151310068256817`*^9, 3.6190891648100863`*^9, 
  3.6196262138391557`*^9, 3.6205425703585763`*^9}],

Cell[BoxData["\<\"CopyRight (C) 2002-2014, Jose M. Martin-Garcia, under the \
General Public License.\"\>"], "Print",
 CellChangeTimes->{3.588329702423047*^9, 3.5883299108384123`*^9, 
  3.615130824446857*^9, 3.6151310068256817`*^9, 3.6190891648100863`*^9, 
  3.6196262138391557`*^9, 3.6205425703585763`*^9}]
}, Open  ]],

Cell[BoxData["\<\"xAct`TexAct`\"\>"], "Output",
 CellChangeTimes->{
  3.5823477950935154`*^9, 3.5823538536000495`*^9, 3.582353966546455*^9, 
   3.5831307198930216`*^9, 3.5831330400080967`*^9, 3.5831331198490367`*^9, 
   3.583133194792568*^9, 3.583133301559156*^9, 3.583133333601612*^9, 
   3.5831351983362875`*^9, 3.5831353238853083`*^9, 3.583138082674154*^9, 
   3.5831382078653736`*^9, 3.5831465501124783`*^9, 3.583146621623004*^9, 
   3.5831468274029655`*^9, {3.5831473693489175`*^9, 3.583147395494563*^9}, 
   3.583148785614005*^9, 3.5831499329166207`*^9, 3.58315001796797*^9, 
   3.58315017142544*^9, 3.5831502223595295`*^9, 3.5831502708132143`*^9, {
   3.5879651823378572`*^9, 3.5879651917914743`*^9}, 3.588079848519986*^9, 
   3.5880799287997265`*^9, 3.588080068747573*^9, 3.5880801460613084`*^9, 
   3.588080234045463*^9, 3.5880829121385736`*^9, 3.588083216807109*^9, 
   3.588083664356295*^9, 3.5883166141130743`*^9, 3.5883188312845683`*^9, 
   3.5883190065352764`*^9, 3.5883191568571405`*^9, 3.588325825641638*^9, 
   3.5883259571030684`*^9, 3.588326915398152*^9, 3.588327858873209*^9, 
   3.58832792807493*^9, 3.5883280179310884`*^9, 3.5883284722350864`*^9, 
   3.588328556444034*^9, 3.5883293958357086`*^9, {3.588329679522207*^9, 
   3.5883297027506475`*^9}, 3.5883299111036124`*^9, 3.6151308246168575`*^9, 
   3.615131007122082*^9, 3.619089165010086*^9, 3.619626214039156*^9, 
   3.6205425704385767`*^9}]
}, Open  ]],

Cell[TextData[{
 "Check version of ",
 StyleBox["xTensor",
  FontSlant->"Italic"],
 ". We simply compare dates:"
}], "Text"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"Not", "@", 
    RowBox[{"OrderedQ", "@", 
     RowBox[{"Map", "[", 
      RowBox[{"Last", ",", 
       RowBox[{"{", 
        RowBox[{
        "xAct`TexAct`$xTensorVersionExpected", ",", "xAct`xTensor`$Version"}],
         "}"}]}], "]"}]}]}], ",", 
   RowBox[{"Throw", "@", 
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"General", "::", "versions"}], ",", "\"\<xTensor\>\"", ",", 
      "xAct`xTensor`$Version", ",", "xAct`TexAct`$xTensorVersionExpected"}], 
     "]"}]}]}], "]"}]], "Input",
 InitializationCell->True],

Cell["Message:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "xAct`xCore`Private`bars", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Package xAct`TexAct`  version \>\"", ",", 
    RowBox[{"xAct`TexAct`$Version", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<, \>\"", ",", 
    RowBox[{"xAct`TexAct`$Version", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{"Print", "[", 
  "\"\<CopyRight (C) 2008-2013, Thomas B\[ADoubleDot]ckdahl, Jose M. \
Martin-Garcia and Barry Wardell, under the General Public License.\>\"", 
  "]"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{
  3.5823477952651157`*^9, 3.5823538536780496`*^9, 3.5823539666088552`*^9, 
   3.583130719908622*^9, 3.583133040023697*^9, 3.583133119864637*^9, 
   3.5831331948081684`*^9, 3.583133301590356*^9, 3.5831333336172123`*^9, 
   3.5831351983518877`*^9, 3.583135323900908*^9, 3.5831380827053537`*^9, 
   3.583138207896574*^9, 3.5831465501436787`*^9, 3.583146621638604*^9, 
   3.5831468274185658`*^9, {3.5831473693489175`*^9, 3.5831473955101633`*^9}, 
   3.5831487856296053`*^9, 3.5831499329322205`*^9, 3.58315001798357*^9, 
   3.5831501714410396`*^9, 3.583150222375129*^9, 3.5831502708288145`*^9, {
   3.5879651823534575`*^9, 3.5879651918226748`*^9}, 3.588079848535586*^9, 
   3.5880799288153267`*^9, 3.588080068763173*^9, 3.588080146076908*^9, 
   3.588080234076663*^9, 3.588082912154174*^9, 3.588083216822709*^9, 
   3.5880836643718953`*^9, 3.588316614128674*^9, 3.5883188313001685`*^9, 
   3.5883190065352764`*^9, 3.5883191568727407`*^9, 3.5883258256572375`*^9, 
   3.5883259571030684`*^9, 3.5883269154137516`*^9, 3.588327858888809*^9, 
   3.5883279280905304`*^9, 3.5883280179466887`*^9, 3.5883284722506866`*^9, 
   3.5883285564596343`*^9, 3.5883293958669086`*^9, {3.5883296795378065`*^9, 
   3.5883297027662477`*^9}, 3.5883299111192126`*^9, 3.6151308247068577`*^9, 
   3.615131007122082*^9, 3.619089165100086*^9, 3.619626214119156*^9, 
   3.620542570448577*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`TexAct`  version \"\>", 
   "\[InvisibleSpace]", "\<\"0.3.5\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2014", ",", "9", ",", "24"}], "}"}]}],
  SequenceForm["Package xAct`TexAct`  version ", "0.3.5", ", ", {2014, 9, 24}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.5823477952651157`*^9, 3.5823538536780496`*^9, 3.5823539666088552`*^9, 
   3.583130719908622*^9, 3.583133040023697*^9, 3.583133119864637*^9, 
   3.5831331948081684`*^9, 3.583133301590356*^9, 3.5831333336172123`*^9, 
   3.5831351983518877`*^9, 3.583135323900908*^9, 3.5831380827053537`*^9, 
   3.583138207896574*^9, 3.5831465501436787`*^9, 3.583146621638604*^9, 
   3.5831468274185658`*^9, {3.5831473693489175`*^9, 3.5831473955101633`*^9}, 
   3.5831487856296053`*^9, 3.5831499329322205`*^9, 3.58315001798357*^9, 
   3.5831501714410396`*^9, 3.583150222375129*^9, 3.5831502708288145`*^9, {
   3.5879651823534575`*^9, 3.5879651918226748`*^9}, 3.588079848535586*^9, 
   3.5880799288153267`*^9, 3.588080068763173*^9, 3.588080146076908*^9, 
   3.588080234076663*^9, 3.588082912154174*^9, 3.588083216822709*^9, 
   3.5880836643718953`*^9, 3.588316614128674*^9, 3.5883188313001685`*^9, 
   3.5883190065352764`*^9, 3.5883191568727407`*^9, 3.5883258256572375`*^9, 
   3.5883259571030684`*^9, 3.5883269154137516`*^9, 3.588327858888809*^9, 
   3.5883279280905304`*^9, 3.5883280179466887`*^9, 3.5883284722506866`*^9, 
   3.5883285564596343`*^9, 3.5883293958669086`*^9, {3.5883296795378065`*^9, 
   3.5883297027662477`*^9}, 3.5883299111192126`*^9, 3.6151308247068577`*^9, 
   3.615131007122082*^9, 3.619089165100086*^9, 3.619626214119156*^9, 
   3.6205425704585767`*^9}],

Cell[BoxData["\<\"CopyRight (C) 2008-2013, Thomas B\[ADoubleDot]ckdahl, Jose \
M. Martin-Garcia and Barry Wardell, under the General Public License.\"\>"], \
"Print",
 CellChangeTimes->{
  3.5823477952651157`*^9, 3.5823538536780496`*^9, 3.5823539666088552`*^9, 
   3.583130719908622*^9, 3.583133040023697*^9, 3.583133119864637*^9, 
   3.5831331948081684`*^9, 3.583133301590356*^9, 3.5831333336172123`*^9, 
   3.5831351983518877`*^9, 3.583135323900908*^9, 3.5831380827053537`*^9, 
   3.583138207896574*^9, 3.5831465501436787`*^9, 3.583146621638604*^9, 
   3.5831468274185658`*^9, {3.5831473693489175`*^9, 3.5831473955101633`*^9}, 
   3.5831487856296053`*^9, 3.5831499329322205`*^9, 3.58315001798357*^9, 
   3.5831501714410396`*^9, 3.583150222375129*^9, 3.5831502708288145`*^9, {
   3.5879651823534575`*^9, 3.5879651918226748`*^9}, 3.588079848535586*^9, 
   3.5880799288153267`*^9, 3.588080068763173*^9, 3.588080146076908*^9, 
   3.588080234076663*^9, 3.588082912154174*^9, 3.588083216822709*^9, 
   3.5880836643718953`*^9, 3.588316614128674*^9, 3.5883188313001685`*^9, 
   3.5883190065352764`*^9, 3.5883191568727407`*^9, 3.5883258256572375`*^9, 
   3.5883259571030684`*^9, 3.5883269154137516`*^9, 3.588327858888809*^9, 
   3.5883279280905304`*^9, 3.5883280179466887`*^9, 3.5883284722506866`*^9, 
   3.5883285564596343`*^9, 3.5883293958669086`*^9, {3.5883296795378065`*^9, 
   3.5883297027662477`*^9}, 3.5883299111192126`*^9, 3.6151308247068577`*^9, 
   3.615131007122082*^9, 3.619089165100086*^9, 3.619626214119156*^9, 
   3.6205425704585767`*^9}]
}, Open  ]]
}, Open  ]],

Cell["\<\
We specify the context xAct`TexAct` to avoid overriding the Disclaimer of \
other packages. However we need to turn off the message General:shdw \
temporarily:\
\>", "Text"],

Cell[BoxData[{
 RowBox[{"Off", "[", 
  RowBox[{"General", "::", "shdw"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xAct`TexAct`Disclaimer", "[", "]"}], ":=", 
  RowBox[{
  "Print", "[", 
   "\"\<These are points 11 and 12 of the General Public \
License:\\n\\nBECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO \
WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT \
WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES \
PROVIDE THE PROGRAM `AS IS\.b4 WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED \
OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF \
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO \
THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU. SHOULD THE PROGRAM \
PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR \
CORRECTION.\\n\\nIN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO \
IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY \
AND/OR REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR \
DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES \
ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT \
LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED \
BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER \
PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE \
POSSIBILITY OF SUCH DAMAGES.\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"On", "[", 
  RowBox[{"General", "::", "shdw"}], "]"}]}], "Input",
 InitializationCell->True],

Cell["\<\
If TexAct is the last package begin read, print the GPL message:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"xAct`xCore`Private`$LastPackage", "===", "\"\<xAct`TexAct`\>\""}],
    ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Unset", "[", "xAct`xCore`Private`$LastPackage", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "xAct`xCore`Private`bars", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Print", "[", 
     "\"\<These packages come with ABSOLUTELY NO WARRANTY; for details type \
Disclaimer[]. This is free software, and you are welcome to redistribute it \
under certain conditions. See the General Public License for details.\>\"", 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "xAct`xCore`Private`bars", "]"}]}]}], 
  "]"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{
  3.5823477953119164`*^9, 3.5823538537248497`*^9, 3.582353966640055*^9, 
   3.5831307199398212`*^9, 3.583133040054897*^9, 3.5831331198802366`*^9, 
   3.583133194839369*^9, 3.5831333016215563`*^9, 3.5831333336484127`*^9, 
   3.5831351983830876`*^9, 3.583135323932108*^9, 3.583138082736554*^9, 
   3.5831382079277735`*^9, 3.5831465501748786`*^9, 3.583146621669804*^9, 
   3.5831468274497657`*^9, {3.5831473693645177`*^9, 3.5831473955413637`*^9}, 
   3.583148785660805*^9, 3.5831499329478207`*^9, 3.5831500180147705`*^9, 
   3.5831501714878397`*^9, 3.583150222406329*^9, 3.5831502708600144`*^9, {
   3.5879651823690577`*^9, 3.5879651918382745`*^9}, 3.5880798485511856`*^9, 
   3.588079928846527*^9, 3.5880800687943726`*^9, 3.5880801460925083`*^9, 
   3.588080234092263*^9, 3.588082912169774*^9, 3.5880832168383093`*^9, 
   3.5880836644030952`*^9, 3.588316614159874*^9, 3.5883188313313684`*^9, 
   3.5883190065664763`*^9, 3.5883191568883405`*^9, 3.5883258256884375`*^9, 
   3.5883259571342688`*^9, 3.588326915444952*^9, 3.5883278589200087`*^9, 
   3.588327928121731*^9, 3.5883280179622884`*^9, 3.588328472281886*^9, 
   3.588328556475234*^9, 3.5883293958825083`*^9, {3.5883296795534067`*^9, 
   3.588329702781848*^9}, 3.5883299111348124`*^9, 3.615130824726857*^9, 
   3.615131007137682*^9, 3.6190891651100864`*^9, 3.6196262141391563`*^9, 
   3.6205425704685764`*^9}],

Cell[BoxData["\<\"These packages come with ABSOLUTELY NO WARRANTY; for \
details type Disclaimer[]. This is free software, and you are welcome to \
redistribute it under certain conditions. See the General Public License for \
details.\"\>"], "Print",
 CellChangeTimes->{
  3.5823477953119164`*^9, 3.5823538537248497`*^9, 3.582353966640055*^9, 
   3.5831307199398212`*^9, 3.583133040054897*^9, 3.5831331198802366`*^9, 
   3.583133194839369*^9, 3.5831333016215563`*^9, 3.5831333336484127`*^9, 
   3.5831351983830876`*^9, 3.583135323932108*^9, 3.583138082736554*^9, 
   3.5831382079277735`*^9, 3.5831465501748786`*^9, 3.583146621669804*^9, 
   3.5831468274497657`*^9, {3.5831473693645177`*^9, 3.5831473955413637`*^9}, 
   3.583148785660805*^9, 3.5831499329478207`*^9, 3.5831500180147705`*^9, 
   3.5831501714878397`*^9, 3.583150222406329*^9, 3.5831502708600144`*^9, {
   3.5879651823690577`*^9, 3.5879651918382745`*^9}, 3.5880798485511856`*^9, 
   3.588079928846527*^9, 3.5880800687943726`*^9, 3.5880801460925083`*^9, 
   3.588080234092263*^9, 3.588082912169774*^9, 3.5880832168383093`*^9, 
   3.5880836644030952`*^9, 3.588316614159874*^9, 3.5883188313313684`*^9, 
   3.5883190065664763`*^9, 3.5883191568883405`*^9, 3.5883258256884375`*^9, 
   3.5883259571342688`*^9, 3.588326915444952*^9, 3.5883278589200087`*^9, 
   3.588327928121731*^9, 3.5883280179622884`*^9, 3.588328472281886*^9, 
   3.588328556475234*^9, 3.5883293958825083`*^9, {3.5883296795534067`*^9, 
   3.588329702781848*^9}, 3.5883299111348124`*^9, 3.615130824726857*^9, 
   3.615131007137682*^9, 3.6190891651100864`*^9, 3.6196262141391563`*^9, 
   3.6205425704685764`*^9}],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{
  3.5823477953119164`*^9, 3.5823538537248497`*^9, 3.582353966640055*^9, 
   3.5831307199398212`*^9, 3.583133040054897*^9, 3.5831331198802366`*^9, 
   3.583133194839369*^9, 3.5831333016215563`*^9, 3.5831333336484127`*^9, 
   3.5831351983830876`*^9, 3.583135323932108*^9, 3.583138082736554*^9, 
   3.5831382079277735`*^9, 3.5831465501748786`*^9, 3.583146621669804*^9, 
   3.5831468274497657`*^9, {3.5831473693645177`*^9, 3.5831473955413637`*^9}, 
   3.583148785660805*^9, 3.5831499329478207`*^9, 3.5831500180147705`*^9, 
   3.5831501714878397`*^9, 3.583150222406329*^9, 3.5831502708600144`*^9, {
   3.5879651823690577`*^9, 3.5879651918382745`*^9}, 3.5880798485511856`*^9, 
   3.588079928846527*^9, 3.5880800687943726`*^9, 3.5880801460925083`*^9, 
   3.588080234092263*^9, 3.588082912169774*^9, 3.5880832168383093`*^9, 
   3.5880836644030952`*^9, 3.588316614159874*^9, 3.5883188313313684`*^9, 
   3.5883190065664763`*^9, 3.5883191568883405`*^9, 3.5883258256884375`*^9, 
   3.5883259571342688`*^9, 3.588326915444952*^9, 3.5883278589200087`*^9, 
   3.588327928121731*^9, 3.5883280179622884`*^9, 3.588328472281886*^9, 
   3.588328556475234*^9, 3.5883293958825083`*^9, {3.5883296795534067`*^9, 
   3.588329702781848*^9}, 3.5883299111348124`*^9, 3.615130824726857*^9, 
   3.615131007137682*^9, 3.6190891651100864`*^9, 3.6196262141391563`*^9, 
   3.6205425704785767`*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["1.4. Usage messages", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "::", "usage"}], "=", 
   "\"\<Tex[expr] returns a string with the TeX formatting of the tensorial \
expression expr.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexPrint", "::", "usage"}], "=", 
   "\"\<TexPrint[expr] returns a string for screen printing of the TeX \
formatting of the tensorial expression expr. TexPrint[expr, n] starts using \
parenthesization of level n, instead of the Automatic level.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexBreak", "::", "usage"}], "=", 
   "\"\<TexBreak[string] breaks the string (the output of TexPrint) into \
different lines of TeX code, always before a sum, approximately every 200 \
characters (or terms, using the option TexBreakBy) of the string. \
TexBreak[string, n] allows specifying the frequency of characters or terms. \
TexBreak[string, n, list] allows specifying different lengths for different \
lines. Other relevant options are TexBreakAt and TexBreakString.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexBreakBy", "::", "usage"}], "=", 
   "\"\<TexBreakBy is an option for TexBreak specifying whether the string of \
TeX code must be broken by counting characters (value \\\"Character\\\") or \
by counting terms (value \\\"Term\\\").\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexBreakAt", "::", "usage"}], "=", 
   "\"\<TexBreakAt is an option for TexBreak specifying where to break the \
string of TeX code.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexBreakString", "::", "usage"}], "=", 
   "\"\<TexBreakString is an option for TexBreak specifying the string to be \
introduced at the breaking points.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexPrintInitialBracesQ", "::", "usage"}], "=", 
   "\"\<$TexPrintInitialBracesQ is a Boolean global variable, with default \
False. If set to True a tensor is formatted as T{}^{ab}{}_{cd}. If set to \
False the same tensor is formatted as T^{ab}{}_{cd}.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexScalarParentheses", "::", "usage"}], "=", 
   "\"\<$TexScalarParentheses is a Boolean global variable, with default \
True. If set to True the Scalar expressions are formatted with wrapping \
parentheses.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexFraction", "::", "usage"}], "=", 
   "\"\<$TexFraction is a global variable specifying the Tex command to be \
used to format fractions, with default \\\"\\\\frac\\\".\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexSmallFraction", "::", "usage"}], "=", 
   "\"\<$TexSmallFraction is a global variable specifying the Tex command to \
be use to format rational numbers, with default \\\"\\\\tfrac\\\".\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexSmallFractionExponent", "::", "usage"}], "=", 
   "\"\<$TexSmallFractionExponent is a global variable specifying the Tex \
command to be use to format rational numbers, with default False.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexFractionAsFraction", "::", "usage"}], "=", 
   "\"\<Option for TexPrint. If True, fractions are printed as fractions, \
otherwize they are printed as a product with negative exponents.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexParenthesisInitLevel", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexFixExtraRules", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexMatrix", "::", "usage"}], " ", "=", 
   "\"\<TexMatrix[M] produces TeX code for the matrix M, where all elements \
are typset by the function Tex. TexMatrix[M, F] uses the function F instead \
of Tex on the elements.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexIndexForm", "::", "usage"}], " ", "=", 
   "\"\<Special formatting for indices.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexTmpDirectory", "::", "usage"}], " ", "=", 
   "\"\<Directory for placement of the TexActWidthTest.tex file for \
determining of widths for linebreaking.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexDirectory", "::", "usage"}], "=", 
   "\"\<Directory for placement of the output .tex file.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexInitLatexCode", "::", "usage"}], "=", 
   "\"\<A function that produces the initial lines of the TexActWidthTest.tex \
file for determining of widths for linebreaking. Observe that \
\\\\begin{document} should not be included. This is constructed from the \
string $TexInitLatexClassCode, and the lists $TexInitLatexPackages, \
$TexInitLatexExtraCode.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexInitLatexClassCode", "::", "usage"}], "=", 
   "\"\<The document class code for the LaTeX output.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexInitLatexPackages", "::", "usage"}], "=", 
   "\"\<A list of packages for the LaTeX output. This should be a list of \
strings, where each string has teh form {package}. This is then transformed \
to \\\\usepackage{package}\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexInitLatexExtraCode", "::", "usage"}], "=", 
   "\"\<Extra lines for definition of special LaTeX commands. This should be \
a list of strings.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexPrintAlignedEquations", "::", "usage"}], " ", "=", 
   "\"\<TexPrintAlignedEquations takes a list of equations and typesets them \
in an align environment with line breaking so the total length does not \
exceed $TexPrintPageWidth.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexPrintPageWidth", "::", "usage"}], " ", "=", " ", 
   "\"\<Parameter to adjust the line breaking for TexPrintAlignedEquations. \
This is measured in printer points. Observe that you can use the textwidth \
variable which is read from the latex environment.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"latextextwidth", "::", "usage"}], "=", 
   "\"\<A symbol representing the textwidth variable in the current latex \
environment.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FormatTexBasis", "::", "usage"}], " ", "=", 
   "\"\<FormatTexBasis works the same way as FormatBasis, but for the Tex \
output.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EquationMarks", "::", "usage"}], " ", "=", 
   "\"\<An option for TexBreak to include \\\\begin{equation} \
\\\\end{equation} or similar constructions. Default is False, but a standard \
value would be \\\"equation\\\". Warning, do not use this on TexPrint if the \
result is passed to TexBreak.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddEquationMarks", "::", "usage"}], "=", 
   "\"\<Adds \\\\begin{equation} \\\\end{equation} or similar constructions \
to a tex string. The default is Automatic which makes an educated \
guess.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexView", "::", "usage"}], "=", 
   "\"\<TexView is used to compile and view tex output. The first argument \
can be a tex string, a list of equations, a single equation or expression. A \
second optional argument can be given to set the file name without extension. \
The compiler is set by $LatexExecutable. The file extension of the file to \
view is set by $TexViewExt.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexPort", "::", "usage"}], "=", 
   "\"\<Does the same thing as TexView, but it does not open the file. A file \
name must be given as a second argument.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$LatexExecutable", "::", "usage"}], " ", "=", 
   "\"\<Command for compiling LaTeX. The default is pdflatex. Add the path to \
the file if the default value does not work.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexViewExt", "::", "usage"}], " ", "=", " ", 
   "\"\<The file extension for output file to view. The defailt is .pdf. If \
you want to open the .tex file in your default editor use .tex instead. \
Observe however that TexView overwrites files without asking so editing this \
file might not be a good idea.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexPrintAlignedExpressions", "::", "usage"}], "=", 
   "\"\<Takes a list of expressions, and typesets them in an aligned \
environment.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EnableTexColor", "::", "usage"}], "=", 
   "\"\<Enables the use of colors in the tex output.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DisableTexColor", "::", "usage"}], "=", 
   "\"\<Disables the use of colors in the tex output.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParenthesisOldStyle", "::", "usage"}], "=", 
   "\"\<ParenthesisOldStyle can be given as a second argument to TexPrint to \
recover the old style of counting parenthesis levels.\>\""}], ";"}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwd0F9IU2EABfDrCI0xbWHIRjEduXXRMrPSEEs+Zg9KaH98yDSKkWLhWhDp
HpYTdFhoe6gpKjNhRulNoaklpeD/iqUwx1WiWawQ02/C1HAOkuw7Phx+b+fA
UeuNl0slHMdpWOCe4rQ2jZWS7YJQOySS604o5xsEGArbdVqmp+RPLjx5LGD5
1ExJeamuDo6YImW1vZRUuq/uh3rHYM+rN5T45yZHYFfcx4FupjasG4OqxW+x
00xb6o8j0Oyzegv6KLnVmyLC2c7Al4vM0wfyZuC5FrUXZmnvifC30j5hGWK9
7wx/oWfVvQNtyXe4Gqa41ykMMmfzc11wyv/vLcyuN3ngoWr18ffMijV7OpRl
btVC1daZJ1AuufAMevioVigMdRYlDVMScLmM8Gu+9DE8Nf/QAR9IFU5YGNHx
Aj5Xnu+G0fqzPbDlUfUU/Hn/qRsmdHAHTzD3iTfjIdH8SoKbNkUybGrMGYPp
vDAJ+1srP8PltO/zUFHj2IGpt8VdhcINr2Gckphgg2/XAWUIlsnVYbjUlLMN
+WvjMXeZpkuv42EzX58AR1XhRHjUqtXArgzdSoaPkg/mlCC0xL70Hl5gv8xk
+WFiVdyVxSW2azAWwxubZmlwnZKikgkZ/A+5ZT5P
  "]]
}, Closed]],

Cell[CellGroupData[{

Cell["1.5. Begin private section", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData["\<\"xAct`TexAct`Private`\"\>"], "Output",
 CellChangeTimes->{
  3.582347795343116*^9, 3.58235385377165*^9, 3.582353966671255*^9, 
   3.5831307199710217`*^9, 3.583133040086097*^9, 3.583133119911437*^9, 
   3.5831331948549685`*^9, 3.583133301652756*^9, 3.5831333336640124`*^9, 
   3.5831351984142876`*^9, 3.5831353239633083`*^9, 3.583138082783354*^9, 
   3.583138207974574*^9, 3.5831465502216787`*^9, 3.5831466216854043`*^9, 
   3.5831468274653654`*^9, {3.5831473693801174`*^9, 3.5831473955725636`*^9}, 
   3.583148785676405*^9, 3.583149932979021*^9, 3.5831500180303707`*^9, 
   3.58315017151904*^9, 3.5831502224531293`*^9, 3.5831502708912144`*^9, {
   3.5879651826342583`*^9, 3.5879651918850746`*^9}, 3.588079848582386*^9, 
   3.5880799288933268`*^9, 3.5880800688411727`*^9, 3.5880801461237087`*^9, 
   3.588080234139063*^9, 3.5880829121853743`*^9, 3.588083216869509*^9, 
   3.5880836644186954`*^9, 3.588316614175474*^9, 3.5883188313469687`*^9, 
   3.5883190065976763`*^9, 3.5883191569195404`*^9, 3.588325825719638*^9, 
   3.5883259571498685`*^9, 3.588326915460552*^9, 3.588327858935609*^9, 
   3.5883279281373305`*^9, 3.588328017977888*^9, 3.5883284722974863`*^9, 
   3.5883285565064344`*^9, 3.5883293958981085`*^9, {3.588329679569007*^9, 
   3.5883297028130474`*^9}, 3.5883299111504126`*^9, 3.6151308247468576`*^9, 
   3.6151310071688824`*^9, 3.6190891651300864`*^9, 3.619626214159156*^9, 
   3.620542570488577*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2. Parentheses", "Section",
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell["2.1. Open and close parentheses", "Subsection"],

Cell["We define a hierarchy of parenthesis.", "Text"],

Cell[TextData[{
 "There is a global variable ",
 StyleBox["level", "Input"],
 " that stores the parenthesization level at each particular time. There is \
also the global variable ",
 StyleBox["minlevel", "Input"],
 ". The idea is that each call to TexMaximumLevel has a Block with these two \
variables. This is not very elegant."
}], "Text"],

Cell[TextData[{
 "TB: A possible alternative would be to typeset once, and add a special \
\[OpenCurlyDoubleQuote]open\[CloseCurlyDoubleQuote] symbol and a \
\[OpenCurlyDoubleQuote]close\[CloseCurlyDoubleQuote] symbol. Another string \
",
 StyleBox["parenthesisstring",
  FontSlant->"Italic"],
 " can contain just the \[OpenCurlyDoubleQuote]open\[CloseCurlyDoubleQuote] \
and \[OpenCurlyDoubleQuote]close\[CloseCurlyDoubleQuote] symbols. This string \
can be built either from the Tex string. At the final pass the \
\[OpenCurlyDoubleQuote]open\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]close\[CloseCurlyDoubleQuote] symbols in the Tex \
string can be replaced by the correct Tex code with a level that can be \
computed by tracing backwards or forwards in ",
 StyleBox["parenthesisstring",
  FontSlant->"Italic"],
 " until the matching \[OpenCurlyDoubleQuote]open\[CloseCurlyDoubleQuote] or \
\[OpenCurlyDoubleQuote]close\[CloseCurlyDoubleQuote]  symbol is found."
}], "Text",
 CellChangeTimes->{{3.604591698637143*^9, 3.6045917861972656`*^9}, {
   3.604591882707401*^9, 3.60459191062744*^9}, {3.604591941357483*^9, 
   3.604592023687598*^9}, {3.604592102447708*^9, 3.6045922870160856`*^9}, {
   3.6045923314261475`*^9, 3.604592475236349*^9}, 3.60507753165971*^9, 
   3.6050775778197746`*^9, {3.605078218671672*^9, 3.6050782695817432`*^9}, {
   3.6050794399433813`*^9, 3.6050794948134584`*^9}, {3.6050795409335227`*^9, 
   3.6050795940535975`*^9}, {3.6050816576994877`*^9, 
   3.6050816597894907`*^9}, {3.6050817176395717`*^9, 3.605081736399598*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexParenthesisNewstyle", "=", "False"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6050159561854787`*^9, 3.6050159801955123`*^9}, {
  3.605016720586549*^9, 3.6050167212365503`*^9}, {3.605077330349428*^9, 
  3.6050773306494284`*^9}, {3.605081740789604*^9, 3.6050817412096043`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$TexOpenParChar", "=", 
   RowBox[{"FromCharacterCode", "[", "23", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$TexCloseParChar", "=", 
   RowBox[{"FromCharacterCode", "[", "25", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605014267202114*^9, 3.60501427837213*^9}, {
  3.605014426872338*^9, 3.605014443612361*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TexOpen", "[", "string_String", "]"}], ":=", 
   RowBox[{
    RowBox[{"OpenParenthesis", "[", 
     RowBox[{"Decrement", "[", "level", "]"}], "]"}], "<>", "string"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexClose", "[", "string_String", "]"}], ":=", 
   RowBox[{
    RowBox[{"CloseParenthesis", "[", 
     RowBox[{"PreIncrement", "[", "level", "]"}], "]"}], "<>", "string"}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Trick", " ", "to", " ", "count", " ", "maximum", " ", "depth"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"OpenParenthesis", "[", 
      RowBox[{"level_Integer", "?", "Negative"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
      "$TexParenthesisNewstyle", ",", "$TexOpenParChar", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"minlevel", "=", 
          RowBox[{"Min", "[", 
           RowBox[{"minlevel", ",", "level"}], "]"}]}], ";", "\"\<\>\""}], 
        ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CloseParenthesis", "[", 
      RowBox[{"level_Integer", "?", "Negative"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
      "$TexParenthesisNewstyle", ",", "$TexCloseParChar", ",", 
       "\[IndentingNewLine]", "\"\<\>\""}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6050160602756243`*^9, 3.6050160851856594`*^9}, {
  3.6050161165457034`*^9, 3.605016168235776*^9}, {3.6050813979191236`*^9, 
  3.6050814211991563`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OpenParenthesis", "[", "0", "]"}], ":=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CloseParenthesis", "[", "0", "]"}], ":=", "\"\<\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OpenParenthesis", "[", "1", "]"}], ":=", "\"\<\\\\bigl\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CloseParenthesis", "[", "1", "]"}], ":=", "\"\<\\\\bigr\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OpenParenthesis", "[", "2", "]"}], ":=", "\"\<\\\\Bigl\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CloseParenthesis", "[", "2", "]"}], ":=", "\"\<\\\\Bigr\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OpenParenthesis", "[", "3", "]"}], ":=", "\"\<\\\\biggl\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CloseParenthesis", "[", "3", "]"}], ":=", "\"\<\\\\biggr\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OpenParenthesis", "[", "4", "]"}], ":=", "\"\<\\\\Biggl\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CloseParenthesis", "[", "4", "]"}], ":=", "\"\<\\\\Biggr\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OpenParenthesis", "[", 
    RowBox[{"level_Integer", "?", "Positive"}], "]"}], ":=", 
   "\"\<\\\\left\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CloseParenthesis", "[", 
    RowBox[{"level_Integer", "?", "Positive"}], "]"}], ":=", 
   "\"\<\\\\right\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605014998553138*^9, 3.605015004793147*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Main", ".", " ", "Private"}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"TexMaximumLevel", "[", "expr_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"level", "=", "0"}], ",", 
        RowBox[{"minlevel", "=", "0"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"Tex", "[", "expr", "]"}], ";", 
       RowBox[{"-", "minlevel"}]}]}], "]"}]}], ";"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Safety", " ", "definitions", " ", "for", " ", "direct", " ", "examples", 
    " ", "with", " ", "Tex"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"level", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"minlevel", "=", "0"}], ";"}]}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["2.2. Main function", "Subsection"],

Cell["\<\
The key idea here is that there are two calls to the function Tex. We first \
run through the whole expression with TexMaximumLevel, which uses Tex, to \
discover the number of parentheses needed. In this first run the resulting \
expression string  has wrong parentheses (actually no parentheses). Then we \
call Tex again, this time producing the correct parentheses. If we provide \
the second argument of TexParenthesis then we avoid the first run.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$VerboseParenthesizationLevel", "=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexParenthesis", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"initlevel_:", "Automatic"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"initlevel", "===", "Automatic"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"level", "=", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"$TexParenthesisNewstyle", "=", "True"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlaceParenthesis", "@", 
        RowBox[{"Tex", "[", "expr", "]"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"level", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"initlevel", "===", "ParenthesisOldStyle"}], ",", 
           RowBox[{"TexMaximumLevel", "[", "expr", "]"}], ",", "initlevel"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{"$VerboseParenthesationLevel", ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Maximum parenthesization level: \>\"", ",", "level"}],
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Tex", "[", "expr", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
     "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6050161963058147`*^9, 3.6050162910859475`*^9}, {
  3.6050167868066416`*^9, 3.60501680711667*^9}, {3.6050168686667566`*^9, 
  3.605016910096814*^9}, {3.6050191844251165`*^9, 3.605019185115117*^9}, {
  3.6050777831100616`*^9, 3.605077790650072*^9}, {3.6050819010698285`*^9, 
  3.6050819305098696`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PlaceParenthesis", "[", "texinstr_String", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"parchars", "=", 
        RowBox[{"StringCases", "[", 
         RowBox[{"texinstr", ",", 
          RowBox[{"Alternatives", "[", 
           RowBox[{"$TexOpenParChar", ",", "$TexCloseParChar"}], "]"}]}], 
         "]"}]}], ",", "substrings", ",", 
       RowBox[{"texstring", "=", "\"\<\>\""}], ",", 
       RowBox[{"i", "=", "1"}], ",", "j", ",", "parlevel", ",", " ", 
       "maxparlevel"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"substrings", "=", 
       RowBox[{"StringSplit", "[", 
        RowBox[{"texinstr", ",", 
         RowBox[{"Alternatives", "[", 
          RowBox[{"$TexOpenParChar", ",", "$TexCloseParChar"}], "]"}], ",", 
         "All"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "substrings"}], ">", "0"}], ",", 
        RowBox[{
         RowBox[{"texstring", "=", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"texstring", ",", 
            RowBox[{"First", "@", "substrings"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"substrings", "=", 
          RowBox[{"Rest", "@", "substrings"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i", "\[LessEqual]", " ", 
             RowBox[{"Length", "@", "parchars"}]}], "&&", 
            RowBox[{
             RowBox[{"parchars", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "===", "$TexOpenParChar"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"j", "=", 
             RowBox[{"i", "+", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"parlevel", "=", "1"}], ";", "\[IndentingNewLine]", 
            RowBox[{"maxparlevel", "=", "1"}], ";", "\[IndentingNewLine]", 
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "\[LessEqual]", " ", 
                RowBox[{"Length", "@", "parchars"}]}], "&&", 
               RowBox[{"parlevel", ">", "0"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"parchars", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "===", "$TexOpenParChar"}],
                  ",", 
                 RowBox[{"maxparlevel", "=", 
                  RowBox[{"Max", "[", 
                   RowBox[{"maxparlevel", ",", 
                    RowBox[{"++", "parlevel"}]}], "]"}]}], ",", 
                 RowBox[{"parlevel", "--"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"j", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"texstring", "=", 
             RowBox[{"StringJoin", "[", 
              RowBox[{"texstring", ",", 
               RowBox[{"OpenParenthesis", "[", 
                RowBox[{"maxparlevel", "-", "1"}], "]"}]}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i", "\[LessEqual]", " ", 
             RowBox[{"Length", "@", "parchars"}]}], "&&", 
            RowBox[{
             RowBox[{"parchars", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "===", "$TexCloseParChar"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"j", "=", 
             RowBox[{"i", "-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"parlevel", "=", "1"}], ";", "\[IndentingNewLine]", 
            RowBox[{"maxparlevel", "=", "1"}], ";", "\[IndentingNewLine]", 
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "\[GreaterEqual]", " ", "1"}], "&&", 
               RowBox[{"parlevel", ">", "0"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"parchars", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "===", 
                  "$TexCloseParChar"}], ",", 
                 RowBox[{"maxparlevel", "=", 
                  RowBox[{"Max", "[", 
                   RowBox[{"maxparlevel", ",", 
                    RowBox[{"++", "parlevel"}]}], "]"}]}], ",", 
                 RowBox[{"parlevel", "--"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"j", "--"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"texstring", "=", 
             RowBox[{"StringJoin", "[", 
              RowBox[{"texstring", ",", 
               RowBox[{"CloseParenthesis", "[", 
                RowBox[{"maxparlevel", "-", "1"}], "]"}]}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"i", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "texstring"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6050183452939415`*^9, 3.605018470384117*^9}, {
  3.605018580314271*^9, 3.605018691144426*^9}, {3.605018724634473*^9, 
  3.605018766794532*^9}, {3.605018796884574*^9, 3.605018842594638*^9}, {
  3.605018877054686*^9, 3.6050188800246906`*^9}, {3.605018934284766*^9, 
  3.6050190582749395`*^9}, {3.605019116255021*^9, 3.605019157695079*^9}, {
  3.6050191939051294`*^9, 3.605019228025178*^9}, {3.605076697588542*^9, 
  3.605076761878632*^9}, {3.6050793305232286`*^9, 3.6050793786932955`*^9}, {
  3.6050817692196436`*^9, 3.605081784199665*^9}, {3.6057865208515434`*^9, 
  3.605786521541544*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["2.3. Alternative code. Not used", "Subsection"],

Cell["\<\
This is some alternative code whose origin or purpose has been forgotten... \
It is not included in the package.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ZParenth", "[", 
     RowBox[{"ZParenth", "[", "expr_", "]"}], "]"}], ":=", 
    RowBox[{"ZParenth", "[", "expr", "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Atoms", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", 
    RowBox[{"x", ":", 
     RowBox[{"(", 
      RowBox[{
      "_Symbol", "|", "_String", "|", "_Integer", "|", "_Rational", "|", 
       "_Real"}], ")"}]}], "]"}], ":=", "x"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddParenth", "[", "x_Complex", "]"}], ":=", 
    RowBox[{"ZParenth", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Products", " ", "and", " ", "sums"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", 
    RowBox[{"Times", "[", 
     RowBox[{"x_", ",", "y_Plus"}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"AddParenth", "[", "x", "]"}], 
    RowBox[{"ZParenth", "[", 
     RowBox[{"AddParenth", "[", "y", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", "expr_Times", "]"}], ":=", 
   RowBox[{"AddParenth", "/@", "expr"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddParenth", "[", "expr_Plus", "]"}], ":=", 
    RowBox[{"AddParenth", "/@", "expr"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Powers", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", 
    RowBox[{"Power", "[", 
     RowBox[{
      RowBox[{"x", ":", 
       RowBox[{"(", 
        RowBox[{"_Symbol", "|", 
         RowBox[{
          RowBox[{"_", "?", "xTensorQ"}], "[", "___", "]"}]}], ")"}]}], ",", 
      "n_"}], "]"}], "]"}], ":=", 
   RowBox[{"Power", "[", 
    RowBox[{
     RowBox[{"AddParenth", "[", "x", "]"}], ",", 
     RowBox[{"AddParenth", "[", "n", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddParenth", "[", 
     RowBox[{"Power", "[", 
      RowBox[{"x_", ",", "n_"}], "]"}], "]"}], ":=", 
    RowBox[{"Power", "[", 
     RowBox[{
      RowBox[{"ZParenth", "[", 
       RowBox[{"AddParenth", "[", "x", "]"}], "]"}], ",", 
      RowBox[{"AddParenth", "[", "n", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Objects", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", 
    RowBox[{"t", ":", 
     RowBox[{
      RowBox[{"_", "?", "xTensorQ"}], "[", "___", "]"}]}], "]"}], ":=", "t"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", 
    RowBox[{"c", ":", 
     RowBox[{
      RowBox[{
       RowBox[{"_Symbol", "?", "CovDQ"}], "[", "__", "]"}], "[", "_", "]"}]}],
     "]"}], ":=", "c"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddParenth", "[", "c_CovD", "]"}], ":=", "c"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Scalar", " ", "functions", " ", "and", " ", "inert", " ", "heads"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", 
    RowBox[{
     RowBox[{"f_", "?", "ScalarFunctionQ"}], "[", "exprs__", "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"AddParenth", "[", "f", "]"}], "[", 
    RowBox[{"AddParenth", "/@", 
     RowBox[{"OParenth", "[", "exprs", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddParenth", "[", 
     RowBox[{
      RowBox[{"ih_Symbol", "?", "InertHeadQ"}], "[", 
      RowBox[{"expr_", ",", "z___"}], "]"}], "]"}], ":=", 
    RowBox[{"ih", "[", 
     RowBox[{
      RowBox[{"OParenth", "[", 
       RowBox[{"AddParenth", "[", "expr", "]"}], "]"}], ",", "z"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Parametric", " ", "derivatives"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", 
    RowBox[{
     RowBox[{"ParamD", "[", "ps__", "]"}], "[", "expr_", "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ParamD", "[", "ps", "]"}], "[", 
    RowBox[{"OParenth", "[", 
     RowBox[{"AddParenth", "[", "expr", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddParentheses", "[", "expr_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Pexpr", "=", 
       RowBox[{"AddParenth", "[", "expr", "]"}]}], ",", "pos"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pos", "=", 
      RowBox[{"Most", "/@", 
       RowBox[{"Position", "[", 
        RowBox[{"Pexpr", ",", "ZParenth", ",", 
         RowBox[{"Heads", "\[Rule]", "True"}]}], "]"}]}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6165042940696087`*^9, 3.6165043005896177`*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3. Type formatting", "Section",
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell["3.0. The Tex function", "Subsection"],

Cell[TextData[{
 "The function Tex does most of the actual construction of the final string. \
It gets directly the ",
 StyleBox["xAct",
  FontSlant->"Italic"],
 " expressions and returns a string. The final result will be simply a \
concatenation of the individual strings, except for the parenthesization \
issues."
}], "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Just", " ", "in", " ", "case"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", "]"}], ":=", "\"\<\>\""}], ";"}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.1. Fractions", "Subsection"],

Cell["\<\
Because some people might want to use the \"\\\\tfrac\" or \"\\\\dfrac\" \
commands of amsmath, we introduce these two variables:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "$TexFraction"}]], "Input"],

Cell[BoxData[
 StyleBox["\<\"$TexFraction is a global variable specifying the Tex command \
to be used to format fractions, with default \\\"\\\\frac\\\".\"\>", 
  "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.6205425706885767`*^9},
 CellTags->"Info3620546170-4902789"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "$TexSmallFraction"}]], "Input"],

Cell[BoxData[
 StyleBox["\<\"$TexSmallFraction is a global variable specifying the Tex \
command to be use to format rational numbers, with default \\\"\\\\tfrac\\\".\
\"\>", "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.6205425707285767`*^9},
 CellTags->"Info3620546170-4902789"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$TexFraction", "=", "\"\<\\\\frac\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$TexSmallFraction", "=", "\"\<\\\\tfrac\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$TexSmallFractionExponent", "=", "False"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5806310924285626`*^9, 3.5806311134729996`*^9}}],

Cell["\<\
Code to avoid printing fractions as products. One can avoid all fractions \
except rationals and square roots by setting TexFractionAsFraction->False.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexFrac1", "[", 
    RowBox[{"numer_", ",", " ", "denom_", ",", "fracsymbol_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"fracsymbol", "===", "False"}], ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"Tex", "[", "numer", "]"}], ",", "\"\</\>\"", ",", 
       RowBox[{"Tex", "[", "denom", "]"}]}], "]"}], ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"fracsymbol", ",", "\"\<{\>\"", ",", 
       RowBox[{"Tex", "[", "numer", "]"}], ",", "\"\<}{\>\"", ",", 
       RowBox[{"Tex", "[", "denom", "]"}], ",", "\"\<}\>\""}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.544081263018608*^9, 3.544081269024619*^9}, {
   3.544081300926675*^9, 3.5440813401607437`*^9}, {3.5445960831255026`*^9, 
   3.544596103606674*^9}, {3.5446015397316027`*^9, 3.544601544964902*^9}, 
   3.5446016223343277`*^9, {3.5446016701880646`*^9, 3.5446016772024655`*^9}, 
   3.5806310703233237`*^9}],

Cell["If the numerator begins with a minus, we move the sign out. ", "Text",
 CellChangeTimes->{{3.544601259023547*^9, 3.5446012927774777`*^9}, {
  3.5446014040348415`*^9, 3.5446014161525345`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexFracExpression", "[", 
    RowBox[{"numer_", ",", " ", "denom_", ",", "fracsymbol_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"WithMinusQ", "[", "numer", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexOperator", "[", "Minus", "]"}], ",", 
       RowBox[{"TexFrac1", "[", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", "numer", ")"}]}], ",", "denom", ",", "fracsymbol"}], 
        "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"TexFrac1", "[", 
      RowBox[{"numer", ",", "denom", ",", "fracsymbol"}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell["Detect the presence of a negative sign:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"WithMinusQ", "[", "expr_String", "]"}], ":=", 
   RowBox[{"SameQ", "[", 
    RowBox[{
     RowBox[{"StringTake", "[", 
      RowBox[{"expr", ",", "1"}], "]"}], ",", "\"\<-\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WithMinusQ", "[", "expr_", "]"}], ":=", 
   RowBox[{"WithMinusQ", "[", 
    RowBox[{"Tex", "[", "expr", "]"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.2. Numbers", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Numbers", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "x_Integer", "]"}], ":=", 
     RowBox[{"ToString", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "x_Real", "]"}], ":=", 
     RowBox[{"ToString", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "x_Rational", "]"}], ":=", 
     RowBox[{"TexFracExpression", "[", 
      RowBox[{
       RowBox[{"Numerator", "[", "x", "]"}], ",", 
       RowBox[{"Denominator", "[", "x", "]"}], ",", "$TexSmallFraction"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Complex", "[", 
       RowBox[{"0", ",", "1"}], "]"}], "]"}], "=", "\"\<i\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Complex", "[", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], "=", "\"\<-i\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Complex", "[", 
       RowBox[{"0", ",", "im_"}], "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"Tex", "[", "im", "]"}], ",", 
       RowBox[{"Tex", "[", "I", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Complex", "[", 
       RowBox[{"re_", ",", "im_"}], "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
       RowBox[{"Tex", "[", "re", "]"}], ",", "\"\<+\>\"", ",", 
       RowBox[{"Tex", "[", 
        RowBox[{"im", " ", "I"}], "]"}], ",", 
       RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True],

Cell["Should we give definitions for other numeric objects here?", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Numeric", " ", "expressions"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "E", "]"}], "=", "\"\<e\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Pi", "]"}], "=", "\"\<\\\\pi\>\""}], 
    ";"}]}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.3. Strings", "Subsection"],

Cell[TextData[{
 "With strings we call ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "'s TeXForm, removing the frequent and annoying \\text{*} :"
}], "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Strings", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Removetext", "[", "string_String", "]"}], ":=", 
     RowBox[{
      RowBox[{"StringDrop", "[", 
       RowBox[{
        RowBox[{"StringDrop", "[", 
         RowBox[{"string", ",", "6"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "/;", 
      RowBox[{"StringMatchQ", "[", 
       RowBox[{"string", ",", "\"\<\\\\text{*}\>\""}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Removetext", "[", "string_String", "]"}], ":=", "string"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "TeXForm", " ", "does", " ", "not", " ", "work", " ", "on", " ", 
     "StyleBoxes", " ", "so", " ", "we", " ", "remove", " ", "them", " ", 
     RowBox[{"first", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RemoveStyleBoxes", "[", "string_String", "]"}], ":=", 
    RowBox[{"StringReplace", "[", 
     RowBox[{"string", ",", 
      RowBox[{
       RowBox[{"StringExpression", "[", 
        RowBox[{
        "\"\<\\!\\(\\*StyleBox[\\\"\>\"", ",", "x___", ",", "\"\<\\\"\>\"", 
         ",", "y___", ",", "\"\<]\\)\>\""}], "]"}], "\[RuleDelayed]", "x"}]}],
      "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "string_String", "]"}], ":=", 
     RowBox[{"Removetext", "@", 
      RowBox[{"ToString", "@", 
       RowBox[{"TeXForm", "@", 
        RowBox[{"RemoveStyleBoxes", "@", "string"}]}]}]}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5831371468597097`*^9, 3.5831371700569506`*^9}, {
  3.5831373257764244`*^9, 3.5831373589264827`*^9}, {3.583138164839498*^9, 
  3.583138167007902*^9}}],

Cell["\<\
If we want pass a string straight through we can use this construction:\
\>", "Text",
 CellChangeTimes->{{3.5831450794032955`*^9, 3.583145103739338*^9}, {
  3.6165052685831175`*^9, 3.6165053093231745`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"TexString", "[", "string_String", "]"}], "]"}], ":=", "string"}],
   ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6165053113631773`*^9, 3.6165053395832167`*^9}}],

Cell["Special strings not properly handled by TeXForm", "Text",
 CellChangeTimes->{{3.5831450794032955`*^9, 3.583145103739338*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Tex", "[", "\"\<\[Eth]\>\"", "]"}], "=", 
  "\"\<\\\\eth\>\""}]], "Input",
 InitializationCell->True],

Cell[BoxData["\<\"\\\\eth\"\>"], "Output",
 CellChangeTimes->{
  3.5831465505648794`*^9, 3.583146622153405*^9, 3.583146827777366*^9, {
   3.583147369645318*^9, 3.5831473959625645`*^9}, 3.5831487860040054`*^9, 
   3.5831499332910213`*^9, 3.5831500184359713`*^9, 3.583150172018241*^9, 
   3.5831502229367304`*^9, 3.583150271296815*^9, {3.5879651828682585`*^9, 
   3.5879651921814747`*^9}, 3.5880798489099865`*^9, 3.5880799292521276`*^9, 
   3.5880800691531734`*^9, 3.588080146435709*^9, 3.5880802344510636`*^9, 
   3.5880829124817743`*^9, 3.58808321716591*^9, 3.588083664715096*^9, 
   3.5883166144250746`*^9, 3.588318831643369*^9, 3.588319006878477*^9, 
   3.5883191572159405`*^9, 3.5883258260472383`*^9, 3.588325957446269*^9, 
   3.588326915912953*^9, 3.58832785923201*^9, 3.588327928433731*^9, 
   3.588328018414689*^9, 3.588328472781087*^9, 3.588328556927635*^9, 
   3.588329396241309*^9, {3.5883296798654075`*^9, 3.5883297031406484`*^9}, 
   3.5883299115092134`*^9, 3.615130825006858*^9, 3.615131007387283*^9, 
   3.619089165340087*^9, 3.6196262143991566`*^9, 3.6205425707585773`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["3.4. Functions", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Functions", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Sin", "]"}], ":=", "\"\<\\\\sin\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Cos", "]"}], ":=", "\"\<\\\\cos\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Sec", "]"}], ":=", "\"\<\\\\sec\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Csc", "]"}], ":=", "\"\<\\\\csc\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Cot", "]"}], ":=", "\"\<\\\\cot\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Tan", "]"}], ":=", "\"\<\\\\tan\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Log", "]"}], ":=", "\"\<\\\\log\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Sinh", "]"}], ":=", "\"\<\\\\sinh\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Cosh", "]"}], ":=", "\"\<\\\\cosh\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Tanh", "]"}], ":=", "\"\<\\\\tanh\>\""}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6057869383231277`*^9, 3.6057869467831397`*^9}, {
  3.616396846940979*^9, 3.616396858730995*^9}, {3.616396899191052*^9, 
  3.6163969265510902`*^9}}],

Cell["\<\
Special display for trig functions with a simple tensor field as argument.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6190827784180603`*^9, 3.6190828130521564`*^9}, {
  3.619082885172258*^9, 3.6190829020422816`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$TexTrigFuncs", "=", 
   RowBox[{"{", 
    RowBox[{
    "Sin", ",", "Cos", ",", "Tan", ",", "Cot", ",", "Sec", ",", "Csc", ",", 
     "Sinh", ",", "Cosh", ",", "Tanh"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"trig", ":", 
       RowBox[{"Alternatives", "@@", "$TexTrigFuncs"}]}], ")"}], "[", 
     RowBox[{
      RowBox[{"T_", "?", "xTensorQ"}], "[", "]"}], "]"}], "]"}], ":=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"Tex", "[", "trig", "]"}], ",", "\"\< \>\"", ",", 
       RowBox[{"Tex", "[", "T", "]"}]}], "]"}], ",", 
     RowBox[{"\"\< \\\\\>\"", "\[Rule]", "\"\<\\\\\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"Power", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"trig", ":", 
         RowBox[{"Alternatives", "@@", "$TexTrigFuncs"}]}], ")"}], "[", 
       RowBox[{
        RowBox[{"T_", "?", "xTensorQ"}], "[", "]"}], "]"}], ",", 
      "i_Integer"}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"Tex", "[", "trig", "]"}], ",", "\"\<^\>\"", ",", 
      RowBox[{"Tex", "[", "i", "]"}], ",", 
      RowBox[{"Tex", "[", "T", "]"}]}], "]"}], "/;", 
    RowBox[{"And", "[", 
     RowBox[{
      RowBox[{"i", ">", "1"}], ",", 
      RowBox[{"i", "<", "10"}]}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.619082734807999*^9, 3.6190827370680027`*^9}, {
  3.619082840072195*^9, 3.6190828520322113`*^9}, {3.619083177226715*^9, 
  3.619083356506966*^9}, {3.619083389908013*^9, 3.6190834138420944`*^9}, {
  3.619084145531215*^9, 3.619084154571228*^9}, {3.619084253091366*^9, 
  3.619084258991374*^9}, {3.619084366625573*^9, 3.619084367135574*^9}, {
  3.6190844220256505`*^9, 3.6190844395156755`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["3.5. Symbols", "Subsection"],

Cell["Symbol formatting on the result of PrintAs:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Symbols", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"including", " ", "constant"}], "-", 
      RowBox[{"symbols", " ", "and", " ", "parameters"}]}], ")"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", "symbol_Symbol", "]"}], ":=", 
    RowBox[{"Tex", "@", 
     RowBox[{"PrintAs", "[", "symbol", "]"}]}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.583136000553097*^9, 3.5831360129083185`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["3.6. Indices", "Subsection"],

Cell["\<\
Add an extra space at the end of the string if we find a backslash. This is \
to avoid things like \[OpenCurlyDoubleQuote]\\alphab\[CloseCurlyDoubleQuote] \
instead of \[OpenCurlyDoubleQuote]\\alpha b\[CloseCurlyDoubleQuote] in the \
list of indices.\
\>", "Text",
 CellChangeTimes->{{3.5643839961071606`*^9, 3.5643840968521376`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtraSpaceIfBackslash", "[", "str_String", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"StringFreeQ", "[", 
      RowBox[{"str", ",", "\"\<\\\\\>\""}], "]"}], ",", "str", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"str", ",", "\"\< \>\""}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell["\<\
Those indices which are not recognized by neither UpIndexQ or DownIndexQ (for \
example patterns) are treated as symbols from the IndexForm:\
\>", "Text",
 CellChangeTimes->{{3.5831374324650116`*^9, 3.58313744851744*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexIndexForm", "[", "index_", "]"}], ":=", 
  RowBox[{"Tex", "[", 
   RowBox[{"IndexForm", "[", "index", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.583137441294627*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"One", " ", "index"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TexUpIndex", "[", "index_", "]"}], ":=", 
    RowBox[{"ExtraSpaceIfBackslash", "@", 
     RowBox[{"TexIndexForm", "@", "index"}]}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.564384118161775*^9, 3.5643841191601768`*^9}, {
  3.5687125825738554`*^9, 3.568712608376301*^9}}],

Cell["Jose\[CloseCurlyQuote]s old code. Now deactivated.", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Lists", " ", "of", " ", "indices"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", "list_IndexList", "]"}], ":=", 
     RowBox[{"Apply", "[", 
      RowBox[{"StringJoin", ",", 
       RowBox[{"TexIndex", "/@", "list"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", 
      RowBox[{"list_IndexList", ",", "der_String"}], "]"}], ":=", 
     "\"\<TODO\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", 
      RowBox[{"IndexList", "[", "]"}], "]"}], ":=", 
     RowBox[{"Sequence", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Individual", " ", "index"}], ",", " ", 
     RowBox[{
     "with", " ", "or", " ", "without", " ", "a", " ", "derivative"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", 
      RowBox[{"index_", "?", "UpIndexQ"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<{}^{\>\"", ",", 
       RowBox[{"TexUpIndex", "[", "index", "]"}], ",", "\"\<}\>\""}], "]"}]}],
     ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", 
      RowBox[{"index_", "?", "DownIndexQ"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<{}_{\>\"", ",", 
       RowBox[{"TexUpIndex", "[", 
        RowBox[{"ChangeIndex", "[", "index", "]"}], "]"}], ",", "\"\<}\>\""}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", 
      RowBox[{
       RowBox[{"index_", "?", "UpIndexQ"}], ",", "der_String"}], "]"}], ":=", 
     
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<{}^{\>\"", ",", 
       RowBox[{"Tex", "@", "der"}], ",", 
       RowBox[{"TexUpIndex", "[", "index", "]"}], ",", "\"\<}\>\""}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", 
      RowBox[{
       RowBox[{"index_", "?", "DownIndexQ"}], ",", "der_String"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<{}_{\>\"", ",", 
       RowBox[{"Tex", "@", "der"}], ",", 
       RowBox[{"TexUpIndex", "[", 
        RowBox[{"ChangeIndex", "[", "index", "]"}], "]"}], ",", "\"\<}\>\""}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", "index_", "]"}], ":=", 
     RowBox[{"ToString", "[", "index", "]"}]}], ";"}]}]}]], "Input",
 Evaluatable->False],

Cell["Thomas\[CloseCurlyQuote] newer code. Highly recursive:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$TexPrintInitialBracesQ", "=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"initbraces", "[", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{"$TexPrintInitialBracesQ", ",", "\"\<{}\>\"", ",", "\"\<\>\""}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Main", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexIndices", "[", "]"}], ":=", 
   RowBox[{"Sequence", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexIndices", "[", 
    RowBox[{
     RowBox[{"first_", "?", "UpIndexQ"}], ",", "more___"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"initbraces", "[", "]"}], ",", "\"\<^{\>\"", ",", 
     RowBox[{"TexUpIndex", "[", "first", "]"}], ",", 
     RowBox[{"TexIndicesFromUp", "[", "more", "]"}], ",", "\"\<}\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TexIndices", "[", 
     RowBox[{
      RowBox[{"first_", "?", "DownIndexQ"}], ",", "more___"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"initbraces", "[", "]"}], ",", "\"\<_{\>\"", ",", 
      RowBox[{"TexUpIndex", "[", 
       RowBox[{"ChangeIndex", "@", "first"}], "]"}], ",", 
      RowBox[{"TexIndicesFromDown", "[", "more", "]"}], ",", "\"\<}\>\""}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Previous", " ", "index", " ", "was", " ", "up"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexIndicesFromUp", "[", "]"}], ":=", 
   RowBox[{"Sequence", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexIndicesFromUp", "[", 
    RowBox[{
     RowBox[{"first_", "?", "UpIndexQ"}], ",", "more___"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"TexUpIndex", "[", "first", "]"}], ",", 
     RowBox[{"TexIndicesFromUp", "[", "more", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TexIndicesFromUp", "[", 
     RowBox[{
      RowBox[{"first_", "?", "DownIndexQ"}], ",", "more___"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<}{}_{\>\"", ",", 
      RowBox[{"TexUpIndex", "[", 
       RowBox[{"ChangeIndex", "@", "first"}], "]"}], ",", 
      RowBox[{"TexIndicesFromDown", "[", "more", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Previous", " ", "index", " ", "was", " ", "down"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexIndicesFromDown", "[", "]"}], ":=", 
   RowBox[{"Sequence", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexIndicesFromDown", "[", 
    RowBox[{
     RowBox[{"first_", "?", "DownIndexQ"}], ",", "more___"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"TexUpIndex", "[", 
      RowBox[{"ChangeIndex", "@", "first"}], "]"}], ",", 
     RowBox[{"TexIndicesFromDown", "[", "more", "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TexIndicesFromDown", "[", 
     RowBox[{
      RowBox[{"first_", "?", "UpIndexQ"}], ",", "more___"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<}{}^{\>\"", ",", 
      RowBox[{"TexUpIndex", "[", "first", "]"}], ",", 
      RowBox[{"TexIndicesFromUp", "[", "more", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "With", " ", "derivative", " ", "indices", " ", "in", " ", "postfix", " ", 
    "notation"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TexCovDIndices", "[", "post_", "]"}], "[", 
    RowBox[{
     RowBox[{"first_", "?", "UpIndexQ"}], ",", "more___"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<{}^{\>\"", ",", "post", ",", 
     RowBox[{"TexUpIndex", "[", "first", "]"}], ",", 
     RowBox[{"TexIndicesFromUp", "[", "more", "]"}], ",", "\"\<}\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TexCovDIndices", "[", "post_", "]"}], "[", 
    RowBox[{
     RowBox[{"first_", "?", "DownIndexQ"}], ",", "more___"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<{}_{\>\"", ",", "post", ",", 
     RowBox[{"TexUpIndex", "[", 
      RowBox[{"ChangeIndex", "@", "first"}], "]"}], ",", 
     RowBox[{"TexIndicesFromDown", "[", "more", "]"}], ",", "\"\<}\>\""}], 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.7. Operators", "Subsection"],

Cell[TextData[{
 "Note that ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " expands -(a+b) into -a-b, but not -2(a+b). We also include the former \
case, because we could be formatting a held expression, for instance. \nWe \
also introduce OrderedPlus which is supposed to do mean the same as Plus, but \
it will not reorder the elements, but it will remove zeros."
}], "Text",
 CellChangeTimes->{{3.616503934745057*^9, 3.6165040014151506`*^9}, {
  3.6165040713952484`*^9, 3.616504080035261*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OrderedPlus", "[", 
    RowBox[{"0", ",", "terms__"}], "]"}], ":=", 
   RowBox[{"OrderedPlus", "[", "terms", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OrderedPlus", "[", 
    RowBox[{"terms1__", ",", "0", ",", "terms2___"}], "]"}], ":=", 
   RowBox[{"OrderedPlus", "[", 
    RowBox[{"terms1", ",", "terms2"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.61650400841516*^9, 3.6165041140753083`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Unary", " ", "minus"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TexOperator", "[", "Minus", "]"}], "=", "\"\<- \>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "expr_Plus"}], "|", 
        RowBox[{"-", "expr_OrderedPlus"}]}], ")"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexOperator", "[", "Minus", "]"}], ",", 
       RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
       RowBox[{"Tex", "[", "expr", "]"}], ",", 
       RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"-", "expr_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"TexOperator", "[", "Minus", "]"}], "<>", 
      RowBox[{"Tex", "[", "expr", "]"}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6165041280253277`*^9, 3.6165041433953495`*^9}, {
  3.616505013008712*^9, 3.616505027528732*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Product", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TexOperator", "[", "Times", "]"}], ":=", "\"\< \>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexFactor", "[", "1", "]"}], ":=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexFactor", "[", 
      RowBox[{"-", "1"}], "]"}], ":=", 
     RowBox[{"TexOperator", "[", "Minus", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexFactor", "[", 
      RowBox[{"(", 
       RowBox[{"expr_Plus", "|", "expr_OrderedPlus"}], ")"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
       RowBox[{"Tex", "[", "expr", "]"}], ",", 
       RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexFactor", "[", "expr_", "]"}], ":=", 
     RowBox[{"Tex", "[", "expr", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexOrdinaryTimes", "[", "expr_Times", "]"}], ":=", 
     RowBox[{"StringJoin", "@@", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"TexFactor", "/@", 
         RowBox[{"List", "@@", "expr"}]}], ",", 
        RowBox[{"TexOperator", "[", "Times", "]"}]}], "]"}]}]}], ";"}], "\n", 
   
   RowBox[{
    RowBox[{
     RowBox[{"TexOrdinaryTimes", "[", "expr_", "]"}], ":=", 
     RowBox[{"Tex", "@", "expr"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5594680046559944`*^9, 3.559468010740005*^9}, 
   3.559468052407678*^9, {3.616504166665382*^9, 3.616504173855392*^9}, {
   3.6165050438187547`*^9, 3.6165050480887604`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexFractionAsFraction", "=", "True"}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", "expr_Times", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"numer", "=", 
        RowBox[{"Numerator", "[", "expr", "]"}]}], ",", 
       RowBox[{"denom", "=", 
        RowBox[{"Denominator", "[", "expr", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"And", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"NumberQ", "[", "denom", "]"}]}], ",", 
         "$TexFractionAsFraction"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"TexFracExpression", "[", 
        RowBox[{"numer", ",", "denom", ",", "$TexFraction"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TexOrdinaryTimes", "[", "expr", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Sum", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TexOperator", "[", "Plus", "]"}], ":=", "\"\< + \>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"(", 
       RowBox[{"expr_Plus", "|", "expr_OrderedPlus"}], ")"}], "]"}], ":=", 
     RowBox[{"StringJoin", "@@", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"Tex", "/@", 
         RowBox[{"List", "@@", "expr"}]}], ",", 
        RowBox[{"TexOperator", "[", "Plus", "]"}]}], "]"}]}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.616504204669483*^9, 3.6165042419795356`*^9}, {
  3.616505060588778*^9, 3.6165050651887846`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Square", " ", "root", " ", "of", " ", "a", " ", "number"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"num_", "?", "NumberQ"}], "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<\\\\sqrt{\>\"", ",", 
       RowBox[{"Tex", "[", "num", "]"}], ",", "\"\<}\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Power", "[", 
       RowBox[{
        RowBox[{"num_", "?", "NumberQ"}], ",", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]}], "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"$TexSmallFraction", ",", "\"\<{1}{\\\\sqrt{\>\"", ",", 
       RowBox[{"Tex", "[", "num", "]"}], ",", "\"\<}}\>\""}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True],

Cell["\<\
Special code to include square roots of numbers in the fractions.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExtractNumericalFactor", "[", "expr_Times", "]"}], ":=", 
   RowBox[{"Times", "@@", 
    RowBox[{"(", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"List", "@@", "expr"}], ",", "NumberQ"}], "]"}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtractNumericalFactor", "[", 
    RowBox[{"num_", "?", "NumberQ"}], "]"}], ":=", "num"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtractNumericalFactor", "[", "___", "]"}], ":=", "1"}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Other", " ", "square", " ", "roots"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{"expr", ":", 
      RowBox[{"Times", "[", 
       RowBox[{
        RowBox[{"Power", "[", 
         RowBox[{
          RowBox[{"num_", "?", "NumberQ"}], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "]"}], ",", "___"}], "]"}]}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"numfactor", "=", 
         RowBox[{"ExtractNumericalFactor", "[", 
          RowBox[{"expr", " ", 
           RowBox[{"Sqrt", "[", "num", "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"numer", "=", 
         RowBox[{"Numerator", "[", 
          RowBox[{"expr", " ", 
           RowBox[{"Sqrt", "[", "num", "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"denom1", "=", 
         RowBox[{"Denominator", "[", 
          RowBox[{"expr", " ", 
           RowBox[{"Sqrt", "[", "num", "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Or", "[", 
         RowBox[{
          RowBox[{"!", "$TexFractionAsFraction"}], ",", 
          RowBox[{"NumberQ", "[", "denom1", "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{"TexFracExpression", "[", 
           RowBox[{
            RowBox[{"Numerator", "[", "numfactor", "]"}], ",", 
            RowBox[{
             RowBox[{"Denominator", "[", "numfactor", "]"}], 
             RowBox[{"Sqrt", "[", "num", "]"}]}], ",", "$TexSmallFraction"}], 
           "]"}], ",", 
          RowBox[{"TexFactor", "[", 
           RowBox[{"expr", " ", 
            RowBox[{
             RowBox[{"Sqrt", "[", "num", "]"}], "/", "numfactor"}]}], "]"}]}],
          "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"TexFracExpression", "[", 
         RowBox[{"numer", ",", 
          RowBox[{"denom1", " ", 
           RowBox[{"Sqrt", "[", "num", "]"}]}], ",", "$TexFraction"}], 
         "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Power", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TexOperator", "[", "Power", "]"}], ":=", "\"\<^\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexBase", "[", 
      RowBox[{"x", ":", 
       RowBox[{"(", 
        RowBox[{"_Symbol", "|", "_Integer", "|", 
         RowBox[{
          RowBox[{"_", "?", "xTensorQ"}], "[", "___", "]"}]}], ")"}]}], "]"}],
      ":=", 
     RowBox[{"Tex", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexBase", "[", 
      RowBox[{"x", ":", 
       RowBox[{"Scalar", "[", "expr_", "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Tex", "[", "x", "]"}], "/;", "$TexScalarParentheses"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexBase", "[", "x_", "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
       RowBox[{"Tex", "[", "x", "]"}], ",", 
       RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexExponent", "[", "x_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$TexSmallFraction", "=", "$TexSmallFractionExponent"}], 
        "}"}], ",", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tex", "=", 
           RowBox[{"Tex", "[", "x", "]"}]}], "}"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringLength", "[", "tex", "]"}], "===", "1"}], ",", 
           "tex", ",", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<{\>\"", ",", "tex", ",", "\"\<}\>\""}], "]"}]}], 
          "]"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Tex", "[", 
       RowBox[{"Power", "[", 
        RowBox[{"x_", ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<\\\\frac{1}{\>\"", ",", 
         RowBox[{"Tex", "[", "x", "]"}], ",", "\"\<}\>\""}], "]"}], "/;", 
       RowBox[{
        RowBox[{"ByteCount", "[", "x", "]"}], "<", "200"}]}]}], ";"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Power", "[", 
       RowBox[{"x_", ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"TexFracExpression", "[", 
       RowBox[{"1", ",", "x", ",", "$TexFraction"}], "]"}], "/;", 
      "$TexFractionAsFraction"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Power", "[", 
       RowBox[{"x_", ",", "n_"}], "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexBase", "[", "x", "]"}], ",", 
       RowBox[{"TexOperator", "[", "Power", "]"}], ",", 
       RowBox[{"TexExponent", "[", "n", "]"}]}], "]"}]}], ";"}]}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.5806310177668314`*^9, 3.580631044115278*^9}, {
  3.5831348611260953`*^9, 3.583134950935453*^9}, {3.5831349858639145`*^9, 
  3.583134996565533*^9}, {3.6057870236332474`*^9, 3.605787033513261*^9}, {
  3.6057870673133082`*^9, 3.6057871173333783`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Abs", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Power", "[", 
       RowBox[{
        RowBox[{"Abs", "[", "x_", "]"}], ",", "n_"}], "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexOpen", "[", "\"\<|\>\"", "]"}], ",", 
       RowBox[{"Tex", "[", "x", "]"}], ",", 
       RowBox[{"TexClose", "[", "\"\<|\>\"", "]"}], ",", 
       RowBox[{"TexOperator", "[", "Power", "]"}], ",", 
       RowBox[{"TexExponent", "[", "n", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Abs", "[", "x_", "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexOpen", "[", "\"\<|\>\"", "]"}], ",", 
       RowBox[{"Tex", "[", "x", "]"}], ",", 
       RowBox[{"TexClose", "[", "\"\<|\>\"", "]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6057871411334114`*^9, 3.6057871451434174`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["3.8. Basis objects", "Subsection",
 CellChangeTimes->{3.583148454082223*^9}],

Cell[BoxData[
 RowBox[{"(*", " ", "Basis", " ", "*)"}]], "Input",
 InitializationCell->True],

Cell["\<\
This has to come before the general tensor code because we might want to \
change the typesetting for a basis object.\
\>", "Text",
 CellChangeTimes->{{3.583148658941783*^9, 3.5831487177070856`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Basis", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
  RowBox[{"TexBasis", "[", 
   RowBox[{"a", ",", "b"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5831484888078833`*^9, 3.5831484922710896`*^9}, {
  3.5831485666052203`*^9, 3.583148598756877*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexBasis", "[", "inds__", "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"Tex", "[", "Basis", "]"}], ",", 
     RowBox[{"TexIndices", "[", "inds", "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5831486042324867`*^9, 3.5831486370861444`*^9}, {
  3.583148744726333*^9, 3.5831487495311413`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FormatTexBasis", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i_Integer", ",", 
       RowBox[{"basis_", "?", "BasisQ"}]}], "}"}], ",", "texstring_String"}], 
    "]"}], ":=", 
   RowBox[{"SetDelayed", "[", 
    RowBox[{
     RowBox[{"TexBasis", "[", 
      RowBox[{"ind_", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "basis"}], "}"}]}], "]"}], ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"texstring", ",", 
       RowBox[{"TexIndices", "[", "ind", "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FormatTexBasis", "[", 
    RowBox[{"{", 
     RowBox[{"i_Integer", ",", 
      RowBox[{"basis_", "?", "BasisQ"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Unset", "[", 
    RowBox[{"TexBasis", "[", 
     RowBox[{"ind_", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "basis"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FormatTexBasis", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i_Integer", ",", 
       RowBox[{"-", 
        RowBox[{"basis_", "?", "BasisQ"}]}]}], "}"}], ",", 
     "texstring_String"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"SetDelayed", "[", 
    RowBox[{
     RowBox[{"TexBasis", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"-", "basis"}]}], "}"}], ",", "ind_"}], "]"}], ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"texstring", ",", 
       RowBox[{"TexIndices", "[", "ind", "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5831492595092382`*^9, 3.5831493793018484`*^9}, {
   3.5831494248539286`*^9, 3.58314948842404*^9}, 3.5831500002931395`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FormatTexBasis", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"covd_Symbol", "?", "CovDQ"}], "[", 
      RowBox[{"{", 
       RowBox[{"i_Integer", ",", "basis_"}], "}"}], "]"}], ",", 
     "texstring_String"}], "]"}], ":=", 
   RowBox[{"SetDelayed", "[", 
    RowBox[{
     RowBox[{"TexCovDPrefix", "[", 
      RowBox[{"covd", ",", 
       RowBox[{"IndexList", "[", 
        RowBox[{"{", 
         RowBox[{"i", ",", "basis"}], "}"}], "]"}]}], "]"}], ",", 
     "texstring"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormatTexBasis", "[", 
   RowBox[{
    RowBox[{"covd_Symbol", "?", "CovDQ"}], "[", 
    RowBox[{"{", 
     RowBox[{"i_Integer", ",", "basis_"}], "}"}], "]"}], "]"}], ":=", 
  RowBox[{"Unset", "[", 
   RowBox[{"TexCovDPrefix", "[", 
    RowBox[{"covd", ",", 
     RowBox[{"IndexList", "[", 
      RowBox[{"{", 
       RowBox[{"i", ",", "basis"}], "}"}], "]"}]}], "]"}], "]"}]}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.5831495227285004`*^9, 3.583149548796146*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["3.9. Tensors", "Subsection",
 CellChangeTimes->{3.5831484573738284`*^9}],

Cell["Jose\[CloseCurlyQuote]s old code on tensors:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Tensors", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{
       RowBox[{"tensor_", "?", "xTensorQ"}], "[", "indices___", "]"}], "]"}], 
     ":=", 
     RowBox[{"TexTensorCombine", "[", 
      RowBox[{
       RowBox[{"Tex", "[", "tensor", "]"}], ",", 
       RowBox[{"TexIndex", "/@", 
        RowBox[{"IndexList", "[", "indices", "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexTensorCombine", "[", 
      RowBox[{"tensor_", ",", 
       RowBox[{"IndexList", "[", "indices___", "]"}]}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"tensor", ",", "indices"}], "]"}]}], ";"}]}]}]], "Input",
 Evaluatable->False],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"New symbol created: \"\>", 
   "\[InvisibleSpace]", "\<\"TexTensorCombine\"\>", 
   "\[InvisibleSpace]", "\<\", Context: \"\>", 
   "\[InvisibleSpace]", "\<\"xAct`xTensor`Private`\"\>"}],
  SequenceForm[
  "New symbol created: ", "TexTensorCombine", ", Context: ", 
   "xAct`xTensor`Private`"],
  Editable->False]], "Print"]
}, Open  ]],

Cell["Thomas\[CloseCurlyQuote] code, producing less parenthesization:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Tensors", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{
      RowBox[{"tensor_", "?", "xTensorQ"}], "[", "indices___", "]"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"Tex", "[", "tensor", "]"}], ",", 
      RowBox[{"TexIndices", "[", "indices", "]"}]}], "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.619628741889248*^9, 3.6196287434992495`*^9}, {
  3.6196292342800336`*^9, 3.61962927462009*^9}, {3.6196293634602146`*^9, 
  3.6196293644102154`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["3.10. Scalar functions", "Subsection",
 CellChangeTimes->{{3.5831484590118313`*^9, 3.5831484595266323`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Derivatives", " ", "of", " ", "scalar", " ", "functions"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"deriv", "[", 
      RowBox[{"var_", ",", "1"}], "]"}], ":=", 
     RowBox[{"\"\<\\\\partial \>\"", "<>", 
      RowBox[{"Tex", "[", "var", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"deriv", "[", 
      RowBox[{"var_", ",", "n_"}], "]"}], ":=", 
     RowBox[{"\"\<\\\\partial^{\>\"", "<>", 
      RowBox[{"Tex", "[", "n", "]"}], "<>", "\"\<}\>\"", "<>", 
      RowBox[{"Tex", "[", "var", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"withrespectto", "[", 
      RowBox[{"vars_List", ",", "ders_List"}], "]"}], ":=", 
     RowBox[{"Inner", "[", 
      RowBox[{"withrespectto", ",", "vars", ",", "ders", ",", "StringJoin"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"withrespectto", "[", 
      RowBox[{"var_", ",", "0"}], "]"}], ":=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"withrespectto", "[", 
      RowBox[{"var_", ",", "1"}], "]"}], ":=", 
     RowBox[{"\"\<\\\\partial \>\"", "<>", 
      RowBox[{"Tex", "[", "var", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"withrespectto", "[", 
      RowBox[{"var_", ",", "n_"}], "]"}], ":=", 
     RowBox[{"\"\<\\\\partial \>\"", "<>", 
      RowBox[{"Tex", "[", "var", "]"}], "<>", "\"\<^{\>\"", "<>", 
      RowBox[{"Tex", "[", "n", "]"}], "<>", "\"\<}\>\""}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "ders__", "]"}], "[", 
        RowBox[{"f_", "?", "ScalarFunctionQ"}], "]"}], "[", "vars__", "]"}], 
      "]"}], ":=", 
     RowBox[{"\"\<\\\\frac{\>\"", "<>", 
      RowBox[{"deriv", "[", 
       RowBox[{
        RowBox[{"f", "[", "vars", "]"}], ",", 
        RowBox[{"Plus", "[", "ders", "]"}]}], "]"}], "<>", "\"\<}{\>\"", "<>", 
      RowBox[{"withrespectto", "[", 
       RowBox[{
        RowBox[{"{", "vars", "}"}], ",", 
        RowBox[{"{", "ders", "}"}]}], "]"}], "<>", "\"\<}\>\""}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Factorial", "[", "n_Symbol", "]"}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"Tex", "[", "n", "]"}], ",", "\"\<!\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Factorial", "[", "n_", "]"}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
    RowBox[{"Tex", "[", "n", "]"}], ",", 
    RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}], ",", "\"\<!\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Factorial2", "[", "n_Symbol", "]"}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"Tex", "[", "n", "]"}], ",", "\"\<!!\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Factorial2", "[", "n_", "]"}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
    RowBox[{"Tex", "[", "n", "]"}], ",", 
    RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}], ",", "\"\<!!\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Pochhammer", "[", 
    RowBox[{"n_", ",", "k_"}], "]"}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
    RowBox[{"Tex", "[", "n", "]"}], ",", 
    RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}], ",", "\"\<_{\>\"", ",", 
    RowBox[{"Tex", "[", "k", "]"}], ",", "\"\<}\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Binomial", "[", 
    RowBox[{"n_", ",", "k_"}], "]"}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{"\"\<\\\\binom{\>\"", ",", 
    RowBox[{"Tex", "[", "n", "]"}], ",", "\"\<}{\>\"", ",", 
    RowBox[{"Tex", "[", "k", "]"}], ",", "\"\<}\>\""}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5954310761892896`*^9, 3.595431081729297*^9}, {
  3.5954313887097273`*^9, 3.5954314408708*^9}, {3.5955779884494324`*^9, 
  3.595578109859602*^9}, {3.595578219019755*^9, 3.5955782280997677`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Other", " ", "scalar", " ", "functions"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{
       RowBox[{"f_", "?", "ScalarFunctionQ"}], "[", "args__", "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"Tex", "[", "f", "]"}], ",", 
       RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"InsertComma", "[", 
         RowBox[{"Tex", "/@", 
          RowBox[{"{", "args", "}"}]}], "]"}]}], ",", 
       RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"InsertComma", "[", "arguments_List", "]"}], ":=", 
     RowBox[{"Insert", "[", 
      RowBox[{"arguments", ",", "\"\<, \>\"", ",", 
       RowBox[{"List", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"2", ",", 
          RowBox[{"Length", "[", "arguments", "]"}]}], "]"}]}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.11. Inert heads", "Subsection",
 CellChangeTimes->{3.583148461710636*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Innert", " ", "heads"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{
      RowBox[{"ih_", "?", "InertHeadQ"}], "[", 
      RowBox[{"expr_", ",", "z___"}], "]"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"Tex", "[", "ih", "]"}], ",", 
      RowBox[{"TexOpen", "[", "\"\<[\>\"", "]"}], ",", 
      RowBox[{"Tex", "[", "expr", "]"}], ",", 
      RowBox[{"TexClose", "[", "\"\<]\>\"", "]"}]}], "]"}]}], 
   ";"}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.12. Scalar expressions", "Subsection",
 CellChangeTimes->{3.583148463192639*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Remove", " ", "the", " ", "Scalar", " ", "head"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"$TexScalarParentheses", "=", "True"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Scalar", "[", "expr_", "]"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{"$TexScalarParentheses", ",", "\[IndentingNewLine]", 
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
         RowBox[{"Tex", "[", "expr", "]"}], ",", 
         RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Tex", "[", "expr", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.13. Covariant derivatives", "Subsection",
 CellChangeTimes->{3.583148465033442*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Covariant", " ", "derivatives"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"covd_Symbol", "?", "CovDQ"}], "[", "inds__", "]"}], "[", 
       "expr_", "]"}], "]"}], ":=", 
     RowBox[{"TexCovDCombine", "[", 
      RowBox[{"covd", ",", 
       RowBox[{"Tex", "[", "expr", "]"}], ",", 
       RowBox[{"IndexList", "[", "inds", "]"}], ",", "$CovDFormat"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexCovDCombine", "[", 
      RowBox[{
      "covd_", ",", "exprstring_String", ",", "list_IndexList", ",", 
       "\"\<Prefix\>\""}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexCovDPrefix", "[", 
        RowBox[{"covd", ",", "list"}], "]"}], ",", "exprstring"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexCovDPrefix", "[", 
      RowBox[{"covd_", ",", "list_IndexList"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"Last", "@", 
        RowBox[{"TexCovD", "[", "covd", "]"}]}], ",", 
       RowBox[{"TexIndices", "@@", "list"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexCovDCombine", "[", 
      RowBox[{
      "covd_", ",", "exprstring_String", ",", "list_IndexList", ",", 
       "\"\<Postfix\>\""}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"exprstring", ",", 
       RowBox[{
        RowBox[{"TexCovDIndices", "[", 
         RowBox[{"First", "@", 
          RowBox[{"TexCovD", "@", "covd"}]}], "]"}], "@@", "list"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "If", " ", "the", " ", "$CovDFormat", " ", "only", " ", "gives", " ", 
      "one", " ", "string"}], ",", " ", 
     RowBox[{"use", " ", "it", " ", "for", " ", "both", " ", 
      RowBox[{"cases", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexCovD", "[", "covd_", "]"}], ":=", 
     RowBox[{"Tex", "/@", 
      RowBox[{"SymbolOfCovD", "[", "covd", "]"}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5831350205895753`*^9, 3.5831350985585127`*^9}, {
   3.583135714339394*^9, 3.583135719565403*^9}, 3.583136176427806*^9, {
   3.583146255318761*^9, 3.5831463017756424`*^9}, {3.5831463427725143`*^9, 
   3.5831464231750555`*^9}, 3.5831466103753843`*^9, {3.583146716502371*^9, 
   3.5831467772644777`*^9}, {3.58314680738813*^9, 3.583146811990138*^9}, {
   3.583147184504193*^9, 3.583147288415975*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"TexCovDCombine", "[", 
     RowBox[{
      RowBox[{"{", "a_", "}"}], ",", "b___"}], "]"}], ":=", 
    RowBox[{"TexCovDCombine", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "a"}], "}"}], ",", "b"}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{"CovD", "[", 
      RowBox[{"expr_", ",", "ders___", ",", 
       RowBox[{
        RowBox[{"der_Symbol", "?", "CovDQ"}], "[", "inds__", "]"}]}], "]"}], 
     "]"}], ":=", 
    RowBox[{"TexCovDCombine", "[", 
     RowBox[{
      RowBox[{"TexCovD", "[", "der", "]"}], ",", 
      RowBox[{"Tex", "[", "expr", "]"}], ",", 
      RowBox[{"IndexList", "[", "inds", "]"}], ",", "$CovDFormat"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.5831462782664013`*^9, 3.5831462978288355`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["3.14. Lie derivatives and brackets", "Subsection",
 CellChangeTimes->{
  3.583148466609045*^9, {3.6205422433640704`*^9, 3.6205422474740763`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Lie", " ", "derivatives"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{
      RowBox[{"LieD", "[", 
       RowBox[{"n_Symbol", "[", "_", "]"}], "]"}], "[", "expr_", "]"}], "]"}],
     ":=", 
    RowBox[{"\"\<\\\\mathcal{L}_\>\"", "<>", 
     RowBox[{"Tex", "[", "n", "]"}], "<>", 
     RowBox[{"Tex", "[", "expr", "]"}]}]}], ";"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Brackets", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{"Bracket", "[", 
      RowBox[{"expr1_", ",", "expr2_"}], "]"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"TexOpen", "[", "\"\<[\>\"", "]"}], ",", 
      RowBox[{"Tex", "[", "expr1", "]"}], ",", "\"\<, \>\"", ",", " ", 
      RowBox[{"Tex", "[", "expr2", "]"}], ",", 
      RowBox[{"TexClose", "[", "\"\<]\>\"", "]"}]}], "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.620542260424094*^9, 3.6205423774442577`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["3.15. Parametric derivatives", "Subsection",
 CellChangeTimes->{3.583148468949049*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Parametric", " ", "derivative"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TexParamD", "[", 
      RowBox[{"{", "ps_", "}"}], "]"}], ":=", 
     RowBox[{"\"\<\\\\partial_\>\"", "<>", 
      RowBox[{"Tex", "[", "ps", "]"}], "<>", "\"\< \>\""}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexParamD", "[", 
      RowBox[{"ps", ":", 
       RowBox[{"{", "__", "}"}]}], "]"}], ":=", 
     RowBox[{"\"\<\\\\partial_\>\"", "<>", 
      RowBox[{"Tex", "[", 
       RowBox[{"First", "[", "ps", "]"}], "]"}], "<>", "\"\<^{\>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"Length", "[", "ps", "]"}], "]"}], "<>", "\"\<} \>\""}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{
       RowBox[{"ParamD", "[", "ps__", "]"}], "[", "expr_", "]"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"$ParamDFormat", "==", "\"\<Postfix\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"Tex", "[", "expr", "]"}], ",", "\"\<{}_{,\>\"", ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{"Tex", "/@", 
            RowBox[{"{", "ps", "}"}]}], ")"}]}], ",", "\"\<}\>\""}], "]"}], 
       ",", 
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{"StringJoin", ",", 
          RowBox[{"TexParamD", "/@", 
           RowBox[{"Split", "@", 
            RowBox[{"Sort", "[", 
             RowBox[{"{", "ps", "}"}], "]"}]}]}]}], "]"}], "<>", 
        RowBox[{"Tex", "[", "expr", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Tex", "[", 
       RowBox[{
        RowBox[{"ParamD", "[", "ps__", "]"}], "[", "expr_", "]"}], "]"}], ":=", \

      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"StringJoin", ",", 
         RowBox[{"TexParamD", "/@", 
          RowBox[{"Split", "@", 
           RowBox[{"Sort", "[", "ps", "]"}]}]}]}], "]"}], "<>", 
       RowBox[{"TexOpen", "[", "\"\<[\>\"", "]"}], "<>", 
       RowBox[{"Tex", "[", "expr", "]"}], "<>", 
       RowBox[{"TexClose", "[", "\"\<]\>\"", "]"}]}]}], ";"}], 
    "\[IndentingNewLine]", "*)"}]}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.16. Equalities and inequalities", "Subsection",
 CellChangeTimes->{
  3.5831484708834524`*^9, {3.5955814809293222`*^9, 3.5955814858993287`*^9}, {
   3.595581619059515*^9, 3.5955816199895163`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Equal", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", "expr_Equal", "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"Riffle", "[", 
      RowBox[{
       RowBox[{"Tex", "/@", 
        RowBox[{"List", "@@", "expr"}]}], ",", "\"\< = \>\""}], "]"}], 
     "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5955814987393465`*^9, 3.5955815034193535`*^9}, {
  3.6045951807047195`*^9, 3.6045952122747636`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Less", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", "expr_Less", "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"Riffle", "[", 
      RowBox[{
       RowBox[{"Tex", "/@", 
        RowBox[{"List", "@@", "expr"}]}], ",", "\"\< < \>\""}], "]"}], 
     "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5955814987393465`*^9, 3.595581516679372*^9}, {
  3.60459521669477*^9, 3.6045952291947875`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "LessEqual", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", "expr_LessEqual", "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"Riffle", "[", 
      RowBox[{
       RowBox[{"Tex", "/@", 
        RowBox[{"List", "@@", "expr"}]}], ",", "\"\< \\\\leq \>\""}], "]"}], 
     "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5955814987393465`*^9, 3.595581516679372*^9}, {
  3.5955815554794264`*^9, 3.595581563029437*^9}, {3.6045952337547936`*^9, 
  3.6045952552448235`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Less", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", "expr_Greater", "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"Riffle", "[", 
      RowBox[{
       RowBox[{"Tex", "/@", 
        RowBox[{"List", "@@", "expr"}]}], ",", "\"\< > \>\""}], "]"}], 
     "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5955814987393465`*^9, 3.595581516679372*^9}, {
  3.595581585799469*^9, 3.595581591359476*^9}, {3.6045952599348307`*^9, 
  3.6045952743748503`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "LessEqual", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", "expr_GreaterEqual", "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"Riffle", "[", 
      RowBox[{
       RowBox[{"Tex", "/@", 
        RowBox[{"List", "@@", "expr"}]}], ",", "\"\< \\\\geq \>\""}], "]"}], 
     "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5955814987393465`*^9, 3.595581516679372*^9}, {
  3.5955815554794264`*^9, 3.595581563029437*^9}, {3.595581595839483*^9, 
  3.5955816066794977`*^9}, {3.604595277994856*^9, 3.6045952966048813`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["3.17. The TexPrint function", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexFixExtraRules", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Note", " ", "that", " ", "we", " ", "remove", " ", "the", " ", 
    RowBox[{"dollars", "!"}], " ", "This", " ", "is", " ", "because", " ", 
    "\[Mu]3", " ", "is", " ", "converted", " ", "into", " ", 
    RowBox[{"$", "\\", "mu$3"}], " ", "for", " ", "instance"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TexFix", "[", "string_String", "]"}], ":=", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringReplace", "[", 
       RowBox[{"string", ",", 
        RowBox[{"\"\<$\>\"", "->", "\"\<\>\""}]}], "]"}], ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<+-\>\"", "\[Rule]", "\"\<-\>\""}], ",", 
          RowBox[{"\"\<+ -\>\"", "\[Rule]", "\"\<- \>\""}], ",", 
          RowBox[{"\"\< _\>\"", "->", "\"\<_\>\""}], ",", 
          RowBox[{"\"\< ^\>\"", "->", "\"\<^\>\""}], ",", 
          RowBox[{"\"\<  \>\"", "->", "\"\< \>\""}], ",", 
          RowBox[{"\"\<   \>\"", "->", "\"\< \>\""}], ",", " ", 
          RowBox[{"\"\< }\>\"", "\[Rule]", "\"\<}\>\""}]}], "}"}], ",", 
        "$TexFixExtraRules"}], "]"}]}], "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.564383847298499*^9, 3.5643838565961156`*^9}, {
  3.5643843380753613`*^9, 3.5643843429893703`*^9}, {3.5643850301715765`*^9, 
  3.5643850442116013`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Main", ".", " ", "Public"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TexPrint", "[", 
     RowBox[{"expr_", ",", 
      RowBox[{"initlevel_:", "Automatic"}]}], "]"}], ":=", 
    RowBox[{"TexFix", "@", 
     RowBox[{"TexParenthesis", "[", 
      RowBox[{
       RowBox[{"ScreenDollarIndices", "[", "expr", "]"}], ",", "initlevel"}], 
      "]"}]}]}], ";"}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.18. Matrices", "Subsection",
 CellChangeTimes->{{3.559468159345866*^9, 3.5594681704062853`*^9}, 
   3.559468557988966*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexMatrix", "[", 
   RowBox[{
    RowBox[{"M_", "?", "MatrixQ"}], ",", 
    RowBox[{"F_:", " ", "Tex"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rows", "=", 
       RowBox[{"Length", "[", "M", "]"}]}], ",", 
      RowBox[{"cols", "=", 
       RowBox[{"Length", "@", 
        RowBox[{"First", "@", "M"}]}]}]}], "}"}], ",", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<\\\\left(\\\\begin{array}{\>\"", ",", 
      RowBox[{"StringJoin", "@@", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"\"\<c\>\"", ",", 
         RowBox[{"{", "cols", "}"}]}], "]"}]}], ",", "\"\<}\\n\>\"", ",", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"Riffle", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{"Riffle", "[", 
             RowBox[{
              RowBox[{"F", "/@", "#"}], ",", "\"\< & \>\""}], "]"}], "]"}], 
           "&"}], "/@", "M"}], ",", "\"\<\\\\\\\\\\n\>\""}], "]"}], "]"}], 
      ",", "\"\<\\n\\\\end{array}\\\\right)\>\""}], "]"}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.559468186645914*^9, 3.559468186645914*^9}, {
   3.5594686726803675`*^9, 3.5594686744587708`*^9}, {3.5594688200392265`*^9, 
   3.5594688221920304`*^9}, {3.5594688679937105`*^9, 3.559468877540928*^9}, 
   3.5594695668437386`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["3.19. Hold", "Subsection",
 CellChangeTimes->{{3.5915971338389783`*^9, 3.591597147628998*^9}}],

Cell["\<\
Hold can be used to stop a derivative to use the Leibniz rule, and it can \
also stop other automatic rules to be applied. Therefore, it might be a \
useful tool for typesetting too. We just typeset it as a parentesis.\
\>", "Text",
 CellChangeTimes->{{3.591597295079204*^9, 3.591597376519318*^9}, {
  3.591597408584703*^9, 3.5915975180315533`*^9}, {3.591597585772648*^9, 
  3.591597611092684*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"Hold", "[", "expr_", "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
     RowBox[{"Tex", "[", "expr", "]"}], ",", 
     RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5915972372791233`*^9, 3.591597252769145*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["3.20. SeriesData", "Subsection",
 CellChangeTimes->{{3.5915971338389783`*^9, 3.591597147628998*^9}, {
  3.6045914295767665`*^9, 3.6045914337767725`*^9}}],

Cell["Older (deactivated)", "Text",
 CellChangeTimes->{{3.616502316647503*^9, 3.616502319947507*^9}, {
  3.6165024442217293`*^9, 3.6165024483217354`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"sdata", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SeriesData", "[", 
      RowBox[{"x_", ",", 
       RowBox[{"DirectedInfinity", "[", "1", "]"}], ",", 
       RowBox[{"{", "coeffs___", "}"}], ",", "nmin_Integer", ",", 
       "nmax_Integer", ",", "den_"}], "]"}], "]"}]}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{"Normal", "@", "sdata"}], "]"}], ",", 
    "\"\< + \\\\mathcal{O}\>\"", ",", 
    RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
    RowBox[{"Tex", "[", 
     RowBox[{
      RowBox[{"(", "x", ")"}], "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "nmax"}], "/", "den"}], ")"}]}], "]"}], ",", 
    RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.616396030386691*^9, 3.616396039056703*^9}, {
  3.6163967364108243`*^9, 3.616396741800832*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"sdata", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SeriesData", "[", 
      RowBox[{"x_", ",", "x0_", ",", 
       RowBox[{"{", "coeffs___", "}"}], ",", "nmin_Integer", ",", 
       "nmax_Integer", ",", "den_"}], "]"}], "]"}]}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{"Normal", "@", "sdata"}], "]"}], ",", 
    "\"\< + \\\\mathcal{O}\>\"", ",", 
    RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
    RowBox[{"Tex", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "-", "x0"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"nmax", "/", "den"}], ")"}]}], "]"}], ",", 
    RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6045915248268995`*^9, 3.6045915353569145`*^9}, {
  3.604595837233989*^9, 3.604595839003991*^9}, {3.6163960149566693`*^9, 
  3.616396018356674*^9}}],

Cell["New 2014-08-08", "Text",
 CellChangeTimes->{{3.616502311437495*^9, 3.616502313807499*^9}, {
  3.6165060253073215`*^9, 3.6165060294573274`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"sd", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SeriesData", "[", 
      RowBox[{"x_", ",", 
       RowBox[{"DirectedInfinity", "[", "1", "]"}], ",", "coefflist_List", 
       ",", "nmin_", ",", "nmax_", ",", "den_"}], "]"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Tex", "[", 
   RowBox[{"OrderedPlus", "@@", 
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"coefflist", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "*", 
           RowBox[{"x", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"#", "-", "1", "+", "nmin"}], ")"}]}], "/", "den"}], 
             ")"}]}]}], ")"}], "&"}], "/@", 
        RowBox[{"Range", "@", 
         RowBox[{"Length", "@", "coefflist"}]}]}], ")"}], ",", 
      RowBox[{"TexString", "@", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<\\\\mathcal{O}\>\"", ",", 
         RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
         RowBox[{"Tex", "[", 
          RowBox[{
           RowBox[{"(", "x", ")"}], "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "nmax"}], "/", "den"}], ")"}]}], "]"}], ",", 
         RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.616502205667347*^9, 3.616502249337408*^9}, 
   3.616502482691783*^9, {3.6165026768620553`*^9, 3.6165026869040956`*^9}, {
   3.616502840146332*^9, 3.616502850846347*^9}, {3.616503202940888*^9, 
   3.616503203500889*^9}, {3.616503253810959*^9, 3.616503263850973*^9}, {
   3.6165035310363955`*^9, 3.616503539396407*^9}, {3.6165044030497613`*^9, 
   3.6165044641598463`*^9}, {3.616504519883973*^9, 3.6165045272239833`*^9}, {
   3.616504599444084*^9, 3.616504715704247*^9}, {3.616505358883244*^9, 
   3.6165053659932537`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"sd", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SeriesData", "[", 
      RowBox[{
      "x_", ",", "x0_", ",", "coefflist_List", ",", "nmin_", ",", "nmax_", 
       ",", "den_"}], "]"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Tex", "[", 
   RowBox[{"OrderedPlus", "@@", 
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"coefflist", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "*", 
           RowBox[{
            RowBox[{"OrderedPlus", "[", 
             RowBox[{"x", ",", 
              RowBox[{"-", "x0"}]}], "]"}], "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "-", "1", "+", "nmin"}], ")"}], "/", "den"}], 
             ")"}]}]}], ")"}], "&"}], "/@", 
        RowBox[{"Range", "@", 
         RowBox[{"Length", "@", "coefflist"}]}]}], ")"}], ",", 
      RowBox[{"TexString", "@", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<\\\\mathcal{O}\>\"", ",", 
         RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
         RowBox[{"Tex", "[", 
          RowBox[{
           RowBox[{"OrderedPlus", "[", 
            RowBox[{"x", ",", 
             RowBox[{"-", "x0"}]}], "]"}], "^", 
           RowBox[{"(", 
            RowBox[{"nmax", "/", "den"}], ")"}]}], "]"}], ",", 
         RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.616502453411742*^9, 3.616502497621804*^9}, 
   3.616502694996129*^9, {3.6165028555463533`*^9, 3.6165028664163685`*^9}, {
   3.616502995080597*^9, 3.6165030008406053`*^9}, {3.6165032672009783`*^9, 
   3.6165032740109873`*^9}, {3.6165035465964174`*^9, 3.616503559076435*^9}, {
   3.6165037092706933`*^9, 3.6165037116406965`*^9}, {3.616504486249878*^9, 
   3.6165045399640007`*^9}, {3.616504738284279*^9, 3.6165047490942936`*^9}, {
   3.6165053693432584`*^9, 3.6165054214573793`*^9}, {3.6165055076675005`*^9, 
   3.6165055356475396`*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["4. SymManipulator", "Section",
 CellChangeTimes->{{3.5450150224250093`*^9, 3.5450150283062196`*^9}},
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell["4.1. Tex for SymH and CovarD", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xAct`SymManipulator`SymH", "[", 
      RowBox[{"headlist_", ",", "sym_", ",", "label_"}], "]"}], "?", 
     "xTensorQ"}], "[", "inds___", "]"}], "]"}], ":=", 
  RowBox[{"TexSymH", "[", 
   RowBox[{
    RowBox[{"xAct`SymManipulator`SymH", "[", 
     RowBox[{"headlist", ",", "sym", ",", "label"}], "]"}], "[", "inds", 
    "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.511599597135436*^9, 3.511599619022236*^9}, {
   3.5446721379221973`*^9, 3.5446721417574167`*^9}, 3.544947656489681*^9, {
   3.545015129643997*^9, 3.545015158831649*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"xAct`SymManipulator`CovarD", "[", 
     RowBox[{
      RowBox[{"D1_", "?", "CovDQ"}], ",", 
      RowBox[{"T_", "?", "xTensorQ"}], ",", "list_"}], "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Last", "@", 
       RowBox[{"SymbolOfCovD", "[", "D1", "]"}]}], "]"}], ",", 
     RowBox[{"Tex", "[", "T", "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5160825913697968`*^9, 3.5160826372254195`*^9}, 
   3.5449476584396844`*^9, 3.5449490665771575`*^9, 3.5449491358880796`*^9, {
   3.545015164697259*^9, 3.5450151839008927`*^9}, 3.545015926524597*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["4.2. TexSymH", "Subsection"],

Cell["\<\
This is a new code that can handle all cases that are possible to write in a \
nice way. The symmetries that are accepted are disjoint unions of symmetric \
and antisymmetric groups. The indices belonging to one such disjoint subgroup \
have to be all up or all down. If two disjoint subgroups are both acting on \
up or down indices, they have to act on disjoint ranges of indices. If any of \
these criteria fails, messages are printed, and the output is similar to the \
display form. \
\>", "Text",
 CellChangeTimes->{{3.545110811684252*^9, 3.545110856643531*^9}, {
  3.5451108948479977`*^9, 3.545111079318322*^9}, {3.545111127616007*^9, 
  3.5451112038533406`*^9}, {3.5451112426662087`*^9, 3.5451112947703004`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexGroupSymbols", "[", 
    RowBox[{"points_", ",", "sym_"}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"xAct`SymManipulator`SubgroupQ", "[", 
      RowBox[{
       RowBox[{"Symmetric", "[", "points", "]"}], ",", "sym"}], "]"}], ",", 
     RowBox[{"(*", " ", "Symmetric", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<(\>\"", ",", "\"\<)\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"xAct`SymManipulator`SubgroupQ", "[", 
      RowBox[{
       RowBox[{"Antisymmetric", "[", "points", "]"}], ",", "sym"}], "]"}], 
     ",", 
     RowBox[{"(*", " ", "Antisymmetric", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<[\>\"", ",", "\"\<]\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", "True", ",", 
     RowBox[{"(*", " ", 
      RowBox[{"Everything", " ", "else"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<Unkown\>\"", ",", "\"\<Unkown\>\""}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5450656415620627`*^9, 3.5450657173469963`*^9}, {
  3.5450728757790265`*^9, 3.545072878477831*^9}, {3.545108184021636*^9, 
  3.545108255376161*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexSymH", "[", 
   RowBox[{"x", ":", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"xAct`SymManipulator`SymH", "[", 
       RowBox[{"headlist_", ",", "sym_", ",", "label_"}], "]"}], "[", 
      "inds___", "]"}], ")"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"texfail", "=", "False"}], ",", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "@", 
        RowBox[{"List", "[", "inds", "]"}]}]}], ",", " ", 
      RowBox[{"indlist", "=", 
       RowBox[{"List", "@", "inds"}]}], ",", " ", "longorbits", ",", " ", 
      "orbitgroupsymbols", ",", "orbitondowninds", ",", "orbitonupinds", ",", 
      " ", "downsymorbits", ",", " ", "upsymorbits", ",", " ", 
      "excludesymdowninds", ",", "excludesymupinds", ",", " ", 
      "downindexslots", ",", " ", "beginsym", ",", " ", "endsym", ",", " ", 
      "beginexclude", ",", " ", "endexclude", ",", " ", "preindexsymbolrules",
       ",", " ", "postindexsymbolrules"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"longorbits", "=", 
      RowBox[{"Sort", "/@", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Orbits", "[", 
          RowBox[{"sym", ",", "n"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], ">", "1"}], "&"}]}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"orbitgroupsymbols", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"TexGroupSymbols", "[", 
         RowBox[{"#", ",", "sym"}], "]"}], "&"}], "/@", "longorbits"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{"Select", "[", 
          RowBox[{"orbitgroupsymbols", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#", "]"}], "===", "\"\<Unkown\>\""}], 
            "&"}]}], "]"}]}], ">", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"texfail", "=", "True"}], ";", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", 
         "\"\<Not a disjoint union of symmetric and antisymmetric \
groups.\>\"", "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"downindexslots", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "@", "indlist"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"DownIndexQ", "[", 
          RowBox[{"indlist", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"orbitondowninds", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"xAct`SymManipulator`Private`subsetQ", "[", 
         RowBox[{"#", ",", "downindexslots"}], "]"}], "&"}], "/@", 
       "longorbits"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"orbitonupinds", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Intersection", "[", 
           RowBox[{"#", ",", "downindexslots"}], "]"}], "]"}], "\[Equal]", 
         "0"}], "&"}], "/@", "longorbits"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"And", "@@", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Or", ",", 
           RowBox[{"{", 
            RowBox[{"orbitondowninds", ",", "orbitonupinds"}], "}"}]}], 
          "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"texfail", "=", "True"}], ";", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\<Not all indices are in good positions.\>\"", 
         "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"downsymorbits", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"longorbits", ",", "orbitondowninds"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"upsymorbits", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"longorbits", ",", "orbitonupinds"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "@", 
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{"OrderedQ", "[", 
           RowBox[{"Join", "@@", "downsymorbits"}], "]"}], ",", 
          RowBox[{"OrderedQ", "[", 
           RowBox[{"Join", "@@", "upsymorbits"}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"texfail", "=", "True"}], ";", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\<The symmetries are overlapping.\>\"", "]"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"excludesymdowninds", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"First", "@", "#"}], ",", 
            RowBox[{"Last", "@", "#"}]}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
        "downsymorbits"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"excludesymdowninds", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Intersection", "[", 
         RowBox[{"#", ",", "downindexslots"}], "]"}], "&"}], "/@", 
       "excludesymdowninds"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"excludesymupinds", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"First", "@", "#"}], ",", 
            RowBox[{"Last", "@", "#"}]}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
        "upsymorbits"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"excludesymupinds", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Intersection", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"Range", "@", "n"}], ",", "downindexslots"}], "]"}]}], 
         "]"}], "&"}], "/@", "excludesymupinds"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"beginsym", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"First", "/@", "downsymorbits"}], ",", 
        RowBox[{"First", "/@", "upsymorbits"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"endsym", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Last", "/@", "downsymorbits"}], ",", 
        RowBox[{"Last", "/@", "upsymorbits"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"beginexclude", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"First", "/@", 
         RowBox[{"Select", "[", 
          RowBox[{"excludesymdowninds", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "@", "#"}], ">", "0"}], ")"}], "&"}]}], 
          "]"}]}], ",", 
        RowBox[{"First", "/@", 
         RowBox[{"Select", "[", 
          RowBox[{"excludesymupinds", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "@", "#"}], ">", "0"}], ")"}], "&"}]}], 
          "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"endexclude", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Last", "/@", 
         RowBox[{"Select", "[", 
          RowBox[{"excludesymdowninds", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "@", "#"}], ">", "0"}], ")"}], "&"}]}], 
          "]"}]}], ",", 
        RowBox[{"Last", "/@", 
         RowBox[{"Select", "[", 
          RowBox[{"excludesymupinds", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "@", "#"}], ">", "0"}], ")"}], "&"}]}], 
          "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"preindexsymbolrules", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{"#", ",", 
          RowBox[{"orbitgroupsymbols", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"First", "@", 
              RowBox[{"First", "@", 
               RowBox[{"Position", "[", 
                RowBox[{"longorbits", ",", "#", ",", "2", ",", "1"}], 
                "]"}]}]}], ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], "/@", 
       "beginsym"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"postindexsymbolrules", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{"#", ",", 
          RowBox[{"orbitgroupsymbols", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"First", "@", 
              RowBox[{"First", "@", 
               RowBox[{"Position", "[", 
                RowBox[{"longorbits", ",", "#", ",", "2", ",", "1"}], 
                "]"}]}]}], ",", "2"}], "]"}], "]"}]}], "]"}], "&"}], "/@", 
       "endsym"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"preindexsymbolrules", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"preindexsymbolrules", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Rule", "[", 
           RowBox[{"#", ",", "\"\<|\>\""}], "]"}], "&"}], "/@", 
         "beginexclude"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"postindexsymbolrules", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"postindexsymbolrules", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Rule", "[", 
           RowBox[{"#", ",", "\"\<|\>\""}], "]"}], "&"}], "/@", 
         "endexclude"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"preindexsymbolrules", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "/.", "preindexsymbolrules"}], ")"}], "/.", 
           RowBox[{"Rule", "[", 
            RowBox[{"#", ",", "\"\<\>\""}], "]"}]}]}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", "n", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"postindexsymbolrules", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "/.", "postindexsymbolrules"}], ")"}], "/.", 
           RowBox[{"Rule", "[", 
            RowBox[{"#", ",", "\"\<\>\""}], "]"}]}]}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", "n", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"texfail", ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<Could not typset the SymH object nicely.\>\"", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
         "\"\<\\\\underset{\>\"", ",", "label", ",", "\"\<}{Sym}(\>\"", ",", 
          RowBox[{"TexPrint", "@", 
           RowBox[{"xAct`SymManipulator`RemoveSym", "@", "x"}]}], ",", 
          "\"\<)\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"TexKnownSymH", "[", 
        RowBox[{
        "headlist", ",", "n", ",", " ", "indlist", ",", "preindexsymbolrules",
          ",", " ", "postindexsymbolrules"}], "]"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5450651934356756`*^9, 3.5450652115785074`*^9}, {
   3.545065288876643*^9, 3.5450653050850716`*^9}, {3.545065442256113*^9, 
   3.545065443145314*^9}, {3.54506547492257*^9, 3.545065490428997*^9}, {
   3.5450656072264023`*^9, 3.545065626398836*^9}, {3.5450657320422215`*^9, 
   3.545065745380245*^9}, {3.5450657767363005`*^9, 3.5450658944073067`*^9}, {
   3.545066040361163*^9, 3.5450661377521343`*^9}, {3.545066516794286*^9, 
   3.5450665343443165`*^9}, {3.545066668480598*^9, 3.545066685578228*^9}, {
   3.5450671261509275`*^9, 3.545067294132023*^9}, {3.545067354847329*^9, 
   3.5450674561539073`*^9}, {3.5450676180977917`*^9, 
   3.5450676914491205`*^9}, {3.545067882487056*^9, 3.545068098158435*^9}, {
   3.545068181462581*^9, 3.5450681835061846`*^9}, {3.5450682713499393`*^9, 
   3.5450682790251527`*^9}, {3.5450683222528286`*^9, 
   3.5450683956353574`*^9}, {3.545068453480259*^9, 3.545068468783886*^9}, {
   3.5450687045938997`*^9, 3.54506872183193*^9}, {3.5450687614872*^9, 
   3.545068787554846*^9}, {3.5450688792674065`*^9, 3.5450688926834307`*^9}, {
   3.545068928891094*^9, 3.5450689894816003`*^9}, {3.545069029636071*^9, 
   3.545069047716503*^9}, {3.5450690916149797`*^9, 3.545069126403041*^9}, {
   3.545069711015068*^9, 3.5450697451791277`*^9}, {3.5450698222588634`*^9, 
   3.545069851306114*^9}, {3.5450700025795803`*^9, 3.5450702051147356`*^9}, {
   3.5450703791954412`*^9, 3.5450704071818905`*^9}, {3.545070638031096*^9, 
   3.545070703598011*^9}, 3.545070845964861*^9, {3.54507088493373*^9, 
   3.5450709393934255`*^9}, {3.545070988673912*^9, 3.5450710955340996`*^9}, {
   3.5450712856048336`*^9, 3.5450714319486904`*^9}, {3.545071526968457*^9, 
   3.545071605171395*^9}, {3.5450716352638474`*^9, 3.545071635981449*^9}, {
   3.5450717176475925`*^9, 3.545071720159197*^9}, {3.545071913271936*^9, 
   3.545071951523203*^9}, {3.54507249047395*^9, 3.545072495216358*^9}, {
   3.545072649469429*^9, 3.5450727031647234`*^9}, {3.5450727418995914`*^9, 
   3.545072751384408*^9}, {3.545106624579497*^9, 3.5451070082465706`*^9}, {
   3.5451070605066624`*^9, 3.5451070897879143`*^9}, {3.5451072151819344`*^9, 
   3.5451072175531387`*^9}, {3.5451072767708426`*^9, 3.545107280468049*^9}, {
   3.5451075095388513`*^9, 3.545107509913252*^9}, 3.545107817374192*^9, {
   3.545107853893856*^9, 3.545107925045581*^9}, {3.5451081642096014`*^9, 
   3.5451081809796305`*^9}, {3.5451082669201813`*^9, 3.5451083596623445`*^9}, 
   3.5451083990212135`*^9, {3.5451084967875853`*^9, 3.545108574553722*^9}, {
   3.545108625846612*^9, 3.545108627999416*^9}, {3.5451086791207056`*^9, 
   3.5451087744992733`*^9}, {3.5451088554946156`*^9, 
   3.5451088715782433`*^9}, {3.545109087482623*^9, 3.5451092069788327`*^9}, 
   3.545110335002214*^9, {3.54511044654241*^9, 3.5451104492100143`*^9}, {
   3.6151291771285443`*^9, 3.6151291774585447`*^9}, 3.615129585339116*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexKnownSymH", "[", 
   RowBox[{
   "headlist_", ",", "n_", ",", " ", "indlist_", ",", "preindexsymbolrules_", 
    ",", " ", "postindexsymbolrules_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"numindices", "=", 
       RowBox[{"Length", "/@", 
        RowBox[{"SlotsOfTensor", "/@", "headlist"}]}]}], ",", 
      "partitionedslots", ",", "internalexpr", ",", " ", "indicesoftensor", 
      ",", " ", 
      RowBox[{"texstring", "=", "\"\<\>\""}], ",", "  ", 
      RowBox[{"texstringtensor", "=", "\"\<\>\""}], ",", " ", 
      RowBox[{"i", "=", "1"}], ",", " ", "CovarDs", ",", " ", 
      RowBox[{"newheadlist", "=", "headlist"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CovarDs", "=", 
      RowBox[{"First", "/@", 
       RowBox[{"Position", "[", 
        RowBox[{"newheadlist", ",", "xAct`SymManipulator`CovarD", ",", "2"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "CovarDs"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"numindices", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"numindices", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "\[Rule]", 
               RowBox[{"Sequence", "[", 
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{"newheadlist", "[", 
                   RowBox[{"[", 
                    RowBox[{"#", ",", "3"}], "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"numindices", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "-", 
                  RowBox[{"Length", "@", 
                   RowBox[{"newheadlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "3"}], "]"}], "]"}]}]}]}], "]"}]}], 
              ")"}], "&"}], "/@", "CovarDs"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newheadlist", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"newheadlist", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "\[Rule]", 
               RowBox[{"Sequence", "[", 
                RowBox[{
                 RowBox[{"Last", "@", 
                  RowBox[{"SymbolOfCovD", "@", 
                   RowBox[{"newheadlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "1"}], "]"}], "]"}]}]}], ",", 
                 RowBox[{"newheadlist", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", ",", "2"}], "]"}], "]"}]}], "]"}]}], ")"}], 
             "&"}], "/@", "CovarDs"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"CovarDs", "=", 
         RowBox[{"First", "/@", 
          RowBox[{"Position", "[", 
           RowBox[{
           "newheadlist", ",", "xAct`SymManipulator`CovarD", ",", "2"}], 
           "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Extract", " ", "indices", " ", "belonging", " ", "to", " ", "the", " ",
        "different", " ", 
       RowBox[{"tensors", ".", " ", "Can"}], " ", "this", " ", "be", " ", 
       "done", " ", "in", " ", "a", " ", "simpler", " ", 
       RowBox[{"way", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"partitionedslots", "=", 
      RowBox[{"Last", "/@", 
       RowBox[{"Rest", "@", 
        RowBox[{"FoldList", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Drop", "[", 
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "#2"}], "]"}], ",", 
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "#2"}], "]"}]}], "}"}], 
           "&"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", "n", "]"}], ",", 
            RowBox[{"{", "}"}]}], "}"}], ",", "numindices"}], "]"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"indicesoftensor", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"indlist", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "partitionedslots"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "@", "newheadlist"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"texstringtensor", "=", " ", 
         RowBox[{"TexTensorWithSym", "[", 
          RowBox[{
           RowBox[{"newheadlist", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"indicesoftensor", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"partitionedslots", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", ",", "preindexsymbolrules", 
           ",", " ", "postindexsymbolrules"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"texstring", "=", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"texstring", ",", "texstringtensor"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"i", "=", 
         RowBox[{"i", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "texstring"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.545106618542286*^9, 3.5451066187138863`*^9}, {
   3.5451073326813407`*^9, 3.545107380043024*^9}, 3.5451074265467052`*^9, {
   3.545107520833271*^9, 3.545107613076233*^9}, {3.5451083647479534`*^9, 
   3.5451083699739623`*^9}, {3.5451092649017344`*^9, 3.545109299315395*^9}, 
   3.5451095049705563`*^9, {3.5451104526732206`*^9, 3.545110467352846*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexTensorWithSym", "[", 
   RowBox[{
   "head_", ",", "inds_", ",", "slots_", ",", "preindexsymbolrules_", ",", 
    " ", "postindexsymbolrules_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"texstring", "=", 
       RowBox[{"Tex", "@", "head"}]}], ",", " ", 
      RowBox[{"i", "=", "1"}], ",", " ", "fromdown", ",", 
      RowBox[{"postindexsymbol", "=", "\"\<\>\""}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "inds", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"texstring", "=", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"texstring", ",", 
           RowBox[{"TexSymIndex", "[", 
            RowBox[{
             RowBox[{"inds", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"i", "\[Equal]", "1"}], ",", "fromdown", ",", 
             RowBox[{
              RowBox[{"slots", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "/.", 
              "preindexsymbolrules"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"fromdown", "=", 
         RowBox[{"DownIndexQ", "[", 
          RowBox[{"inds", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"postindexsymbol", "=", 
         RowBox[{
          RowBox[{"slots", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "/.", "postindexsymbolrules"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"texstring", "=", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"texstring", ",", "postindexsymbol"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"i", "=", 
         RowBox[{"i", "+", "1"}]}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "inds"}], ">", "0"}], ",", " ", 
       RowBox[{"texstring", "=", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"texstring", ",", "\"\<}\>\""}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "texstring"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5451095741566772`*^9, 3.545109627508771*^9}, {
   3.545109710438517*^9, 3.545109724150941*^9}, 3.545109841931148*^9, {
   3.5451098829602203`*^9, 3.5451098867822266`*^9}, {3.5451099471075325`*^9, 
   3.5451100710029507`*^9}, {3.545110470730053*^9, 3.545110482773274*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexSymIndex", "[", 
   RowBox[{
   "index_", ",", "firstindexQ_", ",", "fromdownQ_", ",", "preindexsymbol_"}],
    "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "indexstring", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"indexstring", "=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"firstindexQ", "&&", 
         RowBox[{"DownIndexQ", "[", "index", "]"}], "&&", 
         RowBox[{"Not", "[", "$TexPrintInitialBracesQ", "]"}]}], ",", 
        "\"\<_{\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"firstindexQ", "&&", 
         RowBox[{"DownIndexQ", "[", "index", "]"}], "&&", 
         "$TexPrintInitialBracesQ"}], ",", "\"\<{}_{\>\"", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"firstindexQ", "&&", 
         RowBox[{"Not", "[", "$TexPrintInitialBracesQ", "]"}]}], ",", 
        "\"\<^{\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"firstindexQ", "&&", "$TexPrintInitialBracesQ"}], ",", 
        "\"\<{}^{\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"fromdownQ", "&&", 
         RowBox[{"DownIndexQ", "[", "index", "]"}]}], ",", "\"\<\>\"", ",", 
        "\[IndentingNewLine]", "fromdownQ", ",", "\"\<}{}^{\>\"", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"DownIndexQ", "[", "index", "]"}], ",", "\"\<}{}_{\>\"", ",", 
        "\[IndentingNewLine]", "True", ",", "\"\<\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"indexstring", ",", "preindexsymbol", ",", 
       RowBox[{"TexUpIndex", "[", 
        RowBox[{"UpIndex", " ", "@", "index"}], "]"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5115823822282057`*^9, 3.5115823970638056`*^9}, {
   3.5115827587342052`*^9, 3.5115828530362053`*^9}, 3.5115829200694056`*^9, {
   3.5115829515502057`*^9, 3.5115830791894054`*^9}, {3.5115832595456057`*^9, 
   3.511583299356806*^9}, {3.5115833884796057`*^9, 3.5115834525488057`*^9}, {
   3.5115834884132056`*^9, 3.5115837453452053`*^9}, {3.511583789196806*^9, 
   3.5115838052492056`*^9}, {3.5115838378064055`*^9, 
   3.5115839419988055`*^9}, {3.5115839952104053`*^9, 
   3.5115840202172055`*^9}, {3.5115842219876056`*^9, 
   3.5115842652308054`*^9}, {3.5115872711526055`*^9, 
   3.5115872738826056`*^9}, {3.5115883817946053`*^9, 3.511588404040206*^9}, {
   3.511594716331606*^9, 3.5115947536000056`*^9}, {3.5121019416140003`*^9, 
   3.5121020010968*^9}, {3.544949169693339*^9, 3.544949175168948*^9}, 
   3.5449504778034363`*^9, {3.544951562774544*^9, 3.544951565145748*^9}, {
   3.5450153199643316`*^9, 3.5450153479195805`*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["5. xTerior", "Section",
 CellChangeTimes->{{3.5450150224250093`*^9, 3.5450150283062196`*^9}, 
   3.61908490820138*^9, {3.61908519325185*^9, 3.6190851968218555`*^9}},
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell["5.1. Tex for the structures in xTerior", "Subsection",
 CellChangeTimes->{
  3.61908519985186*^9, {3.6190852364659595`*^9, 3.6190852458159723`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Wedge", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TexOperator", "[", "Wedge", "]"}], ":=", 
     "\"\< \\\\wedge \>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "expr_Wedge", "]"}], ":=", 
     RowBox[{"StringJoin", "@@", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"TexFactor", "/@", 
         RowBox[{"List", "@@", "expr"}]}], ",", 
        RowBox[{"TexOperator", "[", "Wedge", "]"}]}], "]"}]}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.616504204669483*^9, 3.6165042419795356`*^9}, {
  3.616505060588778*^9, 3.6165050651887846`*^9}, {3.6190853996861877`*^9, 
  3.6190854302862306`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Exterior", " ", "derivative"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TexOperator", "[", "xAct`xTerior`Diff", "]"}], ":=", 
     "\"\< d \>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"HoldPattern", "[", 
       RowBox[{"xAct`xTerior`Diff", "[", 
        RowBox[{
         RowBox[{"expr_Wedge", "|", "expr_Plus", "|", "expr_Times"}], ",", 
         "covd___"}], "]"}], "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexOperator", "[", "xAct`xTerior`Diff", "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covd", "===", "PD"}], ",", "\"\<\>\"", ",", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"\"\<^{\>\"", ",", 
           RowBox[{"Tex", "[", 
            RowBox[{
             RowBox[{"SymbolOfCovD", "[", "covd", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "\"\<}\>\""}], 
          "]"}]}], "]"}], ",", 
       RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
       RowBox[{"Tex", "[", "expr", "]"}], ",", 
       RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"HoldPattern", "[", 
       RowBox[{"xAct`xTerior`Diff", "[", 
        RowBox[{"expr_", ",", "covd___"}], "]"}], "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexOperator", "[", "xAct`xTerior`Diff", "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covd", "===", "PD"}], ",", "\"\<\>\"", ",", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"\"\<^{\>\"", ",", 
           RowBox[{"Tex", "[", 
            RowBox[{
             RowBox[{"SymbolOfCovD", "[", "covd", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "\"\<}\>\""}], 
          "]"}]}], "]"}], ",", 
       RowBox[{"Tex", "[", "expr", "]"}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6190865004039216`*^9, 3.619086525503957*^9}, 
   3.6190868000693893`*^9, {3.619086841799448*^9, 3.6190868834795065`*^9}, {
   3.6190869945696616`*^9, 3.6190870213296995`*^9}, 3.6190873167741613`*^9, {
   3.6190885228670425`*^9, 3.6190885240070443`*^9}, {3.619626126464985*^9, 
   3.6196261865891175`*^9}, {3.619626781260213*^9, 3.6196268378602924`*^9}, {
   3.619626905370387*^9, 3.6196269112303953`*^9}, {3.6196269727404814`*^9, 
   3.6196270093405323`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Coframe", " ", "and", " ", "dx"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"xAct`xTerior`Coframe", "[", "man_", "]"}], "]"}], ":=", 
     "\"\<\\\\theta\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"xAct`xTerior`dx", "[", "man_", "]"}], "]"}], ":=", 
     "\"\<dx\>\""}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6190873200641656`*^9, 3.6190873454782495`*^9}, {
  3.619087459418409*^9, 3.6190875205584946`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"xAct`xTerior`Hodge", "[", "met_", "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<{*}_{\>\"", ",", 
     RowBox[{"Tex", "[", "met", "]"}], ",", "\"\<}\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{
     RowBox[{"xAct`xTerior`Hodge", "[", "met_", "]"}], "[", 
     RowBox[{"expr_Wedge", "|", "expr_Plus", "|", "expr_Times"}], "]"}], 
    "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"xAct`xTerior`Hodge", "[", "met", "]"}], "]"}], ",", 
     RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
     RowBox[{"Tex", "[", "expr", "]"}], ",", 
     RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{
     RowBox[{"xAct`xTerior`Hodge", "[", "met_", "]"}], "[", "expr_", "]"}], 
    "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"xAct`xTerior`Hodge", "[", "met", "]"}], "]"}], ",", 
     RowBox[{"Tex", "[", "expr", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"xAct`xTerior`Codiff", "[", "met_", "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\\\delta_{\>\"", ",", 
     RowBox[{"Tex", "[", "met", "]"}], ",", "\"\<}\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{
     RowBox[{"xAct`xTerior`Codiff", "[", "met_", "]"}], "[", 
     RowBox[{"expr_Wedge", "|", "expr_Plus", "|", "expr_Times"}], "]"}], 
    "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"xAct`xTerior`Codiff", "[", "met", "]"}], "]"}], ",", 
     RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
     RowBox[{"Tex", "[", "expr", "]"}], ",", 
     RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{
     RowBox[{"xAct`xTerior`Codiff", "[", "met_", "]"}], "[", "expr_", "]"}], 
    "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"xAct`xTerior`Codiff", "[", "met", "]"}], "]"}], ",", 
     RowBox[{"Tex", "[", "expr", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{
     RowBox[{"xAct`xTerior`CartanD", "[", 
      RowBox[{
       RowBox[{"v_", "?", "xTensorQ"}], "[", "a_", "]"}], "]"}], "[", 
     RowBox[{
      RowBox[{"expr_Wedge", "|", "expr_Plus", "|", "expr_Times"}], ",", 
      "covd_"}], "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\\\mathcal{L}\>\"", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Or", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"{", "covd", "}"}]}], "\[Equal]", "0"}], ",", 
         RowBox[{"covd", "===", "xAct`xTensor`PD"}]}], "]"}], ",", "\"\<\>\"",
        ",", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<^{\>\"", ",", 
         RowBox[{"Tex", "@", 
          RowBox[{"Last", "@", 
           RowBox[{"SymbolOfCovD", "[", "covd", "]"}]}]}], ",", 
         "\"\<}{}\>\""}], "]"}]}], "]"}], ",", "\"\<_{\>\"", ",", 
     RowBox[{"Tex", "[", "v", "]"}], ",", "\"\<}\>\"", ",", 
     RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
     RowBox[{"Tex", "[", "expr", "]"}], ",", 
     RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{
     RowBox[{"xAct`xTerior`CartanD", "[", 
      RowBox[{
       RowBox[{"v_", "?", "xTensorQ"}], "[", "a_", "]"}], "]"}], "[", 
     RowBox[{"expr_", ",", "covd___"}], "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\\\mathcal{L}\>\"", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Or", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"{", "covd", "}"}]}], "\[Equal]", "0"}], ",", 
         RowBox[{"covd", "===", "xAct`xTensor`PD"}]}], "]"}], ",", "\"\<\>\"",
        ",", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<^{\>\"", ",", 
         RowBox[{"Tex", "@", 
          RowBox[{"Last", "@", 
           RowBox[{"SymbolOfCovD", "[", "covd", "]"}]}]}], ",", 
         "\"\<}{}\>\""}], "]"}]}], "]"}], ",", "\"\<_{\>\"", ",", 
     RowBox[{"Tex", "[", "v", "]"}], ",", "\"\<}\>\"", ",", 
     RowBox[{"Tex", "[", "expr", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{
      RowBox[{"xAct`xTerior`Int", "[", 
       RowBox[{
        RowBox[{"v_", "?", "xTensorQ"}], "[", "a_", "]"}], "]"}], "[", 
      "expr_", "]"}], "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\\\iota_{\>\"", ",", 
     RowBox[{"Tex", "[", "v", "]"}], ",", "\"\<}\>\"", ",", 
     RowBox[{"Tex", "[", "expr", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"form", ":", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
        "xAct`xTerior`ChristoffelForm", "|", "xAct`xTerior`ConnectionForm", 
         "|", "xAct`xTerior`RiemannForm", "|", "xAct`xTerior`CurvatureForm", 
         "|", "xAct`xTerior`TorsionForm"}], ")"}], "[", 
       RowBox[{"covd_", ",", "vb___"}], "]"}]}], "]"}], "]"}], ":=", 
   RowBox[{"Tex", "@", 
    RowBox[{"PrintAs", "@", "form"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6190879102330885`*^9, 3.6190879910582495`*^9}, {
   3.6190880436983232`*^9, 3.61908810550841*^9}, {3.6190882080785537`*^9, 
   3.619088221208572*^9}, {3.619088387636853*^9, 3.6190884484869385`*^9}, {
   3.6190885348811073`*^9, 3.6190885491311274`*^9}, {3.61962582570852*^9, 
   3.619625860694613*^9}, {3.619625906234677*^9, 3.619626075764914*^9}, {
   3.619626452575705*^9, 3.619626454055707*^9}, {3.619627358469118*^9, 
   3.619627400499177*^9}, {3.619627446249241*^9, 3.6196274844692945`*^9}, 
   3.6196275264693527`*^9, {3.6196275582593975`*^9, 3.61962760280046*^9}, {
   3.619627707374655*^9, 3.6196278023157873`*^9}, {3.619627999620112*^9, 
   3.619628009610126*^9}, {3.6196282626845284`*^9, 3.6196283282946205`*^9}, 
   3.619629504994461*^9, {3.619629735354783*^9, 3.619629743714795*^9}, {
   3.6196297824688973`*^9, 3.619629789628907*^9}, {3.6196298445489845`*^9, 
   3.6196299116990786`*^9}, {3.619630059453333*^9, 3.6196300705833488`*^9}, {
   3.620540927590987*^9, 3.620540944251011*^9}, {3.620541180365389*^9, 
   3.620541205365424*^9}, {3.620541255826495*^9, 3.62054136081069*^9}, {
   3.620541613791044*^9, 3.6205416651951647`*^9}, {3.620541915875516*^9, 
   3.620541937519594*^9}, {3.620541974739646*^9, 3.620542069879779*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["6. TexBreak", "Section",
 CellChangeTimes->{3.545015046527052*^9, 3.6190852024718637`*^9},
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell["6.1. TexBreak function", "Subsection",
 CellChangeTimes->{3.619085204661866*^9}],

Cell["Jose\[CloseCurlyQuote]s old code for TexBreak:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexBreak", "[", 
    RowBox[{"string_String", ",", "n_Integer"}], "]"}], ":=", 
   RowBox[{"StringInsert", "[", 
    RowBox[{"string", ",", "\"\< \\\\nonumber \\\\\\\\ \\n\>\"", ",", 
     RowBox[{"Last", "/@", 
      RowBox[{"Split", "[", 
       RowBox[{
        RowBox[{"First", "/@", 
         RowBox[{"StringPosition", "[", 
          RowBox[{"string", ",", 
           RowBox[{"\"\< + \>\"", "|", "\"\< - \>\""}]}], "]"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"IntegerPart", "[", 
           RowBox[{"#1", "/", "n"}], "]"}], "===", 
          RowBox[{"IntegerPart", "[", 
           RowBox[{"#2", "/", "n"}], "]"}]}], "&"}]}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 Evaluatable->False,
 CellChangeTimes->{{3.588328778432424*^9, 3.5883287990868607`*^9}}],

Cell["\<\
Barry\[CloseCurlyQuote]s new code with the TexBreakBy option \
\[OpenCurlyDoubleQuote]TexPoint\[CloseCurlyDoubleQuote] added by Thomas:\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "TexBreak", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"TexBreakBy", "\[Rule]", "\"\<Character\>\""}], ",", 
     RowBox[{"TexBreakAt", "\[Rule]", 
      RowBox[{"\"\< + \>\"", "|", "\"\< - \>\""}]}], ",", 
     RowBox[{
     "TexBreakString", "\[Rule]", "\"\< \\\\nonumber \\\\\\\\ \\n&&\>\""}], 
     ",", 
     RowBox[{"EquationMarks", "\[Rule]", "False"}]}], "}"}]}], ";"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.588078862582654*^9, 3.5880789023627243`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BreakingFunction", "[", 
   RowBox[{"rulelist_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"best", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"rulelist", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "n"}], "&"}]}], 
       "]"}]}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "@", "best"}], "\[Equal]", "0"}], ",", 
      RowBox[{"Last", "@", 
       RowBox[{"First", "[", "rulelist", "]"}]}], ",", 
      RowBox[{"Last", "@", 
       RowBox[{"Last", "@", "best"}]}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588080124533271*^9, 3.5880801251104717`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TexBreak", "[", 
     RowBox[{"string_String", ",", "n_", ",", "l_List", ",", "options___"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "splittablePositions", ",", "breakat", ",", "breakby", ",", 
        "breakstring", ",", "splitat", ",", "positions", ",", "perLine", ",", 
        "splitted", ",", "texedwidth", ",", "splitstructure", ",", "mark", 
        ",", "pagewidth"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"breakat", ",", "breakby", ",", "breakstring", ",", "mark"}],
          "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "TexBreakAt", ",", "TexBreakBy", ",", "TexBreakString", ",", " ", 
            "EquationMarks"}], "}"}], "/.", 
          RowBox[{"CheckOptions", "[", "options", "]"}]}], "/.", 
         RowBox[{"Options", "[", "TexBreak", "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Positions", " ", "where", " ", "the", " ", "string", " ", "can", " ",
          "be", " ", 
         RowBox[{"split", ":", " ", 
          RowBox[{"wherever", " ", "+", " ", "or", " ", "-", " ", 
           RowBox[{"is", " ", "encountered"}]}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Older", " ", 
           RowBox[{"code", ":", " ", "splittablePositions"}]}], "=", 
          RowBox[{"First", "/@", 
           RowBox[{"StringPosition", "[", 
            RowBox[{"string", ",", "breakat"}], "]"}]}]}], ";"}], " ", "*)"}],
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Count", " ", "the", " ", "bracket", " ", "level", " ", "and", " ", 
         "split", " ", "only", " ", "when", " ", "breakat", " ", "appears", 
         " ", "at", " ", "bracket", " ", "level", " ", "0."}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "At", " ", "which", " ", "position", " ", "do", " ", "we", " ", 
         "find", " ", "breakat", " ", "or", " ", 
         RowBox[{"brackets", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"splittablePositions", "=", 
        RowBox[{"First", "/@", 
         RowBox[{"StringPosition", "[", 
          RowBox[{"string", ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{"breakat", ",", "\"\<{\>\""}], "]"}], ",", 
             "\"\<}\>\""}], "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "Construct", " ", "a", " ", "structure", " ", "of", " ", "the", " ", 
          "kind", " ", 
          RowBox[{"{", 
           RowBox[{"pos", ",", " ", "n", ",", " ", "notbracketQ"}], "}"}]}], 
         ",", " ", 
         RowBox[{
         "where", " ", "pos", " ", "is", " ", "the", " ", "position", " ", 
          "of", " ", "the", " ", "character"}], ",", " ", 
         RowBox[{
         "n", " ", "is", " ", "1", " ", "for", " ", "opening", " ", 
          "brackets"}], ",", " ", 
         RowBox[{
          RowBox[{"-", "1"}], " ", "for", " ", "closing", " ", "brackets", 
          " ", "and", " ", "0", " ", "for", " ", "everything", " ", 
          RowBox[{"else", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"splitstructure", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Switch", "[", 
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{"string", ",", 
              RowBox[{"{", "#", "}"}]}], "]"}], ",", "\"\<{\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"#", ",", "1", ",", "False"}], "}"}], ",", "\"\<}\>\"", 
            ",", 
            RowBox[{"{", 
             RowBox[{"#", ",", 
              RowBox[{"-", "1"}], ",", "False"}], "}"}], ",", "_", ",", 
            RowBox[{"{", 
             RowBox[{"#", ",", "0", ",", "True"}], "}"}]}], "]"}], "&"}], "/@",
          "splittablePositions"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "Compute", " ", "the", " ", "bracket", " ", "level", " ", "by", " ", 
          "accumulating", " ", "the", " ", 
          RowBox[{"n", "'"}], 
          RowBox[{"s", ".", " ", "Return"}], " ", "a", " ", "structure", " ", 
          
          RowBox[{"{", 
           RowBox[{"pos", ",", " ", "possiblebreakQ"}], "}"}]}], ",", " ", 
         RowBox[{
         "and", " ", "extract", " ", "the", " ", "possible", " ", "breaking", 
          " ", 
          RowBox[{"positions", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"splitstructure", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{"#2", "\[Equal]", "0"}], ",", 
               RowBox[{"#1", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}], "&"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"splitstructure", ",", 
            RowBox[{"Accumulate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
              "splitstructure"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"splittablePositions", "=", 
        RowBox[{"First", "/@", 
         RowBox[{"Select", "[", 
          RowBox[{"splitstructure", ",", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"The", " ", 
         RowBox[{"terms", "/", "characters"}], " ", "per", " ", "line", " ", 
         "that", " ", "the", " ", "user", " ", "specified"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"l", "\[NotEqual]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"perLine", "=", 
          RowBox[{"SparseArray", "[", 
           RowBox[{"l", ",", "Automatic", ",", "n"}], "]"}]}], ",", 
         RowBox[{"perLine", "=", 
          RowBox[{"{", "n", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Positions", " ", "at", " ", "which", " ", "the", " ", "string", " ", 
         "will", " ", "be", " ", "split"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "breakby", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\"\<Character\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"positions", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"iter", ",", 
              RowBox[{"currentPosition", "=", "0"}], ",", "nearestPosition", 
              ",", 
              RowBox[{"strlen", "=", 
               RowBox[{"StringLength", "[", "string", "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Split", " ", "parts", " ", "where", " ", "lengths", " ", "are", 
              " ", "given", " ", "explicitly"}], " ", "*)"}], 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"iter", "=", "1"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"iter", "\[LessEqual]", 
                  RowBox[{"Length", "[", "perLine", "]"}]}], ")"}], "&&", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"currentPosition", "+", 
                   RowBox[{"perLine", "[", 
                    RowBox[{"[", "iter", "]"}], "]"}]}], "<", "strlen"}], 
                 ")"}]}], ",", 
               RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"nearestPosition", "=", 
                 RowBox[{"Nearest", "[", 
                  RowBox[{
                   RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"splittablePositions", "-", "currentPosition"}], 
                    ",", "Positive"}], "]"}], ",", 
                   RowBox[{"perLine", "[", 
                    RowBox[{"[", "iter", "]"}], "]"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"nearestPosition", "\[NotEqual]", 
                   RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"currentPosition", "+=", 
                    RowBox[{"First", "@", "nearestPosition"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"positions", ",", "currentPosition"}], "]"}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"currentPosition", "=", "strlen"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{" ", 
               RowBox[{
               "Split", " ", "remainder", " ", "into", " ", "strings", " ", 
                "of", " ", 
                RowBox[{"length", "~", "n"}]}], ")"}], " ", "*)"}], 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"currentPosition", "+", "n"}], "<", "strlen"}], 
                ")"}], ",", 
               RowBox[{
                RowBox[{"nearestPosition", "=", 
                 RowBox[{"Nearest", "[", 
                  RowBox[{
                   RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"splittablePositions", "-", "currentPosition"}], 
                    ",", "Positive"}], "]"}], ",", "n"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"nearestPosition", "\[NotEqual]", 
                   RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"currentPosition", "+=", 
                    RowBox[{"First", "@", "nearestPosition"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"positions", ",", "currentPosition"}], "]"}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"currentPosition", "=", "strlen"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<Term\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "The", " ", "terms", " ", "at", " ", "which", " ", "we", " ", 
           "want", " ", "to", " ", "split"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"splitat", "=", 
           RowBox[{"Accumulate", "[", "perLine", "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Pad", " ", "out", " ", "every", " ", "n", " ", "terms"}], 
           " ", "*)"}], 
          RowBox[{"splitat", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"splitat", ",", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "[", "splitat", "]"}], "+", "n"}], ",", 
                RowBox[{"Length", "[", "splittablePositions", "]"}], ",", 
                "n"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Remove", " ", "split", " ", "points", " ", "which", " ", "are", 
            " ", "past", " ", "the", " ", "end", " ", "of", " ", "the", " ", 
            "string"}], " ", "*)"}], 
          RowBox[{"splitat", "=", 
           RowBox[{"Select", "[", 
            RowBox[{"splitat", ",", 
             RowBox[{
              RowBox[{"#", "\[LessEqual]", 
               RowBox[{"Length", "[", "splittablePositions", "]"}]}], "&"}]}],
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "The", " ", "positions", " ", "in", " ", "the", " ", "string", " ",
             "to", " ", "split", " ", "at"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"positions", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"splittablePositions", ",", "#"}], "]"}], "&"}], ",", 
             "splitat"}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\"\<TexPoint\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"positions", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"splitted", "=", 
           RowBox[{"StringTake", "[", 
            RowBox[{"string", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Prepend", "[", 
                 RowBox[{"splittablePositions", ",", "1"}], "]"}], ",", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"splittablePositions", "-", "1"}], ",", 
                  RowBox[{"StringLength", "@", "string"}]}], "]"}]}], "}"}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"texedwidth", "=", 
           RowBox[{"TexWidths", "@@", "splitted"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pagewidth", "=", 
           RowBox[{"First", "@", "texedwidth"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"texedwidth", "=", 
           RowBox[{"Rest", "@", "texedwidth"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", "nearestTerm", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Split", " ", "parts", " ", "where", " ", "lengths", " ", "are", 
              " ", "given", " ", "explicitly"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{"And", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", "perLine"}], ">", "0"}], ",", 
                 RowBox[{
                  RowBox[{"Length", "@", "splittablePositions"}], ">", 
                  "0"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"nearestTerm", "=", 
                 RowBox[{"BreakingFunction", "[", 
                  RowBox[{
                   RowBox[{"Thread", "@", 
                    RowBox[{"Rule", "[", 
                    RowBox[{
                    RowBox[{"Accumulate", "@", "texedwidth"}], ",", " ", 
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "@", "texedwidth"}]}]}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"perLine", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/.", 
                    RowBox[{"latextextwidth", "->", "pagewidth"}]}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"perLine", "=", 
                 RowBox[{"Rest", "@", 
                  RowBox[{"Normal", "@", "perLine"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"nearestTerm", "\[LessEqual]", 
                   RowBox[{"Length", "@", "splittablePositions"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"positions", ",", 
                    RowBox[{"splittablePositions", "[", 
                    RowBox[{"[", "nearestTerm", "]"}], "]"}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"splittablePositions", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"splittablePositions", ",", "nearestTerm"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"texedwidth", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"texedwidth", ",", "nearestTerm"}], "]"}]}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"splittablePositions", "=", 
                    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"texedwidth", "=", 
                    RowBox[{"{", "}"}]}], ";"}]}], "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{" ", 
               RowBox[{
               "Split", " ", "remainder", " ", "into", " ", "strings", " ", 
                "of", " ", 
                RowBox[{"length", "~", "n"}]}], ")"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "@", "splittablePositions"}], ">", "0"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"nearestTerm", "=", 
                 RowBox[{"BreakingFunction", "[", 
                  RowBox[{
                   RowBox[{"Thread", "@", 
                    RowBox[{"Rule", "[", 
                    RowBox[{
                    RowBox[{"Accumulate", "@", "texedwidth"}], ",", " ", 
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "@", "texedwidth"}]}]}], "]"}]}], ",", 
                   RowBox[{"n", "/.", 
                    RowBox[{"latextextwidth", "->", "pagewidth"}]}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"nearestTerm", "\[LessEqual]", 
                   RowBox[{"Length", "@", "splittablePositions"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"positions", ",", 
                    RowBox[{"splittablePositions", "[", 
                    RowBox[{"[", "nearestTerm", "]"}], "]"}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"splittablePositions", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"splittablePositions", ",", "nearestTerm"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"texedwidth", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"texedwidth", ",", "nearestTerm"}], "]"}]}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"splittablePositions", "=", 
                    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"texedwidth", "=", 
                    RowBox[{"{", "}"}]}], ";"}]}], "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "_", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
         "Throw", "[", "\"\<Invalid value for option TexBreakBy.\>\"", 
          "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Split", " ", "string"}], " ", "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"AddEquationMarks", "[", 
        RowBox[{
         RowBox[{"StringInsert", "[", 
          RowBox[{"string", ",", "breakstring", ",", "positions"}], "]"}], 
         ",", "mark"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Shortcuts", " ", "and", " ", "defaults"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TexBreak", "[", 
    RowBox[{"string_String", ",", "n_", ",", "options___"}], "]"}], ":=", 
   RowBox[{"TexBreak", "[", 
    RowBox[{"string", ",", "n", ",", 
     RowBox[{"{", "}"}], ",", "options"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexBreak", "[", 
    RowBox[{"string_String", ",", "options___"}], "]"}], ":=", 
   RowBox[{"TexBreak", "[", 
    RowBox[{"string", ",", "200", ",", 
     RowBox[{"{", "}"}], ",", "options"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5831323117520175`*^9, 3.583132742843175*^9}, {
   3.583132791920861*^9, 3.5831329161906796`*^9}, {3.5831329500739384`*^9, 
   3.583132981741994*^9}, {3.583133165261717*^9, 3.5831331697857246`*^9}, {
   3.5880795204826097`*^9, 3.5880795672358913`*^9}, 3.588079916538105*^9, 
   3.588080053147545*^9, {3.588328195833801*^9, 3.5883282750819397`*^9}, {
   3.588328812284484*^9, 3.5883288702395854`*^9}, {3.588329263578676*^9, 
   3.588329306260351*^9}, {3.58832949913909*^9, 3.588329507438305*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["6.2. TexWidths", "Subsection",
 CellChangeTimes->{{3.5822792082243814`*^9, 3.5822792262580137`*^9}, 
   3.61908520690187*^9}],

Cell["\<\
Thomas\[CloseCurlyQuote] code for determining the widths of a sequence of tex \
expressions measured in printer points. 
A file TexActWidthTest.tex is written and passed to the inline latex command. \
The widths are then extracted from the output.The first output is the latex \
textwidth environment variable.\
\>", "Text",
 CellChangeTimes->{{3.5822792405320387`*^9, 3.5822794098547363`*^9}, {
  3.582279477122054*^9, 3.582279533204152*^9}, {3.582281862071843*^9, 
  3.5822818631014447`*^9}, {3.5883302044787283`*^9, 3.5883302417783937`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Protect", "[", "latextextwidth", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588329526017937*^9, 3.58832953339675*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$TexDirectory", "=", "$TemporaryDirectory"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$TexTmpDirectory", "=", "$TemporaryDirectory"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$LatexExecutable", "=", "\"\<pdflatex\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5880819971481667`*^9, 3.5880820029981775`*^9}, {
  3.5883139972465963`*^9, 3.5883140035490074`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "$TexInitLatexClassCode", "=", 
   "\"\<\\\\documentclass[10pt,a4paper]{article}\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.58796424998662*^9, 3.5879642770994673`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexInitLatexPackages", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<{amssymb}\>\"", ",", " ", "\"\<{amsmath}\>\"", ",", " ", 
     "\"\<{amsthm}\>\"", ",", " ", "\"\<{latexsym}\>\""}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5879639239928474`*^9, 3.587964043301857*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexInitLatexExtraCode", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.587964316895138*^9, 3.5879643241179504`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexInitLatexCode", "[", "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{"$TexInitLatexClassCode", ",", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<\\\\usepackage\>\"", ",", "#", ",", "\"\<\\n\>\""}], 
        "]"}], "&"}], "/@", "$TexInitLatexPackages"}], "]"}], ",", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"#", ",", "\"\<\\n\>\""}], "]"}], "&"}], "/@", 
      "$TexInitLatexExtraCode"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5879640603838873`*^9, 3.5879640620218897`*^9}, {
  3.587964133782016*^9, 3.5879641970401273`*^9}, {3.5879642832926784`*^9, 
  3.5879642946962986`*^9}, {3.5879643380487747`*^9, 3.5879643663784246`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexWidthsWriteFile", "[", "strs___", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tmpfile", "=", 
       RowBox[{"OpenWrite", "[", "\"\<TexActWidthTest.tex\>\"", "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"WriteString", "[", 
       RowBox[{"tmpfile", ",", 
        RowBox[{"TexInitLatexCode", "[", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{
       "tmpfile", ",", 
        "\"\<\\\\newlength{\\\\widthofexpr}\n\
\\\\newcommand{\\\\testwidth}[1]{\\\\settowidth{\\\\widthofexpr}{\\\\hbox{$\\\
\\displaystyle{}#1$}}}\n\
\\\\newcommand{\\\\writewidth}[1]{\\\\settowidth{\\\\widthofexpr}{\\\\hbox{$\\\
\\displaystyle{}#1$}}\n\\\\immediate\\\\write0{\\\\the\\\\widthofexpr}}\n\
\\\\begin{document}\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"WriteString", "[", 
         RowBox[{"tmpfile", ",", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<\\\\testwidth{\>\"", ",", "#", ",", "\"\<}\\n\>\""}], 
           "]"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "strs", "}"}]}], ";", 
      RowBox[{"WriteString", "[", 
       RowBox[{
       "tmpfile", ",", "\"\<\\\\immediate\\\\write0{xActWidthStart}\\n\>\""}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{
       "tmpfile", ",", 
        "\"\<\\\\immediate\\\\write0{\\\\the\\\\textwidth}\\n\>\""}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"WriteString", "[", 
         RowBox[{"tmpfile", ",", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<\\\\writewidth{\>\"", ",", "#", ",", "\"\<}\\n\>\""}],
            "]"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "strs", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{
       "tmpfile", ",", 
        "\"\<\\\\immediate\\\\write0{xActWidthEnd}\n\\\\end{document}\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "tmpfile", "]"}], ";"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5667368665048637`*^9, 3.566737158694377*^9}, {
   3.5667375329026356`*^9, 3.5667375603430834`*^9}, {3.5667384453678555`*^9, 
   3.5667384669738936`*^9}, {3.56673869190849*^9, 3.566738694217294*^9}, {
   3.566738914280682*^9, 3.5667389242958994`*^9}, {3.566738957477158*^9, 
   3.566739032123289*^9}, {3.5668338784885716`*^9, 3.5668338942445993`*^9}, {
   3.5668379798323755`*^9, 3.566837984652784*^9}, {3.582277943697157*^9, 
   3.582277947628364*^9}, {3.582278714357714*^9, 3.5822787257925344`*^9}, 
   3.582278792919452*^9, {3.587964407921297*^9, 3.5879644092784996`*^9}, {
   3.588082594863217*^9, 3.5880825961736193`*^9}, {3.588328100892034*^9, 
   3.588328139143301*^9}, 3.5883285196747694`*^9, {3.61639822081534*^9, 
   3.6163982298228555`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtractTexWidths", "[", "str1_List", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"str2", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"str1", ",", 
        RowBox[{"First", "@", 
         RowBox[{"First", "@", 
          RowBox[{"Position", "[", 
           RowBox[{
           "str1", ",", "\"\<xActWidthStart\>\"", ",", "1", ",", "1"}], 
           "]"}]}]}]}], "]"}]}], "}"}], ",", 
    RowBox[{"ToExpression", "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{"#", ",", 
          RowBox[{"\"\<pt\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "&"}], "/@", 
       RowBox[{"Take", "[", 
        RowBox[{"str2", ",", 
         RowBox[{
          RowBox[{"First", "@", 
           RowBox[{"First", "@", 
            RowBox[{"Position", "[", 
             RowBox[{
             "str2", ",", "\"\<xActWidthEnd\>\"", ",", "1", ",", "1"}], 
             "]"}]}]}], "-", "1"}]}], "]"}]}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5667392386832523`*^9, 3.566739265406099*^9}, {
  3.5822788277387133`*^9, 3.582278828222314*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexWidths", "[", "strs___", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"TexOut", ",", "errorpos"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"SetDirectory", "[", "$TexTmpDirectory", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TexWidthsWriteFile", "[", "strs", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TexOut", "=", 
       RowBox[{"ReadList", "[", 
        RowBox[{
         RowBox[{
         "\"\<!\>\"", "<>", "$LatexExecutable", "<>", 
          "\"\< TexActWidthTest.tex\>\""}], ",", "String"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"errorpos", "=", 
       RowBox[{"DeleteFile", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<TexActWidthTest.tex\>\"", ",", "\"\<TexActWidthTest.log\>\"", 
          ",", "\"\<TexActWidthTest.aux\>\""}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"errorpos", "=!=", "Null"}], ",", 
        RowBox[{
        "Print", "[", "\"\<Tex Error: could not delete temporary files\>\"", 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ResetDirectory", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"Position", "[", 
           RowBox[{
           "TexOut", ",", "\"\<xActWidthEnd\>\"", ",", "1", ",", "1"}], 
           "]"}]}], "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ExtractTexWidths", "@", "TexOut"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"errorpos", "=", 
          RowBox[{"Position", "[", 
           RowBox[{"TexOut", ",", 
            RowBox[{"str_String", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"StringMatchQ", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                 "StartOfString", " ", "~~", " ", "\"\<!\>\"", "~~", 
                  "___"}]}], "]"}], "&"}], ")"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "errorpos"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Tex Error:\\n\>\"", ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"Drop", "[", 
               RowBox[{"TexOut", ",", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"First", "@", "errorpos"}]}], "-", "1"}]}], 
               "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Tex Error:\\n\>\"", ",", 
              RowBox[{"Sequence", "@@", "TexOut"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Throw", "[", "\"\<Tex Error\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5880820151349983`*^9, 3.5880820156497993`*^9}, {
  3.5880826026164303`*^9, 3.588082604082833*^9}, {3.588314020662237*^9, 
  3.58831404499828*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["6.2. TexPrintAlignedEquations", "Subsection",
 CellChangeTimes->{{3.5822792082243814`*^9, 3.5822792262580137`*^9}, 
   3.5823534292637043`*^9, 3.6190852087918725`*^9}],

Cell["\<\
Thomas\[CloseCurlyQuote] code for typesetting a list of equations in an \
aligned environment. Use $TexprintPageWidth to adjust the linebreaking.\
\>", "Text",
 CellChangeTimes->{{3.5822792405320387`*^9, 3.5822794098547363`*^9}, {
  3.582279477122054*^9, 3.582279533204152*^9}, {3.582281862071843*^9, 
  3.5822818631014447`*^9}, {3.582353436985718*^9, 3.582353490993013*^9}, {
  3.5823535218186665`*^9, 3.582353528604679*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexPrintPageWidth", "=", "latextextwidth"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.5823533085350924`*^9, 3.582353340218748*^9, 
  3.5883296440789447`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexPrintAlignedEquations", "[", "eq_Equal", "]"}], ":=", 
  RowBox[{"TexPrintAlignedEquations", "[", 
   RowBox[{"{", "eq", "}"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.582352460861911*^9, 3.582352487896758*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LHSpart", "[", 
   RowBox[{"a_", "\[Equal]", "b_"}], "]"}], ":=", "a"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588316016438143*^9, 3.588316054003009*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RHSpart", "[", 
   RowBox[{"a_", "\[Equal]", "b_"}], "]"}], ":=", "b"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5883160602898197`*^9, 3.588316062224223*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LHSpart", "[", "b_", "]"}], ":=", "\"\<\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588316088354269*^9, 3.5883160974490848`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RHSpart", "[", "b_", "]"}], ":=", "b"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5883161074331026`*^9, 3.5883161092427053`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexPrintAlignedEquations", "[", 
   RowBox[{"eqlist", ":", 
    RowBox[{"{", "eqs___", "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TexLHS", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"TexPrint", "[", 
          RowBox[{"LHSpart", "@", "#"}], "]"}], "&"}], "/@", "eqlist"}]}], 
      ",", 
      RowBox[{"TexRHS", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"TexPrint", "[", 
          RowBox[{"RHSpart", "@", "#"}], "]"}], "&"}], "/@", "eqlist"}]}], 
      ",", "LHSWidths", ",", "MaxRHSWidth", ",", "pagewidth"}], "}"}], ",", 
    RowBox[{
     RowBox[{"LHSWidths", "=", 
      RowBox[{"xAct`TexAct`Private`TexWidths", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{"#", ",", "\"\< ={}\>\""}], "]"}], "&"}], "/@", "TexLHS"}],
         ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pagewidth", "=", 
      RowBox[{"First", "@", "LHSWidths"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"LHSWidths", "=", 
      RowBox[{"Rest", "@", "LHSWidths"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"MaxRHSWidth", "=", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"$TexPrintPageWidth", "/.", 
          RowBox[{"latextextwidth", "\[Rule]", "pagewidth"}]}], ")"}], "-", 
        RowBox[{"Max", "@", "LHSWidths"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"TexRHS", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"TexBreak", "[", 
         RowBox[{"#", ",", "1", ",", 
          RowBox[{"TexBreakBy", "\[Rule]", "\"\<Term\>\""}], ",", 
          RowBox[{"TexBreakString", "\[Rule]", "\"\<\\n\>\""}]}], "]"}], 
        "&"}], "/@", "TexRHS"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TexRHS", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"TexBreak", "[", 
         RowBox[{"#", ",", "MaxRHSWidth", ",", 
          RowBox[{"TexBreakBy", "\[Rule]", "\"\<TexPoint\>\""}], ",", 
          RowBox[{
          "TexBreakString", "\[Rule]", "\"\<\\\\nonumber\\\\\\\\\\n&\>\""}]}],
          "]"}], "&"}], "/@", "TexRHS"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TexRHS", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{"#", ",", 
          RowBox[{
          "\"\<\\n\\\\nonumber\>\"", "\[Rule]", "\"\<\\\\nonumber\>\""}]}], 
         "]"}], "&"}], "/@", "TexRHS"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<\\\\begin{align}\\n\>\"", ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{"Riffle", "[", 
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{"#1", ",", "\"\<={}&\>\"", ",", "#2"}], "]"}], "&"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"TexLHS", ",", "TexRHS"}], "}"}]}], "]"}], ",", 
            "\"\<,\\\\\\\\\\n\>\""}], "]"}], "]"}], ",", 
         RowBox[{
         "\"\<,\\\\\\\\\\n=\>\"", "\[Rule]", " ", "\"\<\\\\\\\\\\n=\>\""}]}], 
        "]"}], ",", "\"\<.\\n\\\\end{align}\>\""}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.582350630150895*^9, 3.5823507144690437`*^9}, {
   3.5823507687727385`*^9, 3.582350874228924*^9}, {3.582350904492977*^9, 
   3.5823511035961266`*^9}, {3.5823511561536193`*^9, 3.582351343977949*^9}, {
   3.5823514728497753`*^9, 3.5823515379642897`*^9}, {3.582351571114348*^9, 
   3.58235158382837*^9}, 3.582351806643562*^9, {3.582351844926029*^9, 
   3.582351871711276*^9}, {3.582352037945168*^9, 3.5823521056024866`*^9}, {
   3.582352163135388*^9, 3.5823522668755703`*^9}, {3.582352317653659*^9, 
   3.582352410723423*^9}, {3.5883161246243324`*^9, 3.58831615733759*^9}, 
   3.588319134767502*^9, {3.5883257446774955`*^9, 3.5883257892467737`*^9}, {
   3.588328364626097*^9, 3.588328420739396*^9}, {3.588329357584441*^9, 
   3.5883293619992495`*^9}, {3.5883295612427993`*^9, 3.588329586967244*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexPrintAlignedExpressions", "[", "list_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Texed", "=", 
      RowBox[{"TexPrint", "/@", "list"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Texed", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"TexBreak", "[", 
         RowBox[{"#", ",", "1", ",", 
          RowBox[{"TexBreakBy", "\[Rule]", "\"\<Term\>\""}], ",", 
          RowBox[{"TexBreakString", "\[Rule]", "\"\<\\n\>\""}]}], "]"}], 
        "&"}], "/@", "Texed"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Texed", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"TexBreak", "[", 
         RowBox[{"#", ",", "$TexPrintPageWidth", ",", 
          RowBox[{"TexBreakBy", "\[Rule]", "\"\<TexPoint\>\""}], ",", 
          RowBox[{
          "TexBreakString", "\[Rule]", "\"\<\\\\nonumber\\\\\\\\\\n&\>\""}]}],
          "]"}], "&"}], "/@", "Texed"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Texed", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{"#", ",", 
          RowBox[{
          "\"\<\\n\\\\nonumber\>\"", "\[Rule]", "\"\<\\\\nonumber\>\""}]}], 
         "]"}], "&"}], "/@", "Texed"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<\\\\begin{align}\\n&\>\"", ",", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"Riffle", "[", 
         RowBox[{"Texed", ",", "\"\<,\\\\\\\\\\n&\>\""}], "]"}], "]"}], ",", 
       "\"\<.\\n\\\\end{align}\>\""}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588327304915236*^9, 3.5883273473629103`*^9}, {
   3.588327400059803*^9, 3.5883275744057093`*^9}, {3.588327891149666*^9, 
   3.588327901586084*^9}, 3.5883279884314365`*^9, {3.5883296105544853`*^9, 
   3.588329629134118*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["7. TexView", "Section",
 CellChangeTimes->{
  3.54501505147226*^9, {3.5880787462220497`*^9, 3.588078782258113*^9}, {
   3.5880831976346755`*^9, 3.588083198352277*^9}, 3.6190852110618753`*^9},
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell["7.1. TexView", "Subsection",
 CellChangeTimes->{{3.5880787928973317`*^9, 3.588078796485338*^9}, {
   3.5880826484025106`*^9, 3.5880826489641113`*^9}, 3.619085213011894*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexViewExt", "=", "\"\<.pdf\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588314511329899*^9, 3.5883145172267094`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AddEquationMarks", "[", 
    RowBox[{"string_", ",", 
     RowBox[{"mark_:", "Automatic"}]}], "]"}], ":=", 
   RowBox[{"Switch", "[", 
    RowBox[{
    "mark", ",", "\[IndentingNewLine]", "False", ",", " ", "string", ",", 
     "\[IndentingNewLine]", "Automatic", ",", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"string", ",", "6"}], "]"}], "===", "\"\<\\\\begin\>\""}], 
       ",", "string", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "@", 
          RowBox[{"StringMatchQ", "[", 
           RowBox[{"string", ",", 
            RowBox[{"___", "~~", " ", "\"\<\\\\\\\\\>\"", "~~", "___"}]}], 
           "]"}]}], ",", 
         RowBox[{"AddEquationMarks", "[", 
          RowBox[{"string", ",", "\"\<equation\>\""}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"firstlinebreak", "=", 
             RowBox[{"Last", "@", 
              RowBox[{"First", "@", 
               RowBox[{"StringPosition", "[", 
                RowBox[{"string", ",", " ", "\"\<\\\\\\\\\>\"", ",", "1"}], 
                "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{"string", ",", "firstlinebreak"}], "]"}], ",", 
               RowBox[{"___", "~~", "\"\<&\>\"", "~~", "___"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AddEquationMarks", "[", 
              RowBox[{"string", ",", "\"\<eqnarray\>\""}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"StringMatchQ", "[", 
                RowBox[{
                 RowBox[{"StringTake", "[", 
                  RowBox[{"string", ",", "firstlinebreak"}], "]"}], ",", 
                 RowBox[{"___", "~~", "\"\<=\>\"", "~~", "___"}]}], "]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"AddEquationMarks", "[", 
                RowBox[{
                 RowBox[{"StringReplace", "[", 
                  RowBox[{"string", ",", 
                   RowBox[{"\"\<=\>\"", "\[Rule]", "\"\<&=&\>\""}], ",", 
                   "1"}], "]"}], ",", "\"\<eqnarray\>\""}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"AddEquationMarks", "[", 
                RowBox[{
                 RowBox[{"StringJoin", "[", 
                  RowBox[{"\"\<&&\>\"", ",", "string"}], "]"}], ",", 
                 "\"\<eqnarray\>\""}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
        "]"}]}], "]"}], ",", "\[IndentingNewLine]", "_", ",", " ", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
      "\"\<\\\\begin{\>\"", ",", "mark", ",", "\"\<}\\n\>\"", ",", " ", 
       "string", ",", " ", "\"\<\\n\\\\end{\>\"", ",", "mark", ",", 
       "\"\<}\\n\>\""}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588079319554257*^9, 3.5880794857725487`*^9}, 
   3.5880800377659187`*^9, {3.5880802053570127`*^9, 3.5880802098966208`*^9}, 
   3.588314579814019*^9, {3.5883146261461005`*^9, 3.588314628486105*^9}, {
   3.5883147200426655`*^9, 3.5883147229130707`*^9}, {3.58831480802682*^9, 
   3.5883148370272713`*^9}, {3.5883153615479927`*^9, 
   3.5883154354609222`*^9}, {3.588315498625433*^9, 3.5883155267210827`*^9}, {
   3.5883155690751567`*^9, 3.5883155921787977`*^9}, {3.588315699241785*^9, 
   3.588315702985792*^9}, {3.58831574744587*^9, 3.588315870779687*^9}, 
   3.588315905208947*^9, 3.5883187976509094`*^9, {3.5883189126699114`*^9, 
   3.5883189764428234`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexWriteFile", "[", 
    RowBox[{"str_String", ",", "file_String"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"outfile", "=", 
       RowBox[{"OpenWrite", "[", "file", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"WriteString", "[", 
       RowBox[{"outfile", ",", 
        RowBox[{"TexInitLatexCode", "[", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"outfile", ",", "\"\<\\\\begin{document}\\n\>\""}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"outfile", ",", "str"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{
       "outfile", ",", 
        "\"\<\\n\\\\immediate\\\\write0{TexActFinished}\n\
\\\\end{document}\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "outfile", "]"}], ";"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5667368665048637`*^9, 3.566737158694377*^9}, {
   3.5667375329026356`*^9, 3.5667375603430834`*^9}, {3.5667384453678555`*^9, 
   3.5667384669738936`*^9}, {3.56673869190849*^9, 3.566738694217294*^9}, {
   3.566738914280682*^9, 3.5667389242958994`*^9}, {3.566738957477158*^9, 
   3.566739032123289*^9}, {3.5668338784885716`*^9, 3.5668338942445993`*^9}, {
   3.5668379798323755`*^9, 3.566837984652784*^9}, {3.582277943697157*^9, 
   3.582277947628364*^9}, {3.582278714357714*^9, 3.5822787257925344`*^9}, 
   3.582278792919452*^9, {3.587964407921297*^9, 3.5879644092784996`*^9}, {
   3.588080454005849*^9, 3.5880805702260537`*^9}, {3.5880806297089577`*^9, 
   3.588080630457759*^9}, {3.58808074505556*^9, 3.5880807973000526`*^9}, {
   3.5880808368929214`*^9, 3.58808084734494*^9}, {3.5915978293329887`*^9, 
   3.59159783035299*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexView", "[", 
    RowBox[{"texstr_String", ",", 
     RowBox[{"file_String:", "\"\<TexActView\>\""}], ",", 
     RowBox[{"openfileq_:", "True"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"TexOut", ",", "errorpos"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"SetDirectory", "[", "$TexDirectory", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TexWriteFile", "[", 
       RowBox[{"texstr", ",", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"file", ",", "\"\<.tex\>\""}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TexOut", "=", 
       RowBox[{"ReadList", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"\"\<!\>\"", "<>", "$LatexExecutable", "<>", "\"\< \>\""}],
            ",", "file", ",", "\"\<.tex\>\""}], "]"}], ",", "String"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ResetDirectory", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"Position", "[", 
           RowBox[{
           "TexOut", ",", "\"\<TexActFinished\>\"", ",", "1", ",", "1"}], 
           "]"}]}], "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SetDirectory", "[", "$TexDirectory", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "\"\<Typesetting OK.\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"openfileq", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Opening file: \>\"", ",", " ", "file", ",", "$TexViewExt"}],
              "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"SystemOpen", "[", 
             RowBox[{"StringJoin", "[", 
              RowBox[{"file", ",", "$TexViewExt"}], "]"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"ResetDirectory", "[", "]"}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"errorpos", "=", 
          RowBox[{"Position", "[", 
           RowBox[{"TexOut", ",", 
            RowBox[{"str_String", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"StringMatchQ", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                 "StartOfString", " ", "~~", " ", "\"\<!\>\"", "~~", 
                  "___"}]}], "]"}], "&"}], ")"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "errorpos"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Tex Error:\\n\>\"", ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"Drop", "[", 
               RowBox[{"TexOut", ",", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"First", "@", "errorpos"}]}], "-", "1"}]}], 
               "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Tex Error:\\n\>\"", ",", 
              RowBox[{"Sequence", "@@", "TexOut"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Throw", "[", "\"\<Tex Error\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5880808916022177`*^9, 3.58808102911646*^9}, {
   3.588081061408516*^9, 3.5880810645285215`*^9}, {3.588081134354244*^9, 
   3.5880811620286927`*^9}, 3.588081480739253*^9, {3.5880817583573403`*^9, 
   3.5880818022090178`*^9}, {3.5880818778703575`*^9, 3.588081878135558*^9}, {
   3.5880821751912794`*^9, 3.5880821842704954`*^9}, 3.588082344030376*^9, {
   3.588082396228068*^9, 3.588082490779834*^9}, {3.5880826813965683`*^9, 
   3.588082687152979*^9}, {3.5880830216195664`*^9, 3.588083082818474*^9}, {
   3.588314071331126*^9, 3.5883140800671415`*^9}, {3.588314536321143*^9, 
   3.5883145395815487`*^9}, {3.610714560731741*^9, 3.6107146126018133`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TexView", "[", 
   RowBox[{
    RowBox[{"eqlist", ":", 
     RowBox[{"{", 
      RowBox[{"eq_Equal", ",", "eqs___"}], " ", "}"}]}], ",", "opt___"}], 
   "]"}], ":=", 
  RowBox[{"TexView", "[", 
   RowBox[{
    RowBox[{"TexPrintAlignedEquations", "[", "eqlist", "]"}], ",", "opt"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TexView", "[", 
   RowBox[{"list_List", ",", "opt___"}], "]"}], ":=", 
  RowBox[{"TexView", "[", 
   RowBox[{
    RowBox[{"TexPrintAlignedExpressions", "[", "list", "]"}], ",", "opt"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TexView", "[", 
   RowBox[{"eq_Equal", ",", "opt___"}], "]"}], ":=", 
  RowBox[{"TexView", "[", 
   RowBox[{
    RowBox[{"TexPrintAlignedEquations", "[", "eq", "]"}], ",", "opt"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TexView", "[", 
   RowBox[{"expr_", ",", "opt___"}], "]"}], ":=", 
  RowBox[{"TexView", "[", 
   RowBox[{
    RowBox[{"AddEquationMarks", "[", 
     RowBox[{
      RowBox[{"TexPrint", "[", "expr", "]"}], ",", "Automatic"}], "]"}], ",", 
    "opt"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588082251163413*^9, 3.5880823173075294`*^9}, {
   3.5880831103369217`*^9, 3.58808318304865*^9}, {3.5883146112792745`*^9, 
   3.588314613244878*^9}, 3.588325925294613*^9, {3.5883260153379707`*^9, 
   3.588326016102372*^9}, {3.588326121418157*^9, 3.5883261307625737`*^9}, {
   3.5883264389255147`*^9, 3.588326735857436*^9}, {3.588327792401492*^9, 
   3.5883278118859262`*^9}, {3.591597869353045*^9, 3.5915978798330593`*^9}, {
   3.591597921613118*^9, 3.5915979675631824`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexPort", "[", 
    RowBox[{"expr_", ",", " ", "file_String"}], "]"}], ":=", 
   RowBox[{"TexView", "[", 
    RowBox[{"expr", ",", "file", ",", "False"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.61071469566193*^9, 3.6107147418119946`*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["8. Color support", "Section",
 CellChangeTimes->{
  3.54501505147226*^9, {3.5880787462220497`*^9, 3.588078782258113*^9}, {
   3.5880831976346755`*^9, 3.588083198352277*^9}, {3.604593894578455*^9, 
   3.6045939032884674`*^9}, 3.6190852179459333`*^9},
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell["7.1. EnableTexColor", "Subsection",
 CellChangeTimes->{{3.5880787928973317`*^9, 3.588078796485338*^9}, {
  3.5880826484025106`*^9, 3.5880826489641113`*^9}, {3.6045939062184715`*^9, 
  3.604593914038482*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EnableTexColor", "[", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"TexColor", "[", 
       RowBox[{"str_", ",", "colrule_Rule"}], "]"}], ":=", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<\\\\textcolor[rgb]\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"List", "@@", 
          RowBox[{"(", 
           RowBox[{"FontColor", "/.", "colrule"}], ")"}]}], "]"}], ",", 
        "\"\<{\>\"", ",", 
        RowBox[{"ToString", "[", "str", "]"}], ",", "\"\<}\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TexColor", "[", 
       RowBox[{"str_", ",", 
        RowBox[{"FontColor", "\[Rule]", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "]"}]}]}], "]"}], ":=", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<\\\\red{\>\"", ",", 
        RowBox[{"ToString", "[", "str", "]"}], ",", "\"\<}\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TexColor", "[", 
       RowBox[{"str_", ",", 
        RowBox[{"FontColor", "\[Rule]", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "]"}]}]}], "]"}], ":=", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<\\\\green{\>\"", ",", 
        RowBox[{"ToString", "[", "str", "]"}], ",", "\"\<}\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TexColor", "[", 
       RowBox[{"str_", ",", 
        RowBox[{"FontColor", "\[Rule]", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "]"}]}]}], "]"}], ":=", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<\\\\blue{\>\"", ",", 
        RowBox[{"ToString", "[", "str", "]"}], ",", "\"\<}\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TexColor2", "[", 
       RowBox[{"str_", ",", "colrule_Rule"}], "]"}], ":=", 
      RowBox[{"TexColor", "[", 
       RowBox[{
        RowBox[{"xAct`TexAct`Private`Removetext", "@", 
         RowBox[{"ToString", "@", 
          RowBox[{"TeXForm", "@", 
           RowBox[{"xAct`TexAct`Private`RemoveStyleBoxes", "@", "str"}]}]}]}],
         ",", "colrule"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Tex", "[", "string_String", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"StringMatchQ", "[", 
         RowBox[{"string", ",", 
          RowBox[{
          "\"\<\\!\\(\\*StyleBox[\>\"", "~~", "___", "~~", "\"\<]\\)\>\""}]}],
          "]"}], ",", 
        RowBox[{"TexColor2", "@@", 
         RowBox[{"(", 
          RowBox[{"ToExpression", "/@", 
           RowBox[{"StringSplit", "[", 
            RowBox[{
             RowBox[{"StringDrop", "[", 
              RowBox[{
               RowBox[{"StringDrop", "[", 
                RowBox[{"string", ",", "12"}], "]"}], ",", 
               RowBox[{"-", "2"}]}], "]"}], ",", "\"\<,\>\"", ",", "2"}], 
            "]"}]}], ")"}]}], ",", 
        RowBox[{"Removetext", "@", 
         RowBox[{"ToString", "@", 
          RowBox[{"TeXForm", "@", 
           RowBox[{"RemoveStyleBoxes", "@", "string"}]}]}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"$TexInitLatexPackages", "=", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Append", "[", 
        RowBox[{"$TexInitLatexPackages", ",", "\"\<{color}\>\""}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"$TexInitLatexExtraCode", "=", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Join", "[", 
        RowBox[{"$TexInitLatexExtraCode", ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\\\\newcommand{\\\\red}[1]{\\\\textcolor{red}{#1}}\>\"", ",", 
           "\"\<\\\\newcommand{\\\\green}[1]{\\\\textcolor{green}{#1}}\>\"", 
           ",", 
           "\"\<\\\\newcommand{\\\\blue}[1]{\\\\textcolor{blue}{#1}}\>\""}], 
          "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", ")"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6006237472958565`*^9, 3.600623848865999*^9}, {
  3.600623905156078*^9, 3.600623908666083*^9}, {3.6045942175880227`*^9, 
  3.6045942224580297`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DisableTexColor", "[", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Tex", "[", "string_String", "]"}], ":=", 
      RowBox[{"Removetext", "@", 
       RowBox[{"ToString", "@", 
        RowBox[{"TeXForm", "@", 
         RowBox[{"RemoveStyleBoxes", "@", "string"}]}]}]}]}], ";", 
     RowBox[{"$TexInitLatexPackages", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"$TexInitLatexPackages", ",", "\"\<{color}\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"$TexInitLatexExtraCode", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"$TexInitLatexExtraCode", ",", 
        RowBox[{"Alternatives", "[", 
         RowBox[{
         "\"\<\\\\newcommand{\\\\red}[1]{\\\\textcolor{red}{#1}}\>\"", ",", 
          "\"\<\\\\newcommand{\\\\green}[1]{\\\\textcolor{green}{#1}}\>\"", 
          ",", "\"\<\\\\newcommand{\\\\blue}[1]{\\\\textcolor{blue}{#1}}\>\""}\
], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ")"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6006237472958565`*^9, 3.600623848865999*^9}, {
  3.600623905156078*^9, 3.600623908666083*^9}, {3.604594118417884*^9, 
  3.604594150917929*^9}, {3.6045942288780384`*^9, 3.6045942996281376`*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["9. EndPackage", "Section",
 CellChangeTimes->{3.54501505147226*^9, 3.5880787289840193`*^9, 
  3.604593933347625*^9, 3.6190852199059362`*^9},
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"End", "[", "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData["\<\"xAct`TexAct`Private`\"\>"], "Output",
 CellChangeTimes->{
  3.5823477958891172`*^9, 3.582353854333251*^9, 3.5823539672016563`*^9, 
   3.583130720610623*^9, 3.5831330405228977`*^9, 3.583133120629038*^9, 
   3.583133195307369*^9, 3.5831333022455573`*^9, 3.583133334116413*^9, 
   3.583135198960289*^9, 3.583135324493709*^9, 3.583138083454155*^9, 
   3.583138208598575*^9, 3.58314655098608*^9, 3.5831466223250055`*^9, 
   3.583146828151767*^9, {3.5831473698169184`*^9, 3.583147396368165*^9}, 
   3.5831487865188065`*^9, 3.5831499336810217`*^9, 3.5831500188571715`*^9, 
   3.583150172221041*^9, 3.58315022313953*^9, 3.5831502715620155`*^9, {
   3.5879651829930587`*^9, 3.587965203491495*^9}, 3.5880798722652273`*^9, 
   3.5880799294705276`*^9, 3.5880800946592183`*^9, 3.58808014665411*^9, 
   3.588080234653864*^9, 3.588082912684575*^9, 3.58808321733751*^9, 
   3.588083664902296*^9, 3.5883166145810747`*^9, 3.5883188318461695`*^9, 
   3.588319019233699*^9, 3.588319157418741*^9, 3.5883258265620394`*^9, 
   3.5883259576334696`*^9, 3.588326916224953*^9, 3.58832785946601*^9, 
   3.5883279286833315`*^9, 3.5883280187266893`*^9, 3.588328473093088*^9, 
   3.5883285572552357`*^9, 3.5883293964909096`*^9, {3.5883296800682077`*^9, 
   3.588329703390249*^9}, 3.5883299117744136`*^9, 3.6151308255868587`*^9, 
   3.6151310078240833`*^9, 3.6190891656900873`*^9, 3.6196262148991575`*^9, 
   3.6205425711785774`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"EndPackage", "[", "]"}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["10. Examples", "Section",
 CellChangeTimes->{
  3.545015052985463*^9, 3.5880787314956236`*^9, 3.6045939358776283`*^9, {
   3.619085221365938*^9, 3.6190852216659384`*^9}},
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"<<", "xAct`xCoba`"}]], "Input",
 CellChangeTimes->{{3.583148963735118*^9, 3.5831489733759346`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{
  3.583148973906336*^9, 3.5831499337590227`*^9, 3.583150018935172*^9, 
   3.5831501722990413`*^9, 3.5831502232175307`*^9, 3.5831502716400156`*^9, {
   3.5879651830710588`*^9, 3.5879652036006947`*^9}, 3.5880798723588276`*^9, 
   3.588079954820573*^9, 3.5880800947372184`*^9, 3.5880801467321095`*^9, 
   3.5880802578355045`*^9, 3.588082912762575*^9, 3.588083240550351*^9, 
   3.5880836649958963`*^9, 3.5883166146590753`*^9, 3.5883188320021696`*^9, 
   3.588319019311699*^9, 3.5883191574967413`*^9, 3.5883258266400394`*^9, 
   3.5883259577114697`*^9, 3.5883269163029537`*^9, 3.58832785960641*^9, 
   3.588327928901732*^9, 3.58832801880469*^9, 3.588328473171088*^9, 
   3.5883285573332357`*^9, 3.58832939672491*^9, {3.588329680099408*^9, 
   3.588329703561849*^9}, 3.588329911930414*^9, 3.6151308256568584`*^9, 
   3.6151310078864837`*^9, 3.6190891657500873`*^9, 3.619626214959157*^9, 
   3.6205425712485776`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`xCoba`  version \"\>", 
   "\[InvisibleSpace]", "\<\"0.8.2\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2014", ",", "9", ",", "6"}], "}"}]}],
  SequenceForm["Package xAct`xCoba`  version ", "0.8.2", ", ", {2014, 9, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.583148973906336*^9, 3.5831499337590227`*^9, 3.583150018935172*^9, 
   3.5831501722990413`*^9, 3.5831502232175307`*^9, 3.5831502716400156`*^9, {
   3.5879651830710588`*^9, 3.5879652036006947`*^9}, 3.5880798723588276`*^9, 
   3.588079954820573*^9, 3.5880800947372184`*^9, 3.5880801467321095`*^9, 
   3.5880802578355045`*^9, 3.588082912762575*^9, 3.588083240550351*^9, 
   3.5880836649958963`*^9, 3.5883166146590753`*^9, 3.5883188320021696`*^9, 
   3.588319019311699*^9, 3.5883191574967413`*^9, 3.5883258266400394`*^9, 
   3.5883259577114697`*^9, 3.5883269163029537`*^9, 3.58832785960641*^9, 
   3.588327928901732*^9, 3.58832801880469*^9, 3.588328473171088*^9, 
   3.5883285573332357`*^9, 3.58832939672491*^9, {3.588329680099408*^9, 
   3.588329703561849*^9}, 3.588329911930414*^9, 3.6151308256568584`*^9, 
   3.6151310078864837`*^9, 3.6190891657500873`*^9, 3.619626214959157*^9, 
   3.6205425712485776`*^9}],

Cell[BoxData["\<\"CopyRight (C) 2005-2014, David Yllanes and Jose M. \
Martin-Garcia, under the General Public License.\"\>"], "Print",
 CellChangeTimes->{
  3.583148973906336*^9, 3.5831499337590227`*^9, 3.583150018935172*^9, 
   3.5831501722990413`*^9, 3.5831502232175307`*^9, 3.5831502716400156`*^9, {
   3.5879651830710588`*^9, 3.5879652036006947`*^9}, 3.5880798723588276`*^9, 
   3.588079954820573*^9, 3.5880800947372184`*^9, 3.5880801467321095`*^9, 
   3.5880802578355045`*^9, 3.588082912762575*^9, 3.588083240550351*^9, 
   3.5880836649958963`*^9, 3.5883166146590753`*^9, 3.5883188320021696`*^9, 
   3.588319019311699*^9, 3.5883191574967413`*^9, 3.5883258266400394`*^9, 
   3.5883259577114697`*^9, 3.5883269163029537`*^9, 3.58832785960641*^9, 
   3.588327928901732*^9, 3.58832801880469*^9, 3.588328473171088*^9, 
   3.5883285573332357`*^9, 3.58832939672491*^9, {3.588329680099408*^9, 
   3.588329703561849*^9}, 3.588329911930414*^9, 3.6151308256568584`*^9, 
   3.6151310078864837`*^9, 3.6190891657500873`*^9, 3.619626214959157*^9, 
   3.6205425712485776`*^9}],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{
  3.583148973906336*^9, 3.5831499337590227`*^9, 3.583150018935172*^9, 
   3.5831501722990413`*^9, 3.5831502232175307`*^9, 3.5831502716400156`*^9, {
   3.5879651830710588`*^9, 3.5879652036006947`*^9}, 3.5880798723588276`*^9, 
   3.588079954820573*^9, 3.5880800947372184`*^9, 3.5880801467321095`*^9, 
   3.5880802578355045`*^9, 3.588082912762575*^9, 3.588083240550351*^9, 
   3.5880836649958963`*^9, 3.5883166146590753`*^9, 3.5883188320021696`*^9, 
   3.588319019311699*^9, 3.5883191574967413`*^9, 3.5883258266400394`*^9, 
   3.5883259577114697`*^9, 3.5883269163029537`*^9, 3.58832785960641*^9, 
   3.588327928901732*^9, 3.58832801880469*^9, 3.588328473171088*^9, 
   3.5883285573332357`*^9, 3.58832939672491*^9, {3.588329680099408*^9, 
   3.588329703561849*^9}, 3.588329911930414*^9, 3.6151308256568584`*^9, 
   3.6151310078864837`*^9, 3.6190891657500873`*^9, 3.619626214959157*^9, 
   3.6205425712485776`*^9}],

Cell[BoxData["\<\"These packages come with ABSOLUTELY NO WARRANTY; for \
details type Disclaimer[]. This is free software, and you are welcome to \
redistribute it under certain conditions. See the General Public License for \
details.\"\>"], "Print",
 CellChangeTimes->{
  3.583148973906336*^9, 3.5831499337590227`*^9, 3.583150018935172*^9, 
   3.5831501722990413`*^9, 3.5831502232175307`*^9, 3.5831502716400156`*^9, {
   3.5879651830710588`*^9, 3.5879652036006947`*^9}, 3.5880798723588276`*^9, 
   3.588079954820573*^9, 3.5880800947372184`*^9, 3.5880801467321095`*^9, 
   3.5880802578355045`*^9, 3.588082912762575*^9, 3.588083240550351*^9, 
   3.5880836649958963`*^9, 3.5883166146590753`*^9, 3.5883188320021696`*^9, 
   3.588319019311699*^9, 3.5883191574967413`*^9, 3.5883258266400394`*^9, 
   3.5883259577114697`*^9, 3.5883269163029537`*^9, 3.58832785960641*^9, 
   3.588327928901732*^9, 3.58832801880469*^9, 3.588328473171088*^9, 
   3.5883285573332357`*^9, 3.58832939672491*^9, {3.588329680099408*^9, 
   3.588329703561849*^9}, 3.588329911930414*^9, 3.6151308256568584`*^9, 
   3.6151310078864837`*^9, 3.6190891657500873`*^9, 3.619626214959157*^9, 
   3.6205425712585773`*^9}],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{
  3.583148973906336*^9, 3.5831499337590227`*^9, 3.583150018935172*^9, 
   3.5831501722990413`*^9, 3.5831502232175307`*^9, 3.5831502716400156`*^9, {
   3.5879651830710588`*^9, 3.5879652036006947`*^9}, 3.5880798723588276`*^9, 
   3.588079954820573*^9, 3.5880800947372184`*^9, 3.5880801467321095`*^9, 
   3.5880802578355045`*^9, 3.588082912762575*^9, 3.588083240550351*^9, 
   3.5880836649958963`*^9, 3.5883166146590753`*^9, 3.5883188320021696`*^9, 
   3.588319019311699*^9, 3.5883191574967413`*^9, 3.5883258266400394`*^9, 
   3.5883259577114697`*^9, 3.5883269163029537`*^9, 3.58832785960641*^9, 
   3.588327928901732*^9, 3.58832801880469*^9, 3.588328473171088*^9, 
   3.5883285573332357`*^9, 3.58832939672491*^9, {3.588329680099408*^9, 
   3.588329703561849*^9}, 3.588329911930414*^9, 3.6151308256568584`*^9, 
   3.6151310078864837`*^9, 3.6190891657500873`*^9, 3.619626214959157*^9, 
   3.6205425712585773`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefManifold", "[", 
  RowBox[{"M4", ",", "4", ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f", ",", "g"}],
     "}"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefManifold", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"manifold \"\>", "\[InvisibleSpace]", "M4", 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefManifold, ": Defining ", 
   "manifold ", $CellContext`M4, ". ", ""],
  Editable->False]], "Print",
 CellChangeTimes->{3.5883297036242495`*^9, 3.5883299120084143`*^9, 
  3.615130825776859*^9, 3.6151310079488835`*^9, 3.619089165810087*^9, 
  3.6196262152391577`*^9, 3.6205425713985777`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefVBundle", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"vbundle \"\>", "\[InvisibleSpace]", "TangentM4", 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefVBundle, ": Defining ", 
   "vbundle ", $CellContext`TangentM4, ". ", ""],
  Editable->False]], "Print",
 CellChangeTimes->{3.5883297036242495`*^9, 3.5883299120084143`*^9, 
  3.615130825776859*^9, 3.6151310079488835`*^9, 3.619089165810087*^9, 
  3.6196262152391577`*^9, 3.6205425713985777`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"T", "[", 
    RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "M4", ",", 
   RowBox[{"PrintAs", "->", "\"\<\[Tau]\>\""}]}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"T", "[", 
    RowBox[{"a", ",", "b", ",", "c"}], "]"}], 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", xAct`xTensor`DefTensor, ": Defining ", "tensor ", 
   $CellContext`T[$CellContext`a, $CellContext`b, $CellContext`c], ". ", ""],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.587965203694295*^9, 3.5880798724368277`*^9, 3.5880799549453726`*^9, 
   3.5880800078606653`*^9, 3.5880800948152184`*^9, 3.5880801699761505`*^9, 
   3.588080257960305*^9, 3.588082936022216*^9, 3.588083240675151*^9, 
   3.588083688395938*^9, 3.5883166147838755`*^9, 3.588318843171789*^9, 
   3.5883190194052987`*^9, 3.5883191687755613`*^9, 3.5883258267180395`*^9, 
   3.58832595799227*^9, 3.588326916380954*^9, 3.5883278597468104`*^9, 
   3.588327928932932*^9, 3.58832801888269*^9, 3.5883284732490883`*^9, 
   3.588328557411236*^9, 3.5883293967717104`*^9, {3.5883296802554083`*^9, 
   3.588329703639849*^9}, 3.588329912024014*^9, 3.6151308257868586`*^9, 
   3.6151310079644833`*^9, 3.6190891658200874`*^9, 3.619626215249158*^9, 
   3.620542571408578*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "3"}], 
    RowBox[{"T", "[", 
     RowBox[{"a", ",", 
      RowBox[{"-", "b"}], ",", "c"}], "]"}]}], "+", 
   RowBox[{"7", 
    RowBox[{"T", "[", 
     RowBox[{"d", ",", "f"}], "]"}]}], "+", 
   RowBox[{"Pi", " ", 
    RowBox[{"T", "[", 
     RowBox[{"g", ",", "f"}], "]"}]}], "-", "5"}]}]], "Input",
 CellChangeTimes->{{3.5880805950612974`*^9, 3.588080596200099*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "5"}], "+", 
  RowBox[{"7", " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[Tau]", 
        StyleBox[GridBox[{
           {"d", "f"},
           {" ", " "}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T[$CellContext`d, $CellContext`f],
    Editable->False]}], "+", 
  RowBox[{"\[Pi]", " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[Tau]", 
        StyleBox[GridBox[{
           {"g", "f"},
           {" ", " "}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T[$CellContext`g, $CellContext`f],
    Editable->False]}], "-", 
  RowBox[{"3", " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[Tau]", 
        StyleBox[GridBox[{
           {"a", " ", "c"},
           {" ", "b", " "}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T[$CellContext`a, -$CellContext`b, $CellContext`c],
    Editable->False]}]}]], "Output",
 CellChangeTimes->{
  3.582347795935917*^9, 3.582353854395651*^9, 3.582353967264056*^9, 
   3.583130720657423*^9, 3.5831330405696974`*^9, 3.5831331206758385`*^9, 
   3.58313319535417*^9, 3.5831333022767572`*^9, 3.5831333342880135`*^9, 
   3.583135199022689*^9, 3.5831353246185093`*^9, 3.5831380835165553`*^9, 
   3.5831382086609755`*^9, 3.58314655103288*^9, 3.583146622371805*^9, 
   3.583146828198567*^9, {3.583147370035319*^9, 3.5831473964149647`*^9}, 
   3.583148786565607*^9, 3.5831499339462223`*^9, 3.5831500190287724`*^9, 
   3.583150172392641*^9, 3.583150223357931*^9, 3.583150271733616*^9, {
   3.5879651832582593`*^9, 3.587965203709895*^9}, 3.588079872468028*^9, 
   3.5880799553977737`*^9, 3.5880800109338713`*^9, 3.588080094830818*^9, 
   3.5880801699917507`*^9, 3.588080257975905*^9, 3.5880805969489*^9, 
   3.588082936037816*^9, 3.588083240690751*^9, 3.5880836884271374`*^9, 
   3.588316614799475*^9, 3.5883188431873894`*^9, 3.588319019420899*^9, 
   3.5883191688067613`*^9, 3.5883258267180395`*^9, 3.5883259580078697`*^9, 
   3.5883269163965535`*^9, 3.58832785976241*^9, 3.588327928948532*^9, 
   3.5883280188982897`*^9, 3.588328473264688*^9, 3.588328557426836*^9, 
   3.5883293967717104`*^9, {3.588329680271008*^9, 3.588329703655449*^9}, 
   3.588329912024014*^9, 3.615130825796859*^9, 3.6151310079644833`*^9, 
   3.6190891658300877`*^9, 3.6196262152591577`*^9, 3.620542571418578*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tex", "[", "expr1", "]"}]], "Input",
 CellChangeTimes->{3.5880806017069087`*^9}],

Cell[BoxData["\<\"-5 + 7 \\\\tau^{df} + \\\\pi \\\\tau^{gf} + -3 \
\\\\tau^{a}{}_{b}{}^{c}\"\>"], "Output",
 CellChangeTimes->{
  3.5823477959983172`*^9, 3.582353854442451*^9, 3.5823539673108563`*^9, 
   3.5831307207042227`*^9, 3.5831330407412977`*^9, 3.583133120722638*^9, 
   3.5831331954009695`*^9, 3.583133302339157*^9, 3.5831333343348136`*^9, 
   3.583135199163089*^9, 3.58313532466531*^9, 3.583138083734956*^9, 
   3.583138208707775*^9, 3.5831465510796804`*^9, 3.583146622418606*^9, 
   3.583146828245367*^9, {3.5831473700509186`*^9, 3.583147396446165*^9}, 
   3.5831487866124067`*^9, 3.583149933993023*^9, 3.583150019075572*^9, 
   3.583150172455042*^9, 3.583150223404731*^9, 3.583150271780416*^9, {
   3.5879651833050594`*^9, 3.5879652037566953`*^9}, 3.588079872530428*^9, 
   3.588079955990575*^9, 3.5880800140070763`*^9, 3.588080094877619*^9, 
   3.5880801700385504`*^9, 3.588080258022705*^9, 3.5880806020969095`*^9, 
   3.5880829360846157`*^9, 3.588083240753151*^9, 3.5880836884895377`*^9, 
   3.5883166148618755`*^9, 3.5883188432497897`*^9, 3.5883190194832993`*^9, 
   3.5883191688691616`*^9, 3.5883258267648396`*^9, 3.5883259580546703`*^9, 
   3.5883269164433537`*^9, 3.588327859809211*^9, 3.588327928995332*^9, 
   3.5883280189450903`*^9, 3.588328473311488*^9, 3.5883285574736357`*^9, 
   3.58832939681851*^9, {3.5883296802866077`*^9, 3.5883297037022495`*^9}, 
   3.5883299120864143`*^9, 3.615130825816859*^9, 3.6151310079956837`*^9, 
   3.6190891658600874`*^9, 3.6196262152791576`*^9, 3.6205425714385777`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "[", "expr1", "]"}]], "Input",
 CellChangeTimes->{3.588080603656912*^9}],

Cell[BoxData["\<\"-5 + 7 \\\\tau^{df} + \\\\pi \\\\tau^{gf} - 3 \
\\\\tau^{a}{}_{b}{}^{c}\"\>"], "Output",
 CellChangeTimes->{
  3.582347796029517*^9, 3.582353854473651*^9, 3.582353967326456*^9, 
   3.583130720735423*^9, 3.583133040772498*^9, 3.5831331207382383`*^9, 
   3.5831331954633694`*^9, 3.5831333023547573`*^9, 3.5831333343660135`*^9, 
   3.583135199178689*^9, 3.5831353246809096`*^9, 3.583138083906556*^9, 
   3.5831382087233753`*^9, 3.58314655109528*^9, 3.5831466224342055`*^9, 
   3.5831468282609673`*^9, {3.583147370066519*^9, 3.5831473964773655`*^9}, 
   3.583148786628007*^9, 3.583149934008623*^9, 3.5831500191067724`*^9, 
   3.5831501724706416`*^9, 3.583150223435931*^9, 3.5831502717960157`*^9, {
   3.5879651833362594`*^9, 3.587965203772295*^9}, 3.588079872546028*^9, 
   3.5880799560529747`*^9, 3.5880800179070835`*^9, 3.5880800949088182`*^9, 
   3.5880801700541506`*^9, 3.5880802580539055`*^9, {3.5880806040001125`*^9, 
   3.588080614311731*^9}, 3.588082936100216*^9, 3.588083240768751*^9, 
   3.5880836885207376`*^9, 3.5883166148774757`*^9, 3.5883188432653894`*^9, 
   3.588319019498899*^9, 3.5883191689003615`*^9, 3.5883258267960396`*^9, 
   3.5883259580702705`*^9, 3.588326916458954*^9, 3.5883278598248105`*^9, 
   3.588327929010932*^9, 3.58832801897629*^9, 3.588328473342688*^9, 
   3.588328557489236*^9, 3.5883293968497105`*^9, {3.588329680302208*^9, 
   3.5883297037178493`*^9}, 3.5883299121020145`*^9, 3.6151308258268585`*^9, 
   3.615131008011284*^9, 3.6190891658700876`*^9, 3.619626215289158*^9, 
   3.620542571448578*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddEquationMarks", "[", 
  RowBox[{"%", ",", "\"\<equation*\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.5880800203406878`*^9, 3.5880800338503113`*^9}, {
   3.5880801756857605`*^9, 3.5880801890705843`*^9}, {3.588080606589717*^9, 
   3.588080613048129*^9}, 3.58808289876935*^9}],

Cell[BoxData["\<\"\\\\begin{equation*}\\n-5 + 7 \\\\tau^{df} + \\\\pi \
\\\\tau^{gf} - 3 \\\\tau^{a}{}_{b}{}^{c}\\n\\\\end{equation*}\\n\"\>"], \
"Output",
 CellChangeTimes->{
  3.588080190084586*^9, 3.588080258069505*^9, {3.5880806072293186`*^9, 
   3.5880806149201317`*^9}, 3.5880829381282196`*^9, 3.588083257585581*^9, 
   3.5880836885831375`*^9, 3.588316614893076*^9, 3.5883188432809896`*^9, 
   3.588319019514499*^9, 3.5883191689159613`*^9, 3.5883258267960396`*^9, 
   3.5883259580858707`*^9, 3.5883269164745536`*^9, 3.5883278598404107`*^9, 
   3.588327929026532*^9, 3.58832801897629*^9, 3.588328473342688*^9, 
   3.588328557504836*^9, 3.5883293968497105`*^9, {3.588329680317808*^9, 
   3.588329703733449*^9}, 3.5883299121176147`*^9, 3.6151308258368587`*^9, 
   3.615131008011284*^9, 3.6190891658700876`*^9, 3.619626215289158*^9, 
   3.620542571458578*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$CovDFormat", "=", "\"\<Prefix\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CovDQ", "[", "CD", "]"}], "^=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SymbolOfCovD", "[", "CD", "]"}], "^=", 
   RowBox[{"{", 
    RowBox[{"\"\<;\>\"", ",", "\"\<D\>\""}], "}"}]}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "[", 
  RowBox[{
   RowBox[{"CD", "[", 
    RowBox[{"-", "a"}], "]"}], "[", 
   RowBox[{"T", "[", 
    RowBox[{"b", ",", 
     RowBox[{"-", "c"}]}], "]"}], "]"}], "]"}]], "Input"],

Cell[BoxData["\<\"D_{a}\\\\tau^{b}{}_{c}\"\>"], "Output",
 CellChangeTimes->{
  3.5823477960451174`*^9, 3.5823538545048513`*^9, 3.5823539673576565`*^9, 
   3.5831307207510233`*^9, 3.5831330407880983`*^9, 3.5831331207538385`*^9, 
   3.58313319557257*^9, 3.5831333023703575`*^9, 3.5831333343816137`*^9, 
   3.5831351992098894`*^9, 3.5831353247121096`*^9, 3.5831380840937567`*^9, 
   3.5831382087389755`*^9, 3.5831465511108804`*^9, 3.5831466224654055`*^9, 
   3.5831468282765675`*^9, {3.5831473700977187`*^9, 3.583147396492965*^9}, 
   3.583148786643607*^9, 3.5831499340398226`*^9, 3.583150019122372*^9, 
   3.5831501724862413`*^9, 3.5831502234515314`*^9, 3.583150271827216*^9, {
   3.58796518341426*^9, 3.5879652038034954`*^9}, 3.588079872577228*^9, 
   3.588079956084175*^9, 3.5880832905172386`*^9, 3.588083688754738*^9, 
   3.5883166149086757`*^9, 3.5883188433121896`*^9, 3.588319019545699*^9, 
   3.5883191689471617`*^9, 3.5883258268272395`*^9, 3.5883259581014705`*^9, 
   3.5883269164901533`*^9, 3.588327859856011*^9, 3.5883279290421324`*^9, 
   3.58832801900749*^9, 3.5883284733738885`*^9, 3.5883285575204363`*^9, 
   3.5883293968809104`*^9, {3.5883296803334084`*^9, 3.5883297038894496`*^9}, 
   3.5883299121332145`*^9, 3.615130825846859*^9, 3.615131008026884*^9, 
   3.619089165880088*^9, 3.6196262152991576`*^9, 3.6205425714685783`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"$CovDFormat", "=", "\"\<Postfix\>\""}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "[", 
  RowBox[{
   RowBox[{"CD", "[", 
    RowBox[{"-", "a"}], "]"}], "[", 
   RowBox[{"T", "[", 
    RowBox[{"b", ",", 
     RowBox[{"-", "c"}]}], "]"}], "]"}], "]"}]], "Input"],

Cell[BoxData["\<\"\\\\tau^{b}{}_{c}{}_{;a}\"\>"], "Output",
 CellChangeTimes->{
  3.5823477960763173`*^9, 3.5823538545204515`*^9, 3.5823539673888564`*^9, 
   3.583130720766623*^9, 3.583133040803698*^9, 3.5831331207850385`*^9, 
   3.58313319571297*^9, 3.5831333023859577`*^9, 3.583133334397214*^9, 
   3.583135199225489*^9, 3.58313532472771*^9, 3.5831380842809563`*^9, 
   3.5831382087545753`*^9, 3.583146551438481*^9, 3.5831466224810057`*^9, 
   3.583146828307767*^9, {3.5831473701133184`*^9, 3.583147396508565*^9}, 
   3.583148786659207*^9, 3.583149934055423*^9, 3.583150019137972*^9, 
   3.5831501725174417`*^9, 3.583150223482731*^9, 3.5831502718428164`*^9, {
   3.5879651834298596`*^9, 3.5879652038190956`*^9}, 3.588079872608428*^9, 
   3.588079956099775*^9, 3.5880832919056416`*^9, 3.5880836887859383`*^9, 
   3.5883166149398756`*^9, 3.5883188433277893`*^9, 3.5883190195768995`*^9, 
   3.5883191689939613`*^9, 3.5883258268428397`*^9, 3.58832595811707*^9, 
   3.5883269165057535`*^9, 3.588327859887211*^9, 3.588327929057732*^9, 
   3.5883280190230904`*^9, 3.588328473389488*^9, 3.588328557536036*^9, 
   3.58832939689651*^9, {3.5883296803490086`*^9, 3.5883297039050493`*^9}, 
   3.588329912148814*^9, 3.615130825856859*^9, 3.615131008042484*^9, 
   3.6190891659000874`*^9, 3.6196262153091574`*^9, 3.620542571478578*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"$CovDFormat", "=", "\"\<Prefix\>\""}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefBasis", "[", 
  RowBox[{"B4", ",", "TangentM4", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.583148956403105*^9, 3.583148998601179*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefBasis", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"basis \"\>", "\[InvisibleSpace]", "B4", 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xCoba`DefBasis, ": Defining ", "basis ", $CellContext`B4, ". ", 
   ""],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.5879652038346953`*^9, 3.5880798726396284`*^9, 3.5880799561153746`*^9, 
   3.5880832932316437`*^9, 3.5880836888015385`*^9, 3.588316614955476*^9, 
   3.5883188433433895`*^9, 3.5883190195924993`*^9, 3.5883191690095615`*^9, 
   3.5883258268584394`*^9, 3.5883259581326704`*^9, 3.5883269165213537`*^9, 
   3.588327859887211*^9, 3.5883279290733323`*^9, 3.5883280190386906`*^9, 
   3.5883284734050884`*^9, 3.5883285575516357`*^9, 3.5883293969121103`*^9, {
   3.5883296803646083`*^9, 3.5883297039206495`*^9}, 3.5883299121644144`*^9, 
   3.6151308258768587`*^9, 3.615131008042484*^9, 3.6190891659100876`*^9, 
   3.6196262153191576`*^9, 3.620542571488578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefCovD", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"parallel derivative \"\>", "\[InvisibleSpace]", 
   RowBox[{"PDB4", "[", 
    RowBox[{"-", "a"}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefCovD, ": Defining ", "parallel derivative ", 
   $CellContext`PDB4[-$CellContext`a], ". ", ""],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.5879652038346953`*^9, 3.5880798726396284`*^9, 3.5880799561153746`*^9, 
   3.5880832932316437`*^9, 3.5880836888015385`*^9, 3.588316614955476*^9, 
   3.5883188433433895`*^9, 3.5883190195924993`*^9, 3.5883191690095615`*^9, 
   3.5883258268584394`*^9, 3.5883259581326704`*^9, 3.5883269165213537`*^9, 
   3.588327859887211*^9, 3.5883279290733323`*^9, 3.5883280190386906`*^9, 
   3.5883284734050884`*^9, 3.5883285575516357`*^9, 3.5883293969121103`*^9, {
   3.5883296803646083`*^9, 3.5883297039206495`*^9}, 3.5883299121644144`*^9, 
   3.6151308258768587`*^9, 3.615131008042484*^9, 3.6190891659100876`*^9, 
   3.6196262153191576`*^9, 3.620542571488578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"torsion tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"TorsionPDB4", "[", 
    RowBox[{"a", ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefTensor, ": Defining ", "torsion tensor ", 
   $CellContext`TorsionPDB4[$CellContext`a, -$CellContext`b, -$CellContext`c],
    ". ", ""],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.5879652038346953`*^9, 3.5880798726396284`*^9, 3.5880799561153746`*^9, 
   3.5880832932316437`*^9, 3.5880836888015385`*^9, 3.588316614955476*^9, 
   3.5883188433433895`*^9, 3.5883190195924993`*^9, 3.5883191690095615`*^9, 
   3.5883258268584394`*^9, 3.5883259581326704`*^9, 3.5883269165213537`*^9, 
   3.588327859887211*^9, 3.5883279290733323`*^9, 3.5883280190386906`*^9, 
   3.5883284734050884`*^9, 3.5883285575516357`*^9, 3.5883293969121103`*^9, {
   3.5883296803646083`*^9, 3.5883297039206495`*^9}, 3.5883299121644144`*^9, 
   3.6151308258768587`*^9, 3.615131008042484*^9, 3.6190891659100876`*^9, 
   3.6196262153191576`*^9, 3.620542571488578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"non-symmetric Christoffel tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"ChristoffelPDB4", "[", 
    RowBox[{"a", ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefTensor, ": Defining ", 
   "non-symmetric Christoffel tensor ", 
   $CellContext`ChristoffelPDB4[$CellContext`a, -$CellContext`b, \
-$CellContext`c], ". ", ""],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.5879652038346953`*^9, 3.5880798726396284`*^9, 3.5880799561153746`*^9, 
   3.5880832932316437`*^9, 3.5880836888015385`*^9, 3.588316614955476*^9, 
   3.5883188433433895`*^9, 3.5883190195924993`*^9, 3.5883191690095615`*^9, 
   3.5883258268584394`*^9, 3.5883259581326704`*^9, 3.5883269165213537`*^9, 
   3.588327859887211*^9, 3.5883279290733323`*^9, 3.5883280190386906`*^9, 
   3.5883284734050884`*^9, 3.5883285575516357`*^9, 3.5883293969121103`*^9, {
   3.5883296803646083`*^9, 3.5883297039206495`*^9}, 3.5883299121644144`*^9, 
   3.6151308258768587`*^9, 3.615131008042484*^9, 3.6190891659100876`*^9, 
   3.6196262153191576`*^9, 3.620542571488578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"vanishing Riemann tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"RiemannPDB4", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}], ",", "d"}], "]"}], "\[InvisibleSpace]", "\<\". \"\>",
    "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefTensor, ": Defining ", "vanishing Riemann tensor ", 
   $CellContext`RiemannPDB4[-$CellContext`a, -$CellContext`b, \
-$CellContext`c, $CellContext`d], ". ", ""],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.5879652038346953`*^9, 3.5880798726396284`*^9, 3.5880799561153746`*^9, 
   3.5880832932316437`*^9, 3.5880836888015385`*^9, 3.588316614955476*^9, 
   3.5883188433433895`*^9, 3.5883190195924993`*^9, 3.5883191690095615`*^9, 
   3.5883258268584394`*^9, 3.5883259581326704`*^9, 3.5883269165213537`*^9, 
   3.588327859887211*^9, 3.5883279290733323`*^9, 3.5883280190386906`*^9, 
   3.5883284734050884`*^9, 3.5883285575516357`*^9, 3.5883293969121103`*^9, {
   3.5883296803646083`*^9, 3.5883297039206495`*^9}, 3.5883299121644144`*^9, 
   3.6151308258768587`*^9, 3.615131008042484*^9, 3.6190891659100876`*^9, 
   3.6196262153191576`*^9, 3.620542571488578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"vanishing Ricci tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"RicciPDB4", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefTensor, ": Defining ", "vanishing Ricci tensor ", 
   $CellContext`RicciPDB4[-$CellContext`a, -$CellContext`b], ". ", ""],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.5879652038346953`*^9, 3.5880798726396284`*^9, 3.5880799561153746`*^9, 
   3.5880832932316437`*^9, 3.5880836888015385`*^9, 3.588316614955476*^9, 
   3.5883188433433895`*^9, 3.5883190195924993`*^9, 3.5883191690095615`*^9, 
   3.5883258268584394`*^9, 3.5883259581326704`*^9, 3.5883269165213537`*^9, 
   3.588327859887211*^9, 3.5883279290733323`*^9, 3.5883280190386906`*^9, 
   3.5883284734050884`*^9, 3.5883285575516357`*^9, 3.5883293969121103`*^9, {
   3.5883296803646083`*^9, 3.5883297039206495`*^9}, 3.5883299121644144`*^9, 
   3.6151308258768587`*^9, 3.615131008042484*^9, 3.6190891659100876`*^9, 
   3.6196262153191576`*^9, 3.620542571488578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"antisymmetric +1 density \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"etaUpB4", "[", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefTensor, ": Defining ", "antisymmetric +1 density ", 
   $CellContext`etaUpB4[$CellContext`a, $CellContext`b, $CellContext`c, \
$CellContext`d], ". ", ""],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.5879652038346953`*^9, 3.5880798726396284`*^9, 3.5880799561153746`*^9, 
   3.5880832932316437`*^9, 3.5880836888015385`*^9, 3.588316614955476*^9, 
   3.5883188433433895`*^9, 3.5883190195924993`*^9, 3.5883191690095615`*^9, 
   3.5883258268584394`*^9, 3.5883259581326704`*^9, 3.5883269165213537`*^9, 
   3.588327859887211*^9, 3.5883279290733323`*^9, 3.5883280190386906`*^9, 
   3.5883284734050884`*^9, 3.5883285575516357`*^9, 3.5883293969121103`*^9, {
   3.5883296803646083`*^9, 3.5883297039206495`*^9}, 3.5883299121644144`*^9, 
   3.6151308258768587`*^9, 3.615131008042484*^9, 3.6190891659100876`*^9, 
   3.6196262153191576`*^9, 3.620542571488578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"antisymmetric -1 density \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"etaDownB4", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}], ",", 
     RowBox[{"-", "d"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefTensor, ": Defining ", "antisymmetric -1 density ", 
   $CellContext`etaDownB4[-$CellContext`a, -$CellContext`b, -$CellContext`c, \
-$CellContext`d], ". ", ""],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.5879652038346953`*^9, 3.5880798726396284`*^9, 3.5880799561153746`*^9, 
   3.5880832932316437`*^9, 3.5880836888015385`*^9, 3.588316614955476*^9, 
   3.5883188433433895`*^9, 3.5883190195924993`*^9, 3.5883191690095615`*^9, 
   3.5883258268584394`*^9, 3.5883259581326704`*^9, 3.5883269165213537`*^9, 
   3.588327859887211*^9, 3.5883279290733323`*^9, 3.5883280190386906`*^9, 
   3.5883284734050884`*^9, 3.5883285575516357`*^9, 3.5883293969121103`*^9, {
   3.5883296803646083`*^9, 3.5883297039206495`*^9}, 3.5883299121644144`*^9, 
   3.6151308258768587`*^9, 3.615131008042484*^9, 3.6190891659100876`*^9, 
   3.6196262153191576`*^9, 3.620542571498578*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PDBasisExpr", "=", 
  RowBox[{
   RowBox[{"PDB4", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "B4"}]}], "}"}], "]"}], "[", 
   RowBox[{"T", "[", 
    RowBox[{"b", ",", 
     RowBox[{"-", "c"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.583149800144788*^9, 3.5831498073676004`*^9}, {
  3.5831501304441676`*^9, 3.583150136309778*^9}}],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   RowBox[{
    SubscriptBox[
     StyleBox["\[ScriptCapitalD]",
      FontColor->RGBColor[1., 0., 0.]], 
     StyleBox["1",
      FontColor->RGBColor[1., 0., 0.]]], GridBox[{
      {"\[Tau]", 
       StyleBox[GridBox[{
          {"b", " "},
          {" ", "c"}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.], {
              Offset[0.034999999999999996`]}, 
             Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
              Offset[0.]}}, "RowsIndexed" -> {}}],
        FontSize->Rational[39, 4]]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.034999999999999996`]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}]}],
   ShowAutoStyles->False,
   AutoSpacing->False],
  $CellContext`PDB4[{1, -$CellContext`B4}][
   $CellContext`T[$CellContext`b, -$CellContext`c]],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.583149012142003*^9, 3.5831499341022224`*^9, 3.5831500191847725`*^9, 
   3.58315013749538*^9, 3.5831501725642414`*^9, 3.583150223545131*^9, 
   3.583150271889616*^9, {3.5879651834610596`*^9, 3.5879652038814955`*^9}, 
   3.5880798726708283`*^9, 3.588079956146575*^9, 3.5880832941052446`*^9, 
   3.5880836888639383`*^9, 3.5883166149866753`*^9, 3.5883188433901896`*^9, 
   3.5883190196392994`*^9, 3.588319169071962*^9, 3.58832582688964*^9, 
   3.58832595817947*^9, 3.588326916552554*^9, 3.5883278599340105`*^9, 
   3.5883279291045322`*^9, 3.5883280190698905`*^9, 3.5883284734362884`*^9, 
   3.588328557582836*^9, 3.5883293969433107`*^9, {3.588329680395808*^9, 
   3.58832970395185*^9}, 3.588329912211214*^9, 3.615130825896859*^9, 
   3.6151310080580835`*^9, 3.6190891659300876`*^9, 3.6196262153491573`*^9, 
   3.6205425715085783`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellChangeTimes->{{3.583147037051734*^9, 3.583147040015739*^9}, 
   3.5831488906021895`*^9, {3.5831490114244013`*^9, 3.583149013343205*^9}}],

Cell[BoxData["\<\"\\\\mathcal{D}_{1}\\\\tau^{b}{}_{c}\"\>"], "Output",
 CellChangeTimes->{{3.583147040202939*^9, 3.583147066332985*^9}, {
   3.5831473701289186`*^9, 3.5831474248070145`*^9}, 3.583147462262681*^9, 
   3.583148892739393*^9, 3.583149013592806*^9, 3.5831499341178226`*^9, 
   3.5831500192003727`*^9, 3.583150139304983*^9, 3.583150172595442*^9, 
   3.583150223560731*^9, 3.5831502719208164`*^9, {3.5879651834922595`*^9, 
   3.5879652038970957`*^9}, 3.5880798727020283`*^9, 3.5880799561621747`*^9, 
   3.588083295025646*^9, 3.5880836888951387`*^9, 3.5883166150022755`*^9, 
   3.58831884340579*^9, 3.588319019654899*^9, 3.588319169103162*^9, 
   3.58832582690524*^9, 3.5883259581950703`*^9, 3.588326916568154*^9, 
   3.5883278599496107`*^9, 3.5883279291201324`*^9, 3.58832801908549*^9, 
   3.588328473451888*^9, 3.5883285575984364`*^9, 3.5883293969589105`*^9, {
   3.5883296804114084`*^9, 3.5883297039674497`*^9}, 3.5883299122268143`*^9, 
   3.6151308259068594`*^9, 3.6151310080736837`*^9, 3.6190891659400873`*^9, 
   3.6196262153591576`*^9, 3.6205425715085783`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"FormatTexBasis", "[", 
  RowBox[{
   RowBox[{"PDB4", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "B4"}]}], "}"}], "]"}], ",", "\"\<\\\\partial_r\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5831488113384504`*^9, 3.58314882837368*^9}, {
   3.58314886270934*^9, 3.58314887952617*^9}, 3.58314981838122*^9, {
   3.5831500264543853`*^9, 3.583150032756796*^9}, {3.5831501469489965`*^9, 
   3.5831501479005985`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "PDBasisExpr"}]], "Input",
 CellChangeTimes->{{3.583147037051734*^9, 3.583147040015739*^9}, 
   3.5831488906021895`*^9, {3.5831490114244013`*^9, 3.583149013343205*^9}, 
   3.583149815682415*^9, 3.5831502599399953`*^9}],

Cell[BoxData["\<\"\\\\partial_r\\\\tau^{b}{}_{c}\"\>"], "Output",
 CellChangeTimes->{{3.583147040202939*^9, 3.583147066332985*^9}, {
   3.5831473701289186`*^9, 3.5831474248070145`*^9}, 3.583147462262681*^9, 
   3.583148892739393*^9, 3.583149013592806*^9, 3.583149934133423*^9, {
   3.5831500192159724`*^9, 3.583150037811205*^9}, {3.5831501513326044`*^9, 
   3.583150172611042*^9}, 3.583150223576331*^9, 3.583150271936416*^9, {
   3.5879651835078597`*^9, 3.587965203912696*^9}, 3.5880798727176285`*^9, 
   3.588079956193375*^9, 3.5880832965076494`*^9, 3.588083688926338*^9, 
   3.5883166150178757`*^9, 3.58831884343699*^9, 3.588319019686099*^9, 
   3.588319169134362*^9, 3.5883258269208403`*^9, 3.5883259582106705`*^9, 
   3.5883269165837536`*^9, 3.588327859965211*^9, 3.5883279291357327`*^9, 
   3.5883280191010904`*^9, 3.5883284734674883`*^9, 3.588328557614036*^9, 
   3.58832939697451*^9, {3.5883296804270086`*^9, 3.58832970398305*^9}, 
   3.5883299122424145`*^9, 3.615130825926859*^9, 3.6151310080736837`*^9, 
   3.6190891659500875`*^9, 3.619626215369158*^9, 3.620542571518578*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"FormatTexBasis", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "B4"}]}], "}"}], ",", "\"\<\\\\partial_r\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.583149876631722*^9, 3.5831498867717395`*^9}, {
  3.5831500420232124`*^9, 3.5831500813820815`*^9}}],

Cell[BoxData[
 RowBox[{"FormatTexBasis", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "B4"}], "}"}], ",", "\"\<dr\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.583149876631722*^9, 3.5831498867717395`*^9}, {
  3.5831500420232124`*^9, 3.583150065126853*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Basis", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "B4"}]}], "}"}], ",", "a"}], "]"}]], "Input",
 CellChangeTimes->{{3.5831489205230417`*^9, 3.583148935405468*^9}, {
  3.583149840704859*^9, 3.5831498672717056`*^9}}],

Cell[BoxData[
 InterpretationBox[
  StyleBox[GridBox[{
     {"e", 
      StyleBox[GridBox[{
         {" ", "a"},
         {
          StyleBox["1",
           FontColor->RGBColor[1., 0., 0.]], " "}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.], {
             Offset[0.034999999999999996`]}, 
            Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
             Offset[0.]}}, "RowsIndexed" -> {}}],
       FontSize->Rational[39, 4]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.034999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   ShowAutoStyles->False,
   AutoSpacing->False],
  xAct`xTensor`Basis[{1, -$CellContext`B4}, $CellContext`a],
  Editable->False]], "Output",
 CellChangeTimes->{{3.5831498460868683`*^9, 3.5831498676149063`*^9}, 
   3.583149954678659*^9, 3.583150019231572*^9, 3.5831500502288265`*^9, 
   3.583150084408487*^9, 3.5831501726266418`*^9, 3.5831502235919313`*^9, 
   3.5831502719520164`*^9, {3.5879651835234594`*^9, 3.5879652039438953`*^9}, 
   3.5880798728580284`*^9, 3.588079956208975*^9, 3.588083301484058*^9, 
   3.5880836889575386`*^9, 3.5883166150490756`*^9, 3.58831884345259*^9, 
   3.5883190197016993`*^9, 3.5883191691655617`*^9, 3.58832582693644*^9, 
   3.5883259582262707`*^9, 3.588326916599354*^9, 3.588327859980811*^9, 
   3.5883279291513324`*^9, 3.5883280191166906`*^9, 3.5883284734830885`*^9, 
   3.5883285576296363`*^9, 3.5883293970057106`*^9, {3.588329680458208*^9, 
   3.5883297039986496`*^9}, 3.5883299122580147`*^9, 3.615130825936859*^9, 
   3.615131008089284*^9, 3.619089165960088*^9, 3.619626215379158*^9, 
   3.620542571628578*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellChangeTimes->{{3.58314893649747*^9, 3.583148938104273*^9}}],

Cell[BoxData["\<\"\\\\partial_r^{a}\"\>"], "Output",
 CellChangeTimes->{
  3.583148938275873*^9, 3.5831490201448174`*^9, 3.5831491395786266`*^9, 
   3.583149868160907*^9, 3.583149955786261*^9, 3.5831500192471724`*^9, 
   3.5831500506812277`*^9, 3.583150085001288*^9, 3.5831501726578417`*^9, 
   3.5831502236075315`*^9, 3.583150271967616*^9, {3.5879651835390596`*^9, 
   3.5879652039594955`*^9}, 3.5880798728736286`*^9, 3.588079956224575*^9, 
   3.588083301515258*^9, 3.588083688988738*^9, 3.5883166150490756`*^9, 
   3.58831884346819*^9, 3.5883190197328997`*^9, 3.588319169196762*^9, 
   3.5883258269520397`*^9, 3.588325958241871*^9, 3.588326916614954*^9, 
   3.588327859996411*^9, 3.588327929166932*^9, 3.5883280191322904`*^9, 
   3.5883284734986887`*^9, 3.5883285576452365`*^9, 3.5883293970057106`*^9, {
   3.588329680458208*^9, 3.58832970401425*^9}, 3.588329912273615*^9, 
   3.6151308259468594`*^9, 3.615131008089284*^9, 3.6190891659700875`*^9, 
   3.619626215379158*^9, 3.620542571628578*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Basis", "[", 
  RowBox[{
   RowBox[{"-", "a"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "B4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5831489205230417`*^9, 3.583148935405468*^9}, {
  3.583149840704859*^9, 3.5831498672717056`*^9}, {3.5831500926921015`*^9, 
  3.5831501001801147`*^9}}],

Cell[BoxData[
 InterpretationBox[
  StyleBox[GridBox[{
     {"e", 
      StyleBox[GridBox[{
         {" ", 
          StyleBox["1",
           FontColor->RGBColor[1., 0., 0.]]},
         {"a", " "}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.], {
             Offset[0.034999999999999996`]}, 
            Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
             Offset[0.]}}, "RowsIndexed" -> {}}],
       FontSize->Rational[39, 4]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.034999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   ShowAutoStyles->False,
   AutoSpacing->False],
  xAct`xTensor`Basis[-$CellContext`a, {1, $CellContext`B4}],
  Editable->False]], "Output",
 CellChangeTimes->{{3.5831498460868683`*^9, 3.5831498676149063`*^9}, 
   3.583149954678659*^9, 3.583150019231572*^9, 3.5831500502288265`*^9, {
   3.583150084408487*^9, 3.583150100414115*^9}, 3.5831501726578417`*^9, 
   3.5831502236231318`*^9, 3.583150271967616*^9, {3.58796518355466*^9, 
   3.5879652039750957`*^9}, 3.588079872889229*^9, 3.5880799562401752`*^9, 
   3.588083301530858*^9, 3.5880836890199385`*^9, 3.588316615064676*^9, 
   3.58831884348379*^9, 3.5883190197485*^9, 3.588319169227962*^9, 
   3.58832582696764*^9, 3.588325958241871*^9, 3.588326916614954*^9, 
   3.588327859996411*^9, 3.588327929166932*^9, 3.58832801914789*^9, 
   3.5883284734986887`*^9, 3.5883285576452365`*^9, 3.588329397021311*^9, {
   3.5883296804738083`*^9, 3.58832970402985*^9}, 3.5883299122892146`*^9, 
   3.615130825956859*^9, 3.615131008089284*^9, 3.6190891659800873`*^9, 
   3.619626215389158*^9, 3.6205425716385784`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellChangeTimes->{{3.58314893649747*^9, 3.583148938104273*^9}}],

Cell[BoxData["\<\"dr_{a}\"\>"], "Output",
 CellChangeTimes->{
  3.583148938275873*^9, 3.5831490201448174`*^9, 3.5831491395786266`*^9, 
   3.583149868160907*^9, 3.583149955786261*^9, 3.5831500192471724`*^9, 
   3.5831500506812277`*^9, {3.583150085001288*^9, 3.583150101396917*^9}, 
   3.583150172673442*^9, 3.5831502236387315`*^9, 3.5831502719832163`*^9, {
   3.58796518355466*^9, 3.587965203990696*^9}, 3.588079872904829*^9, 
   3.5880799562401752`*^9, 3.5880833015464582`*^9, 3.5880836890355387`*^9, 
   3.5883166150802755`*^9, 3.58831884351499*^9, 3.5883190197640996`*^9, 
   3.5883191692435617`*^9, 3.58832582696764*^9, 3.5883259582574706`*^9, 
   3.588326916630554*^9, 3.5883278600120106`*^9, 3.5883279291825323`*^9, 
   3.58832801914789*^9, 3.5883284735142884`*^9, 3.588328557660836*^9, 
   3.5883293970369105`*^9, {3.5883296804894085`*^9, 3.58832970402985*^9}, 
   3.5883299122892146`*^9, 3.615130825956859*^9, 3.615131008104884*^9, 
   3.6190891659900875`*^9, 3.6196262153991575`*^9, 3.620542571648578*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"\[Lambda]", "[", "]"}], ",", "M4"}], "]"}]], "Input",
 CellChangeTimes->{{3.5446036610339346`*^9, 3.5446036644971323`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"\[Lambda]", "[", "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", xAct`xTensor`DefTensor, ": Defining ", "tensor ", 
   $CellContext`\[Lambda][], ". ", ""],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.587965203990696*^9, 3.5880798729204288`*^9, 3.5880799562557755`*^9, 
   3.588083328971306*^9, 3.588083689051139*^9, 3.5883166150958757`*^9, 
   3.58831884353059*^9, 3.5883190197796993`*^9, 3.588319169274762*^9, 
   3.58832582698324*^9, 3.5883259582730703`*^9, 3.588326916646154*^9, 
   3.588327860027611*^9, 3.5883279291981325`*^9, 3.5883280191634903`*^9, 
   3.588328473529888*^9, 3.5883285576764364`*^9, 3.5883293970525107`*^9, {
   3.588329680520609*^9, 3.58832970404545*^9}, 3.5883299123048143`*^9, 
   3.615130825966859*^9, 3.615131008104884*^9, 3.6190891659900875`*^9, 
   3.6196262154091578`*^9, 3.620542571648578*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", 
   RowBox[{"Sqrt", "[", "2", "]"}]}], 
  RowBox[{"T", "[", 
   RowBox[{
    RowBox[{"-", "a"}], ",", 
    RowBox[{"-", "b"}], ",", 
    RowBox[{"-", "c"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  InterpretationBox[
   StyleBox[GridBox[{
      {"\[Tau]", 
       StyleBox[GridBox[{
          {" ", " ", " "},
          {"a", "b", "c"}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.], {
              Offset[0.034999999999999996`]}, 
             Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
              Offset[0.]}}, "RowsIndexed" -> {}}],
        FontSize->Rational[39, 4]]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.034999999999999996`]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`T[-$CellContext`a, -$CellContext`b, -$CellContext`c],
   Editable->False], 
  SqrtBox["2"]]], "Output",
 CellChangeTimes->{
  3.5823477961075172`*^9, 3.582353854567251*^9, 3.5823539674200563`*^9, 
   3.5831307207822227`*^9, 3.583133040834898*^9, 3.583133120800638*^9, 
   3.5831331957597704`*^9, 3.5831333024171576`*^9, 3.5831333344284134`*^9, 
   3.583135199241089*^9, 3.5831353247589097`*^9, 3.583138084358957*^9, 
   3.583138208785775*^9, 3.583146622496606*^9, 3.5831501727046423`*^9, 
   3.5831502236699314`*^9, 3.5831502720144167`*^9, {3.58796518358586*^9, 
   3.5879652040062957`*^9}, 3.5880798729360285`*^9, 3.588079956271375*^9, 
   3.5880833290493064`*^9, 3.588083689082339*^9, 3.588316615111476*^9, 
   3.5883188435461903`*^9, 3.5883190197952995`*^9, 3.588319169290362*^9, 
   3.5883258269988403`*^9, 3.5883259582886705`*^9, 3.5883269166617537`*^9, 
   3.588327860043211*^9, 3.5883279292137327`*^9, 3.5883280191790905`*^9, 
   3.588328473529888*^9, 3.5883285576764364`*^9, 3.5883293970525107`*^9, {
   3.5883296805362086`*^9, 3.58832970406105*^9}, 3.5883299123204145`*^9, 
   3.615130825976859*^9, 3.615131008104884*^9, 3.6190891660000877`*^9, 
   3.619626215419158*^9, 3.6205425716985784`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellChangeTimes->{{3.5446036936778016`*^9, 3.544603695958932*^9}}],

Cell[BoxData["\<\"\\\\tfrac{1}{\\\\sqrt{2}}\\\\tau_{abc}\"\>"], "Output",
 CellChangeTimes->{
  3.5823477961231174`*^9, 3.5823538545828514`*^9, 3.5823539674356565`*^9, 
   3.583130720797823*^9, 3.583133040850498*^9, 3.5831331208162384`*^9, 
   3.58313319577537*^9, 3.5831333024327574`*^9, 3.5831333344440136`*^9, 
   3.5831351992722893`*^9, 3.5831353247745094`*^9, 3.5831380845305567`*^9, 
   3.5831382088013754`*^9, 3.5831466225122056`*^9, 3.583150172720242*^9, 
   3.5831502236855316`*^9, 3.5831502720300164`*^9, {3.58796518360146*^9, 
   3.5879652040218954`*^9}, 3.5880798729516287`*^9, 3.588079956286975*^9, 
   3.5880833290805063`*^9, 3.588083689285139*^9, 3.588316615127076*^9, 
   3.58831884356179*^9, 3.5883190198108997`*^9, 3.5883191693215623`*^9, 
   3.58832582701444*^9, 3.5883259583042707`*^9, 3.5883269166617537`*^9, 
   3.588327860058811*^9, 3.5883279292293324`*^9, 3.5883280191946907`*^9, 
   3.5883284735454884`*^9, 3.5883285576920366`*^9, 3.5883293970681105`*^9, {
   3.5883296805518084`*^9, 3.5883297040766497`*^9}, 3.5883299123360147`*^9, 
   3.6151308259868593`*^9, 3.6151310081204844`*^9, 3.6190891660100875`*^9, 
   3.619626215419158*^9, 3.6205425716985784`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", "3"}], 
  RowBox[{"Sqrt", "[", "2", "]"}], 
  RowBox[{"\[Lambda]", "[", "]"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SqrtBox["2"], " ", 
   InterpretationBox[
    StyleBox["\[Lambda]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[Lambda][],
    Editable->False]}], "3"]], "Output",
 CellChangeTimes->{
  3.5823477961699176`*^9, 3.582353854598451*^9, 3.5823539674512568`*^9, 
   3.583130720813423*^9, 3.583133040866098*^9, 3.5831331208318386`*^9, 
   3.58313319577537*^9, 3.5831333024483576`*^9, 3.583133334459614*^9, 
   3.5831351992722893`*^9, 3.5831353247901096`*^9, 3.583138084546157*^9, 
   3.5831382088169756`*^9, 3.5831466225278053`*^9, 3.5831501727358418`*^9, 
   3.5831502236855316`*^9, 3.583150272045616*^9, {3.58796518360146*^9, 
   3.5879652040374956`*^9}, 3.5880798729516287`*^9, 3.588079956302575*^9, 
   3.5880833291117067`*^9, 3.5880836893163395`*^9, 3.5883166151426764`*^9, 
   3.5883188435773897`*^9, 3.5883190198420997`*^9, 3.588319169352762*^9, 
   3.58832582701444*^9, 3.5883259583042707`*^9, 3.588326916677354*^9, 
   3.588327860058811*^9, 3.5883279292293324`*^9, 3.5883280191946907`*^9, 
   3.5883284735610886`*^9, 3.5883285577076364`*^9, 3.5883293970837107`*^9, {
   3.5883296805674086`*^9, 3.5883297040766497`*^9}, 3.588329912351615*^9, 
   3.6151308259968596`*^9, 3.6151310081204844`*^9, 3.6190891660100875`*^9, 
   3.6196262154291577`*^9, 3.620542571708578*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"2", "+", 
    RowBox[{"\[Lambda]", "[", "]"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    RowBox[{"\[Lambda]", "[", "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.544608577367132*^9, 3.544608608952939*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", "+", 
   InterpretationBox[
    StyleBox["\[Lambda]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[Lambda][],
    Editable->False]}], 
  RowBox[{"1", "+", 
   InterpretationBox[
    StyleBox["\[Lambda]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[Lambda][],
    Editable->False]}]]], "Output",
 CellChangeTimes->{
  3.5823477961855173`*^9, 3.582353854614051*^9, 3.582353967466857*^9, 
   3.5831307208290234`*^9, 3.5831330408816977`*^9, 3.5831331208318386`*^9, 
   3.58313319579097*^9, 3.583133302463958*^9, 3.583133334475214*^9, 
   3.583135199303489*^9, 3.58313532480571*^9, 3.583138084561757*^9, 
   3.5831382088169756`*^9, 3.5831466225434055`*^9, 3.583150172751442*^9, 
   3.583150223701132*^9, 3.583150272045616*^9, {3.5879651836170597`*^9, 
   3.587965204053096*^9}, 3.588079872967229*^9, 3.588079956302575*^9, 
   3.588083329142906*^9, 3.588083689331939*^9, 3.588316615158276*^9, 
   3.58831884359299*^9, 3.5883190198576994`*^9, 3.5883191693683624`*^9, 
   3.58832582703004*^9, 3.588325958319871*^9, 3.588326916692954*^9, 
   3.5883278600744114`*^9, 3.588327929244932*^9, 3.588328019210291*^9, 
   3.5883284735610886`*^9, 3.588328557723236*^9, 3.588329397099311*^9, {
   3.5883296805674086`*^9, 3.58832970409225*^9}, 3.588329912351615*^9, 
   3.6151308259968596`*^9, 3.6151310081204844`*^9, 3.6190891660100875`*^9, 
   3.619626215439158*^9, 3.620542571708578*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input"],

Cell[BoxData["\<\"\\\\frac{2 + \\\\lambda}{1 + \\\\lambda}\"\>"], "Output",
 CellChangeTimes->{
  3.5823477962011175`*^9, 3.5823538546764517`*^9, 3.5823539674980564`*^9, 
   3.5831307208290234`*^9, 3.583133040897298*^9, 3.583133120847439*^9, 
   3.58313319580657*^9, 3.5831333024795575`*^9, 3.583133334490814*^9, 
   3.583135199319089*^9, 3.5831353248213096`*^9, 3.583138084951758*^9, 
   3.583138208848175*^9, 3.5831466225590057`*^9, 3.583150172767042*^9, 
   3.5831502237167315`*^9, 3.5831502720612164`*^9, {3.58796518363266*^9, 
   3.587965204068696*^9}, 3.588079872982829*^9, 3.5880799563181753`*^9, 
   3.5880833291741066`*^9, 3.588083689394339*^9, 3.588316615158276*^9, 
   3.58831884360859*^9, 3.5883190198732996`*^9, 3.5883191693995624`*^9, 
   3.58832582704564*^9, 3.588325958335471*^9, 3.5883269167085543`*^9, 
   3.588327860090011*^9, 3.5883279292605324`*^9, 3.5883280192258906`*^9, 
   3.588328473576689*^9, 3.5883285577388363`*^9, 3.588329397114911*^9, {
   3.588329680583009*^9, 3.58832970410785*^9}, 3.588329912367215*^9, 
   3.6151308260068593`*^9, 3.615131008136084*^9, 3.6190891660200877`*^9, 
   3.6196262154491577`*^9, 3.6205425717185783`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"$TexFractionAsFraction", "=", "False"}], "}"}], ",", 
   RowBox[{"TexPrint", "[", "%%", "]"}]}], "]"}]], "Input"],

Cell[BoxData["\<\"(1 + \\\\lambda)^{-1} (2 + \\\\lambda)\"\>"], "Output",
 CellChangeTimes->{
  3.582347796232318*^9, 3.582353854692052*^9, 3.5823539675136566`*^9, 
   3.583130720844623*^9, 3.583133040912898*^9, 3.5831331208630385`*^9, 
   3.5831331958221703`*^9, 3.5831333024951577`*^9, 3.583133334506414*^9, 
   3.583135199334689*^9, 3.5831353248525095`*^9, 3.583138085123358*^9, 
   3.583138208848175*^9, 3.5831466225590057`*^9, 3.583150172782642*^9, 
   3.5831502237323313`*^9, 3.5831502720768166`*^9, {3.58796518364826*^9, 
   3.5879652040842957`*^9}, 3.588079872998429*^9, 3.5880799563337755`*^9, 
   3.5880833292053065`*^9, 3.588083689425539*^9, 3.588316615173876*^9, 
   3.5883188436241903`*^9, 3.5883190198889*^9, 3.5883191694307623`*^9, 
   3.58832582706124*^9, 3.588325958351071*^9, 3.5883269167085543`*^9, 
   3.588327860105611*^9, 3.5883279292605324`*^9, 3.5883280192414904`*^9, 
   3.5883284735922885`*^9, 3.5883285577388363`*^9, 3.588329397114911*^9, {
   3.588329680598609*^9, 3.58832970410785*^9}, 3.588329912382815*^9, 
   3.615130826016859*^9, 3.615131008136084*^9, 3.6190891660200877`*^9, 
   3.6196262154491577`*^9, 3.6205425717285786`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"1", "/", "3"}], "/", 
   RowBox[{"Sqrt", "[", "2", "]"}]}], "*", 
  RowBox[{"\[Lambda]", "[", "]"}]}]], "Input",
 CellChangeTimes->{3.544608362872864*^9}],

Cell[BoxData[
 FractionBox[
  InterpretationBox[
   StyleBox["\[Lambda]",
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`\[Lambda][],
   Editable->False], 
  RowBox[{"3", " ", 
   SqrtBox["2"]}]]], "Output",
 CellChangeTimes->{
  3.5823477962479177`*^9, 3.5823538547076516`*^9, 3.582353967529257*^9, 
   3.5831307208602233`*^9, 3.5831330409284983`*^9, 3.5831331208786383`*^9, 
   3.5831331958221703`*^9, 3.5831333025107574`*^9, 3.583133334506414*^9, 
   3.5831351993502893`*^9, 3.5831353248525095`*^9, 3.583138085138958*^9, 
   3.5831382088637753`*^9, 3.583146622574606*^9, 3.583150172782642*^9, 
   3.5831502237479315`*^9, 3.5831502720924163`*^9, {3.5879651836638603`*^9, 
   3.587965204099896*^9}, 3.5880798730140285`*^9, 3.5880799563493752`*^9, 
   3.5880833292365065`*^9, 3.5880836894567394`*^9, 3.588316615189476*^9, 
   3.5883188436397905`*^9, 3.5883190199045*^9, 3.5883191694463625`*^9, 
   3.58832582706124*^9, 3.588325958351071*^9, 3.588326916724154*^9, 
   3.588327860105611*^9, 3.5883279292761326`*^9, 3.5883280192414904`*^9, 
   3.5883284736078887`*^9, 3.5883285577544365`*^9, 3.588329397130511*^9, {
   3.5883296806142087`*^9, 3.5883297041234503`*^9}, 3.5883299123984146`*^9, 
   3.615130826016859*^9, 3.615131008136084*^9, 3.619089166090088*^9, 
   3.619626215459158*^9, 3.6205425717285786`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input"],

Cell[BoxData["\<\"\\\\tfrac{1}{3 \\\\sqrt{2}}\\\\lambda\"\>"], "Output",
 CellChangeTimes->{
  3.5823477962635174`*^9, 3.5823538547232513`*^9, 3.582353967544857*^9, 
   3.583130720875823*^9, 3.5831330409440985`*^9, 3.5831331208942385`*^9, 
   3.5831331958377705`*^9, 3.5831333025263577`*^9, 3.5831333345220137`*^9, 
   3.5831351993658895`*^9, 3.58313532488371*^9, 3.5831380853105583`*^9, 
   3.5831382088793755`*^9, 3.583146622590206*^9, 3.583150172798242*^9, 
   3.583150223779132*^9, 3.5831502721080165`*^9, {3.5879651836638603`*^9, 
   3.5879652041154957`*^9}, 3.5880798730140285`*^9, 3.588079956364975*^9, 
   3.588083329267707*^9, 3.5880836894879394`*^9, 3.588316615205076*^9, 
   3.5883188436553903`*^9, 3.5883190199200997`*^9, 3.5883191694775624`*^9, 
   3.5883258270768404`*^9, 3.5883259583666706`*^9, 3.5883269167397537`*^9, 
   3.588327860121211*^9, 3.588327929291733*^9, 3.5883280192570906`*^9, 
   3.5883284736078887`*^9, 3.5883285577700367`*^9, 3.5883293971461105`*^9, {
   3.5883296806142087`*^9, 3.58832970413905*^9}, 3.5883299123984146`*^9, 
   3.6151308260268593`*^9, 3.615131008136084*^9, 3.619089166100088*^9, 
   3.619626215469158*^9, 3.6205425717385783`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"Sqrt", "[", "2", "]"}]}], "/", 
   RowBox[{"\[Lambda]", "[", "]"}]}], "/", "3"}]], "Input",
 CellChangeTimes->{{3.5446037293248405`*^9, 3.5446037343081255`*^9}, {
   3.544603775909505*^9, 3.5446037779386206`*^9}, {3.544603901778704*^9, 
   3.54460393876782*^9}, 3.544605084612358*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   SqrtBox["2"], 
   RowBox[{"3", " ", 
    InterpretationBox[
     StyleBox["\[Lambda]",
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[Lambda][],
     Editable->False]}]]}]], "Output",
 CellChangeTimes->{
  3.5823477962791176`*^9, 3.5823538547388515`*^9, 3.5823539675604568`*^9, 
   3.583130720875823*^9, 3.583133040959698*^9, 3.5831331208942385`*^9, 
   3.5831331958533707`*^9, 3.583133302541958*^9, 3.583133334537614*^9, 
   3.5831351993814898`*^9, 3.58313532489931*^9, 3.583138085372958*^9, 
   3.5831382088949757`*^9, 3.583146622605806*^9, 3.583150172813842*^9, 
   3.5831502237947316`*^9, 3.5831502721236167`*^9, {3.58796518367946*^9, 
   3.587965204131096*^9}, 3.5880798730296288`*^9, 3.588079956364975*^9, 
   3.588083329298907*^9, 3.588083689503539*^9, 3.588316615220676*^9, 
   3.58831884368659*^9, 3.5883190199356995`*^9, 3.5883191695087624`*^9, 
   3.58832582709244*^9, 3.588325958382271*^9, 3.5883269167397537`*^9, 
   3.5883278601368113`*^9, 3.588327929307333*^9, 3.588328019272691*^9, 
   3.588328473623489*^9, 3.5883285577700367`*^9, 3.5883293971617107`*^9, {
   3.588329680629809*^9, 3.58832970413905*^9}, 3.588329912414015*^9, 
   3.6151308260368595`*^9, 3.615131008151684*^9, 3.619089166100088*^9, 
   3.619626215479158*^9, 3.6205425717385783`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input"],

Cell[BoxData["\<\"- \\\\frac{\\\\sqrt{2}}{3 \\\\lambda}\"\>"], "Output",
 CellChangeTimes->{
  3.582347796294718*^9, 3.5823538547544518`*^9, 3.582353967622857*^9, 
   3.583130720891423*^9, 3.5831330409752984`*^9, 3.5831331209098387`*^9, 
   3.5831331958533707`*^9, 3.583133302557558*^9, 3.583133334553214*^9, 
   3.5831351993970895`*^9, 3.5831353249149103`*^9, 3.583138085528959*^9, 
   3.5831382088949757`*^9, 3.583146622605806*^9, 3.583150172845042*^9, 
   3.5831502238103313`*^9, 3.5831502721236167`*^9, {3.58796518369506*^9, 
   3.587965204146696*^9}, 3.588079873045229*^9, 3.588079956380575*^9, 
   3.5880833293301067`*^9, 3.5880836895347395`*^9, 3.5883166152362757`*^9, 
   3.5883188437021904`*^9, 3.5883190199512997`*^9, 3.5883191695243626`*^9, 
   3.58832582709244*^9, 3.588325958397871*^9, 3.588326916755354*^9, 
   3.5883278601524115`*^9, 3.588327929307333*^9, 3.588328019272691*^9, 
   3.588328473623489*^9, 3.5883285577856364`*^9, 3.588329397177311*^9, {
   3.5883296806454086`*^9, 3.5883297041546497`*^9}, 3.588329912429615*^9, 
   3.6151308260368595`*^9, 3.615131008151684*^9, 3.619089166110088*^9, 
   3.6196262154891577`*^9, 3.620542571748578*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"$TexFractionAsFraction", "=", "False"}], "}"}], ",", 
   RowBox[{"TexPrint", "[", "%%", "]"}]}], "]"}]], "Input"],

Cell[BoxData["\<\"- \\\\tfrac{1}{3} \\\\sqrt{2} \\\\lambda^{-1}\"\>"], \
"Output",
 CellChangeTimes->{
  3.582347796310318*^9, 3.582353854770052*^9, 3.582353967638457*^9, 
   3.5831307209070234`*^9, 3.583133040990898*^9, 3.583133120925439*^9, 
   3.5831331958689704`*^9, 3.583133302573158*^9, 3.5831333345688143`*^9, 
   3.5831351994126897`*^9, 3.58313532493051*^9, 3.583138085700559*^9, 
   3.583138208910576*^9, 3.583146622621406*^9, 3.5831501728606424`*^9, 
   3.5831502238259315`*^9, 3.5831502721392164`*^9, {3.58796518371066*^9, 
   3.5879652041622963`*^9}, 3.588079873060829*^9, 3.5880799563961754`*^9, 
   3.588083329376907*^9, 3.5880836895503397`*^9, 3.588316615251876*^9, 
   3.5883188437177906`*^9, 3.5883190199825*^9, 3.5883191695555625`*^9, 
   3.58832582710804*^9, 3.588325958397871*^9, 3.588326916770954*^9, 
   3.5883278601524115`*^9, 3.5883279293229327`*^9, 3.588328019288291*^9, 
   3.5883284736390886`*^9, 3.588328557801236*^9, 3.588329397177311*^9, {
   3.588329680661009*^9, 3.58832970417025*^9}, 3.5883299124452147`*^9, 
   3.6151308260468593`*^9, 3.615131008151684*^9, 3.619089166110088*^9, 
   3.6196262154891577`*^9, 3.620542571748578*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", 
   RowBox[{"\[Lambda]", "[", "]"}]}], "/", "3"}]], "Input",
 CellChangeTimes->{3.5446044193493075`*^9}],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"3", " ", 
   InterpretationBox[
    StyleBox["\[Lambda]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[Lambda][],
    Editable->False]}]]], "Output",
 CellChangeTimes->{
  3.582347796325918*^9, 3.5823538548012514`*^9, 3.5823539676540565`*^9, 
   3.583130720922623*^9, 3.5831330410064983`*^9, 3.583133120941039*^9, 
   3.58313319588457*^9, 3.583133302573158*^9, 3.583133334584414*^9, 
   3.5831351994282894`*^9, 3.58313532494611*^9, 3.583138085716159*^9, 
   3.5831382089261756`*^9, 3.583146622637006*^9, 3.5831501728606424`*^9, 
   3.5831502238259315`*^9, 3.5831502721548166`*^9, {3.58796518371066*^9, 
   3.5879652041622963`*^9}, 3.588079873076429*^9, 3.5880799564117756`*^9, 
   3.588083329408107*^9, 3.58808368956594*^9, 3.588316615267476*^9, 
   3.5883188437333903`*^9, 3.5883190199981003`*^9, 3.588319169586763*^9, 
   3.58832582712364*^9, 3.5883259584134707`*^9, 3.588326916770954*^9, 
   3.588327860168011*^9, 3.5883279293385324`*^9, 3.5883280193038907`*^9, 
   3.588328473654689*^9, 3.588328557801236*^9, 3.588329397192911*^9, {
   3.588329680661009*^9, 3.58832970418585*^9}, 3.5883299124452147`*^9, 
   3.615130826056859*^9, 3.615131008151684*^9, 3.6190891661200876`*^9, 
   3.619626215499158*^9, 3.6205425717585783`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input"],

Cell[BoxData["\<\"\\\\frac{1}{3 \\\\lambda}\"\>"], "Output",
 CellChangeTimes->{
  3.582347796341518*^9, 3.5823538548168516`*^9, 3.582353967685257*^9, 
   3.583130720922623*^9, 3.5831330410220985`*^9, 3.583133120941039*^9, 
   3.58313319588457*^9, 3.5831333025887575`*^9, 3.583133334584414*^9, 
   3.5831351994438896`*^9, 3.58313532496171*^9, 3.583138085887759*^9, 
   3.5831382089417753`*^9, 3.583146622652606*^9, 3.5831501728762426`*^9, 
   3.5831502238415318`*^9, 3.583150272170417*^9, {3.58796518372626*^9, 
   3.587965204177896*^9}, 3.588079873076429*^9, 3.5880799564273753`*^9, 
   3.588083329439307*^9, 3.5880836895971394`*^9, 3.588316615267476*^9, 
   3.58831884374899*^9, 3.5883190200137*^9, 3.588319169617963*^9, 
   3.58832582712364*^9, 3.5883259584290705`*^9, 3.5883269167865543`*^9, 
   3.588327860183611*^9, 3.5883279293385324`*^9, 3.5883280193038907`*^9, 
   3.588328473654689*^9, 3.5883285578168364`*^9, 3.588329397208511*^9, {
   3.588329680676609*^9, 3.58832970418585*^9}, 3.5883299124608145`*^9, 
   3.615130826056859*^9, 3.615131008167284*^9, 3.6190891661200876`*^9, 
   3.619626215509158*^9, 3.6205425717685785`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"1", "/", 
    RowBox[{"\[Lambda]", "[", "]"}]}], "/", "3"}], "/", 
  RowBox[{"Sqrt", "[", "2", "]"}]}]], "Input",
 CellChangeTimes->{
  3.5446044193493075`*^9, {3.544604931472599*^9, 3.5446049333707075`*^9}}],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"3", " ", 
   SqrtBox["2"], " ", 
   InterpretationBox[
    StyleBox["\[Lambda]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[Lambda][],
    Editable->False]}]]], "Output",
 CellChangeTimes->{
  3.5823477963571177`*^9, 3.5823538548480515`*^9, 3.582353967700857*^9, 
   3.583130720938223*^9, 3.5831330410376987`*^9, 3.583133120956639*^9, 
   3.5831331959001703`*^9, 3.5831333026043577`*^9, 3.5831333346000137`*^9, 
   3.58313519945949*^9, 3.58313532497731*^9, 3.5831380859033594`*^9, 
   3.5831382089417753`*^9, 3.583146622652606*^9, 3.5831501728918424`*^9, 
   3.583150223857132*^9, 3.583150272186017*^9, {3.58796518374186*^9, 
   3.5879652041934958`*^9}, 3.588079873092029*^9, 3.5880799564273753`*^9, 
   3.5880833294705067`*^9, 3.5880836896127396`*^9, 3.5883166152830763`*^9, 
   3.5883188437645903`*^9, 3.5883190200292997`*^9, 3.588319169633563*^9, 
   3.5883258271392403`*^9, 3.5883259584290705`*^9, 3.5883269168021545`*^9, 
   3.588327860183611*^9, 3.5883279293541327`*^9, 3.588328019319491*^9, 
   3.588328473670289*^9, 3.5883285578324366`*^9, 3.588329397224111*^9, {
   3.588329680692209*^9, 3.5883297042014503`*^9}, 3.5883299124764147`*^9, 
   3.6151308260668592`*^9, 3.615131008167284*^9, 3.619089166130088*^9, 
   3.619626215509158*^9, 3.6205425717685785`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input"],

Cell[BoxData["\<\"\\\\frac{1}{3 \\\\sqrt{2} \\\\lambda}\"\>"], "Output",
 CellChangeTimes->{
  3.582347796372718*^9, 3.5823538548636518`*^9, 3.582353967716457*^9, 
   3.583130720953823*^9, 3.5831330410532985`*^9, 3.5831331209722385`*^9, 
   3.5831331959157705`*^9, 3.583133302619958*^9, 3.583133334615614*^9, 
   3.5831351995998898`*^9, 3.58313532499291*^9, 3.5831380860749598`*^9, 
   3.5831382089573755`*^9, 3.583146622668206*^9, 3.583150172907442*^9, 
   3.5831502238727317`*^9, 3.583150272186017*^9, {3.58796518375746*^9, 
   3.587965204209096*^9}, 3.588079873107629*^9, 3.588079956442975*^9, 
   3.588083329501707*^9, 3.58808368962834*^9, 3.5883166152986765`*^9, 
   3.5883188437801905`*^9, 3.5883190200449*^9, 3.5883191696803627`*^9, 
   3.5883258271548405`*^9, 3.5883259584446707`*^9, 3.5883269168177547`*^9, 
   3.588327860199211*^9, 3.588327929369733*^9, 3.5883280193350906`*^9, 
   3.588328473685889*^9, 3.5883285578324366`*^9, 3.588329397239711*^9, {
   3.5883296807078085`*^9, 3.5883297042170506`*^9}, 3.5883299124764147`*^9, 
   3.6151308260768595`*^9, 3.615131008167284*^9, 3.619089166130088*^9, 
   3.619626215519158*^9, 3.6205425717785783`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", "3"}], "/", 
  RowBox[{"Sqrt", "[", "2", "]"}]}]], "Input",
 CellChangeTimes->{{3.5446049498616514`*^9, 3.544604950404682*^9}}],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"3", " ", 
   SqrtBox["2"]}]]], "Output",
 CellChangeTimes->{
  3.582347796388318*^9, 3.5823538548792515`*^9, 3.582353967732057*^9, 
   3.583130720953823*^9, 3.583133041068898*^9, 3.5831331209722385`*^9, 
   3.5831331959313707`*^9, 3.583133302635558*^9, 3.583133334631214*^9, 
   3.58313519961549*^9, 3.58313532500851*^9, 3.58313808609056*^9, 
   3.5831382089573755`*^9, 3.583146622683806*^9, 3.5831501729230423`*^9, 
   3.583150223966332*^9, 3.583150272201617*^9, {3.58796518375746*^9, 
   3.587965204224696*^9}, 3.588079873123229*^9, 3.5880799564585752`*^9, 
   3.5880833295329075`*^9, 3.5880836896439395`*^9, 3.588316615314276*^9, 
   3.5883188437957907`*^9, 3.5883190200605*^9, 3.5883191697427626`*^9, 
   3.5883258271548405`*^9, 3.588325958460271*^9, 3.5883269168177547`*^9, 
   3.5883278602148113`*^9, 3.588327929385333*^9, 3.5883280193350906`*^9, 
   3.5883284737014885`*^9, 3.588328557848037*^9, 3.588329397239711*^9, {
   3.5883296807078085`*^9, 3.5883297042170506`*^9}, 3.588329912492015*^9, 
   3.615130826086859*^9, 3.615131008167284*^9, 3.619089166140088*^9, 
   3.619626215519158*^9, 3.6205425717785783`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input"],

Cell[BoxData["\<\"\\\\tfrac{1}{3 \\\\sqrt{2}}\"\>"], "Output",
 CellChangeTimes->{
  3.5823477964039183`*^9, 3.5823538548948517`*^9, 3.5823539677476573`*^9, 
   3.5831307209694233`*^9, 3.5831330410844984`*^9, 3.5831331209878387`*^9, 
   3.5831331959313707`*^9, 3.583133302635558*^9, 3.5831333346468143`*^9, 
   3.58313519963109*^9, 3.58313532502411*^9, 3.5831380861061597`*^9, 
   3.583138208988576*^9, 3.583146622683806*^9, 3.5831501729230423`*^9, 
   3.5831502239819317`*^9, 3.5831502722172165`*^9, {3.58796518377306*^9, 
   3.587965204240296*^9}, 3.588079873123229*^9, 3.5880799564585752`*^9, 
   3.588083329564107*^9, 3.5880836896595397`*^9, 3.588316615314276*^9, 
   3.5883188438113904`*^9, 3.5883190200761003`*^9, 3.588319169773963*^9, 
   3.5883258271704407`*^9, 3.588325958475871*^9, 3.5883269168333545`*^9, 
   3.5883278602148113`*^9, 3.588327929385333*^9, 3.588328019350691*^9, 
   3.5883284737014885`*^9, 3.588328557863637*^9, 3.588329397255311*^9, {
   3.5883296807234087`*^9, 3.5883297042326503`*^9}, 3.588329912507615*^9, 
   3.615130826086859*^9, 3.615131008167284*^9, 3.619089166140088*^9, 
   3.619626215529158*^9, 3.6205425717885785`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[Lambda]", "[", "]"}], "-", "3"}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"1", "-", "\[Lambda]"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.544604963424427*^9, 3.544605003711731*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "3"}], "+", 
   InterpretationBox[
    StyleBox["\[Lambda]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[Lambda][],
    Editable->False]}], 
  RowBox[{"1", "-", "\[Lambda]"}]]], "Output",
 CellChangeTimes->{
  3.5823477964351177`*^9, 3.582353854910452*^9, 3.582353967763257*^9, 
   3.5831307209850235`*^9, 3.5831330411000986`*^9, 3.583133121003439*^9, 
   3.5831331959469705`*^9, 3.5831333026511583`*^9, 3.5831333346624146`*^9, 
   3.58313519963109*^9, 3.58313532503971*^9, 3.58313808612176*^9, 
   3.5831382090197754`*^9, 3.5831466226994057`*^9, 3.5831501730322423`*^9, 
   3.583150223997532*^9, 3.5831502722328167`*^9, {3.58796518378866*^9, 
   3.587965204255896*^9}, 3.588079873138829*^9, 3.5880799564741755`*^9, 
   3.5880833295953074`*^9, 3.5880836896751394`*^9, 3.588316615329876*^9, 
   3.58831884382699*^9, 3.5883190200917*^9, 3.588319169789563*^9, 
   3.5883258271860404`*^9, 3.588325958475871*^9, 3.588326916848954*^9, 
   3.5883278602304115`*^9, 3.588327929400933*^9, 3.588328019366291*^9, 
   3.5883284737170887`*^9, 3.588328557863637*^9, 3.588329397270911*^9, {
   3.588329680739009*^9, 3.58832970424825*^9}, 3.588329912507615*^9, 
   3.615130826096859*^9, 3.615131008182884*^9, 3.6190891661500883`*^9, 
   3.619626215539158*^9, 3.6205425717885785`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellChangeTimes->{{3.544604994392198*^9, 3.544604996902342*^9}}],

Cell[BoxData["\<\"- \\\\frac{3 -  \\\\lambda}{1 -  \\\\lambda}\"\>"], "Output",
 CellChangeTimes->{
  3.582347796450718*^9, 3.582353854926052*^9, 3.582353967778857*^9, 
   3.5831307210006237`*^9, 3.5831330411156983`*^9, 3.583133121019039*^9, 
   3.58313319596257*^9, 3.583133302682358*^9, 3.5831333346780143`*^9, 
   3.58313519964669*^9, 3.5831353250553102`*^9, 3.5831380864961605`*^9, 
   3.5831382090353756`*^9, 3.583146622715006*^9, 3.5831501730478425`*^9, 
   3.583150224013132*^9, 3.583150272248417*^9, {3.5879651838042603`*^9, 
   3.5879652042714963`*^9}, 3.5880798731544294`*^9, 3.5880799564897757`*^9, 
   3.5880833296265073`*^9, 3.5880836896907396`*^9, 3.588316615345476*^9, 
   3.5883188438425903`*^9, 3.5883190201073*^9, 3.588319169820763*^9, 
   3.58832582720164*^9, 3.5883259584914713`*^9, 3.588326916848954*^9, 
   3.5883278602460117`*^9, 3.5883279294165325`*^9, 3.588328019366291*^9, 
   3.588328473732689*^9, 3.5883285578792367`*^9, 3.5883293972865114`*^9, {
   3.588329680754609*^9, 3.58832970424825*^9}, 3.5883299125232153`*^9, 
   3.615130826106859*^9, 3.615131008182884*^9, 3.6190891661500883`*^9, 
   3.619626215539158*^9, 3.6205425717985783`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"$TexFractionAsFraction", "=", "False"}], "}"}], ",", 
   RowBox[{"TexPrint", "[", "%%", "]"}]}], "]"}]], "Input"],

Cell[BoxData["\<\"(1 -  \\\\lambda)^{-1} (-3 + \\\\lambda)\"\>"], "Output",
 CellChangeTimes->{
  3.582347796466318*^9, 3.5823538549416523`*^9, 3.5823539677944574`*^9, 
   3.5831307210006237`*^9, 3.583133041131298*^9, 3.583133121034639*^9, 
   3.5831331959781704`*^9, 3.583133302682358*^9, 3.583133334693614*^9, 
   3.58313519966229*^9, 3.58313532508651*^9, 3.583138086683361*^9, 
   3.583138209050976*^9, 3.583146622730606*^9, 3.5831501730634427`*^9, 
   3.5831502240287323`*^9, 3.583150272264017*^9, {3.5879651838198605`*^9, 
   3.587965204287096*^9}, 3.588079873170029*^9, 3.588079956505376*^9, 
   3.588083329657707*^9, 3.58808368970634*^9, 3.5883166153610764`*^9, 
   3.5883188438581905`*^9, 3.5883190201385*^9, 3.5883191698363633`*^9, 
   3.58832582720164*^9, 3.588325958507071*^9, 3.5883269168645544`*^9, 
   3.5883278602616115`*^9, 3.5883279294165325`*^9, 3.588328019381891*^9, 
   3.588328473732689*^9, 3.588328557894837*^9, 3.5883293972865114`*^9, {
   3.588329680754609*^9, 3.58832970426385*^9}, 3.588329912538815*^9, 
   3.615130826106859*^9, 3.615131008182884*^9, 3.619089166160088*^9, 
   3.619626215549158*^9, 3.6205425718085785`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", 
   RowBox[{"Sqrt", "[", "2", "]"}]}], "*", 
  RowBox[{
   RowBox[{"T", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], "/", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"\[Lambda]", "[", "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.54460502974422*^9, 3.5446050354855485`*^9}}],

Cell[BoxData[
 FractionBox[
  InterpretationBox[
   StyleBox[GridBox[{
      {"\[Tau]", 
       StyleBox[GridBox[{
          {" ", " ", " "},
          {"a", "b", "c"}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.], {
              Offset[0.034999999999999996`]}, 
             Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
              Offset[0.]}}, "RowsIndexed" -> {}}],
        FontSize->Rational[39, 4]]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.034999999999999996`]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`T[-$CellContext`a, -$CellContext`b, -$CellContext`c],
   Editable->False], 
  RowBox[{
   SqrtBox["2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     InterpretationBox[
      StyleBox["\[Lambda]",
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`\[Lambda][],
      Editable->False]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.5823477964819183`*^9, 3.582353854957252*^9, 3.582353967810057*^9, 
   3.5831307210162234`*^9, 3.5831330411468983`*^9, 3.583133121034639*^9, 
   3.5831331959781704`*^9, 3.583133302697958*^9, 3.583133334693614*^9, 
   3.58313519966229*^9, 3.58313532510211*^9, 3.583138086698961*^9, 
   3.583138209050976*^9, 3.5831466227462063`*^9, 3.5831501730790424`*^9, 
   3.583150224044332*^9, 3.583150272264017*^9, {3.5879651838354607`*^9, 
   3.587965204302696*^9}, 3.588079873185629*^9, 3.5880799565209756`*^9, 
   3.5880833296889076`*^9, 3.58808368992474*^9, 3.5883166153766766`*^9, 
   3.5883188438737907`*^9, 3.5883190201697*^9, 3.5883191698675632`*^9, 
   3.5883258272172403`*^9, 3.5883259585226707`*^9, 3.5883269168801546`*^9, 
   3.5883278602616115`*^9, 3.5883279294321327`*^9, 3.5883280193974905`*^9, 
   3.588328473748289*^9, 3.588328557894837*^9, 3.588329397302111*^9, {
   3.5883296807702093`*^9, 3.5883297042794504`*^9}, 3.588329912554415*^9, 
   3.6151308261168594`*^9, 3.615131008182884*^9, 3.619089166160088*^9, 
   3.6196262155591583`*^9, 3.6205425718085785`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellChangeTimes->{{3.5446050369326315`*^9, 3.5446050413938866`*^9}}],

Cell[BoxData["\<\"\\\\frac{\\\\tau_{abc}}{\\\\sqrt{2} (1 + \
\\\\lambda)}\"\>"], "Output",
 CellChangeTimes->{
  3.5823477964975185`*^9, 3.5823538549728518`*^9, 3.582353967841257*^9, 
   3.583130721031823*^9, 3.5831330411624985`*^9, 3.5831331210502386`*^9, 
   3.5831331959937706`*^9, 3.583133302729158*^9, 3.5831333347248144`*^9, 
   3.58313519969349*^9, 3.58313532511771*^9, 3.5831380870889616`*^9, 
   3.5831382090821757`*^9, 3.583146622761806*^9, 3.5831501730946426`*^9, 
   3.5831502240599318`*^9, 3.583150272310817*^9, {3.5879651838510604`*^9, 
   3.5879652043182964`*^9}, 3.588079873201229*^9, 3.5880799565365753`*^9, 
   3.5880833297357073`*^9, 3.5880836902679405`*^9, 3.5883166153922763`*^9, 
   3.5883188439049907`*^9, 3.5883190202321005`*^9, 3.588319169898763*^9, 
   3.5883258272328405`*^9, 3.588325958538271*^9, 3.5883269168957543`*^9, 
   3.588327860277211*^9, 3.588327929447733*^9, 3.5883280194130907`*^9, 
   3.588328473763889*^9, 3.588328557926037*^9, 3.588329397317711*^9, {
   3.5883296808014092`*^9, 3.5883297042950506`*^9}, 3.588329912570015*^9, 
   3.6151308261268597`*^9, 3.615131008198484*^9, 3.619089166170088*^9, 
   3.619626215569158*^9, 3.6205425718185787`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"$TexFractionAsFraction", "=", "False"}], "}"}], ",", 
   RowBox[{"TexPrint", "[", "%%", "]"}]}], "]"}]], "Input"],

Cell[BoxData["\<\"\\\\tfrac{1}{\\\\sqrt{2}}\\\\tau_{abc} (1 + \
\\\\lambda)^{-1}\"\>"], "Output",
 CellChangeTimes->{
  3.5823477965131183`*^9, 3.582353855004052*^9, 3.5823539678568573`*^9, 
   3.5831330411780987`*^9, 3.583133121065839*^9, 3.583133196009371*^9, 
   3.5831333027447577`*^9, 3.5831333347404146`*^9, 3.58313519970909*^9, 
   3.5831353251333103`*^9, 3.583138087276162*^9, 3.583138209097776*^9, 
   3.5831466227774057`*^9, 3.583150173110243*^9, 3.583150224075532*^9, 
   3.583150272326417*^9, {3.58796518386666*^9, 3.5879652043338966`*^9}, 
   3.5880798732324295`*^9, 3.5880799565521755`*^9, 3.5880833297669077`*^9, 
   3.588083690299141*^9, 3.5883166154078765`*^9, 3.588318843920591*^9, 
   3.5883190202477007`*^9, 3.588319169914363*^9, 3.58832582727964*^9, 
   3.588325958553871*^9, 3.588326916911354*^9, 3.5883278602928114`*^9, 
   3.588327929463333*^9, 3.588328019428691*^9, 3.588328473779489*^9, 
   3.588328557941637*^9, 3.588329397333311*^9, {3.588329680817009*^9, 
   3.5883297043106503`*^9}, 3.588329912585615*^9, 3.6151308261368594`*^9, 
   3.6151310082140837`*^9, 3.619089166220088*^9, 3.619626215579158*^9, 
   3.6205425718285785`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Lambda]", "[", "]"}], "-", "3"}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"1", "-", "\[Lambda]"}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"1", "/", "3"}], "/", 
   RowBox[{"Sqrt", "[", "2", "]"}]}], "-", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"\[Lambda]", "[", "]"}]}], "/", "3"}], "/", 
   RowBox[{"Sqrt", "[", "2", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5831307531366796`*^9, 3.583130763994299*^9}, {
   3.588318871485839*^9, 3.5883188733734426`*^9}, 3.5883190503245535`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"3", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "3"}], "+", 
    InterpretationBox[
     StyleBox["\[Lambda]",
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[Lambda][],
     Editable->False]}], 
   RowBox[{"1", "-", "\[Lambda]"}]], "-", 
  FractionBox["1", 
   RowBox[{"3", " ", 
    SqrtBox["2"], " ", 
    InterpretationBox[
     StyleBox["\[Lambda]",
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[Lambda][],
     Editable->False]}]]}]], "Output",
 CellChangeTimes->{
  3.5831307644311*^9, {3.583130800888364*^9, 3.583130805521572*^9}, 
   3.583130978713076*^9, 3.583131014452739*^9, 3.583133041193699*^9, 
   3.583133121081439*^9, 3.583133196024971*^9, 3.583133302760358*^9, 
   3.5831333347560143`*^9, 3.58313519970909*^9, 3.5831353251489105`*^9, 
   3.5831380872917624`*^9, 3.583138209097776*^9, 3.5831466227774057`*^9, 
   3.583150173125843*^9, 3.583150224091132*^9, 3.583150272342017*^9, {
   3.5879651838822603`*^9, 3.5879652043494964`*^9}, 3.588079873279229*^9, 
   3.5880799565677757`*^9, 3.5880833297981076`*^9, 3.5880836903459406`*^9, 
   3.588316615423476*^9, {3.5883168200022354`*^9, 3.58831683945547*^9}, 
   3.5883188439361906`*^9, 3.5883188739974437`*^9, 3.5883190202633004`*^9, 
   3.5883190506989536`*^9, 3.5883191699455633`*^9, 3.5883258272952404`*^9, 
   3.588325958553871*^9, 3.5883269169269543`*^9, 3.5883278603084116`*^9, 
   3.5883279294789333`*^9, 3.588328019444291*^9, 3.588328473795089*^9, 
   3.588328557941637*^9, 3.5883293973489113`*^9, {3.588329680817009*^9, 
   3.58832970432625*^9}, 3.5883299126012154`*^9, 3.6151308261368594`*^9, 
   3.6151310082140837`*^9, 3.619089166220088*^9, 3.619626215579158*^9, 
   3.6205425718285785`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellChangeTimes->{{3.583133108117816*^9, 3.58313311023942*^9}}],

Cell[BoxData["\<\"\\\\tfrac{1}{3 \\\\sqrt{2}} -  \\\\frac{3 -  \\\\lambda}{1 \
-  \\\\lambda} -  \\\\frac{1}{3 \\\\sqrt{2} \\\\lambda}\"\>"], "Output",
 CellChangeTimes->{
  3.583133121097039*^9, 3.5831331960405707`*^9, 3.583133302775958*^9, 
   3.583133334771614*^9, 3.58313519972469*^9, 3.5831353251645107`*^9, 
   3.5831380876817627`*^9, 3.5831382091133757`*^9, 3.583146622793006*^9, 
   3.583150173141443*^9, 3.5831502241067324`*^9, 3.583150272357617*^9, {
   3.5879651838978605`*^9, 3.5879652043806963`*^9}, 3.5880798732948294`*^9, 
   3.588079956583376*^9, 3.5880833298449078`*^9, 3.5880836904707413`*^9, 
   3.5883166154390764`*^9, {3.588316820563837*^9, 3.588316839985871*^9}, 
   3.588318843951791*^9, 3.588318875385846*^9, 3.5883190202945004`*^9, 
   3.588319051244955*^9, 3.5883191699611635`*^9, 3.5883258273108406`*^9, 
   3.5883259585694714`*^9, 3.5883269169425545`*^9, 3.588327860324012*^9, 
   3.588327929494533*^9, 3.588328019444291*^9, 3.588328473810689*^9, 
   3.588328557957237*^9, 3.5883293973645115`*^9, {3.588329680832609*^9, 
   3.5883297043730507`*^9}, 3.588329912616815*^9, 3.615130826146859*^9, 
   3.6151310082140837`*^9, 3.619089166230088*^9, 3.619626215589158*^9, 
   3.620542571838578*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexBreak", "[", 
  RowBox[{"%", ",", "1", ",", 
   RowBox[{"TexBreakBy", "\[Rule]", "\"\<Term\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5831307663187027`*^9, 3.583130799281561*^9}, {
   3.5883168347754617`*^9, 3.5883168366474648`*^9}, 3.5883188144365387`*^9}],

Cell[BoxData["\<\"\\\\tfrac{1}{3 \\\\sqrt{2}} \\\\nonumber \\\\\\\\ \\n&& -  \
\\\\frac{3 -  \\\\lambda}{1 -  \\\\lambda} \\\\nonumber \\\\\\\\ \\n&& -  \
\\\\frac{1}{3 \\\\sqrt{2} \\\\lambda}\"\>"], "Output",
 CellChangeTimes->{{3.5831308025575666`*^9, 3.5831308128847847`*^9}, 
   3.583133041209299*^9, 3.5831331214246397`*^9, 3.5831331960561705`*^9, 
   3.5831333027915583`*^9, 3.583133334771614*^9, 3.5831351997402897`*^9, 
   3.5831353251801105`*^9, 3.583138087837763*^9, 3.583138209128976*^9, 
   3.5831466228242064`*^9, 3.5831501731570425`*^9, 3.5831502241067324`*^9, 
   3.583150272357617*^9, {3.5879651839134607`*^9, 3.5879652043962965`*^9}, 
   3.58807987348203*^9, 3.5880799565989757`*^9, 3.5880833298761077`*^9, 
   3.5880836906267414`*^9, 3.5883166154702764`*^9, {3.5883168211566377`*^9, 
   3.5883168404382715`*^9}, 3.5883188439829907`*^9, 3.588318876618248*^9, 
   3.5883190203101006`*^9, 3.588319051837756*^9, 3.5883191699923635`*^9, 
   3.588325827326441*^9, 3.5883259586006713`*^9, 3.5883269169581547`*^9, 
   3.5883278603396115`*^9, 3.588327929510133*^9, 3.588328019475491*^9, 
   3.588328473826289*^9, 3.5883285579728365`*^9, 3.588329397380111*^9, {
   3.5883296808482094`*^9, 3.5883297043886504`*^9}, 3.5883299126324153`*^9, 
   3.6151308261568594`*^9, 3.615131008229684*^9, 3.619089166240088*^9, 
   3.6196262155991583`*^9, 3.6205425718485785`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Scalar", "[", 
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}], ",", 
      RowBox[{"-", "c"}]}], "]"}], 
    RowBox[{"T", "[", 
     RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "]"}], "^", 
  RowBox[{"(", "2", ")"}]}]], "Input",
 CellChangeTimes->{{3.5831351756382475`*^9, 3.583135185045064*^9}}],

Cell[BoxData[
 SuperscriptBox[
  InterpretationBox[
   StyleBox[
    RowBox[{
     StyleBox["(",
      FontColor->RGBColor[1, 0, 0]], 
     RowBox[{
      InterpretationBox[
       StyleBox[GridBox[{
          {"\[Tau]", 
           StyleBox[GridBox[{
              {" ", " ", " "},
              {"a", "b", "c"}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.], {
                  Offset[0.034999999999999996`]}, 
                 Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                  Offset[0.]}}, "RowsIndexed" -> {}}],
            FontSize->Rational[39, 4]]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Center}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.034999999999999996`]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`T[-$CellContext`a, -$CellContext`b, -$CellContext`c],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[GridBox[{
          {"\[Tau]", 
           StyleBox[GridBox[{
              {"a", "b", "c"},
              {" ", " ", " "}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.], {
                  Offset[0.034999999999999996`]}, 
                 Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                  Offset[0.]}}, "RowsIndexed" -> {}}],
            FontSize->Rational[39, 4]]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Center}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.034999999999999996`]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`T[$CellContext`a, $CellContext`b, $CellContext`c],
       Editable->False]}], 
     StyleBox[")",
      FontColor->RGBColor[1, 0, 0]]}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   xAct`xTensor`Scalar[$CellContext`T[-$CellContext`a, -$CellContext`b, \
-$CellContext`c] $CellContext`T[$CellContext`a, $CellContext`b, \
$CellContext`c]],
   Editable->False], "2"]], "Output",
 CellChangeTimes->{
  3.58313519975589*^9, {3.5831352534823847`*^9, 3.58313532519571*^9}, 
   3.583138087853363*^9, 3.583138209144576*^9, 3.5831466229178066`*^9, 
   3.5831501731726427`*^9, 3.5831502241223326`*^9, 3.583150272466817*^9, {
   3.5879651839134607`*^9, 3.5879652044118967`*^9}, 3.5880798734976296`*^9, 
   3.5880799565989757`*^9, 3.5880833299073076`*^9, 3.588083690845142*^9, 
   3.588319064068177*^9, 3.5883191700235634`*^9, 3.5883258273420405`*^9, 
   3.5883259586006713`*^9, 3.5883269169737544`*^9, 3.5883278603552113`*^9, 
   3.588327929525733*^9, 3.588328019475491*^9, 3.5883284738730893`*^9, 
   3.5883285579884367`*^9, 3.588329397395711*^9, {3.588329680863809*^9, 
   3.58832970440425*^9}, 3.588329912648015*^9, 3.6151308261668596`*^9, 
   3.615131008245284*^9, 3.619089166260088*^9, 3.619626215619158*^9, 
   3.6205425718585787`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellChangeTimes->{{3.5831352098335075`*^9, 3.583135212329512*^9}}],

Cell[BoxData["\<\"(\\\\tau_{abc} \\\\tau^{abc})^2\"\>"], "Output",
 CellChangeTimes->{
  3.5831352135463142`*^9, {3.5831352541999855`*^9, 3.5831353252269106`*^9}, 
   3.5831380880249634`*^9, 3.5831382091601763`*^9, 3.5831466229334064`*^9, 
   3.583150173188243*^9, 3.5831502242627325`*^9, 3.5831502724980173`*^9, {
   3.58796518394466*^9, 3.587965204443096*^9}, 3.58807987351323*^9, 
   3.5880799566301756`*^9, 3.588083329954108*^9, 3.5880836909855423`*^9, 
   3.5883190640993776`*^9, 3.588319170054764*^9, 3.5883258273576407`*^9, 
   3.588325958631871*^9, 3.5883269169893546`*^9, 3.5883278603708115`*^9, 
   3.588327929541333*^9, 3.588328019506691*^9, 3.588328473888689*^9, 
   3.588328558004037*^9, 3.588329397411311*^9, {3.5883296808794093`*^9, 
   3.5883297044198503`*^9}, 3.588329912663615*^9, 3.6151308261768594`*^9, 
   3.6151310082608843`*^9, 3.619089166270088*^9, 3.619626215629158*^9, 
   3.6205425718585787`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Scalar", "[", 
  RowBox[{
   RowBox[{"T", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], 
   RowBox[{"T", "[", 
    RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5831351756382475`*^9, 3.583135185045064*^9}, {
  3.5831352273211384`*^9, 3.5831352277735395`*^9}}],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   RowBox[{
    StyleBox["(",
     FontColor->RGBColor[1, 0, 0]], 
    RowBox[{
     InterpretationBox[
      StyleBox[GridBox[{
         {"\[Tau]", 
          StyleBox[GridBox[{
             {" ", " ", " "},
             {"a", "b", "c"}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.], {
                 Offset[0.034999999999999996`]}, 
                Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                 Offset[0.]}}, "RowsIndexed" -> {}}],
           FontSize->Rational[39, 4]]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Center}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.034999999999999996`]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`T[-$CellContext`a, -$CellContext`b, -$CellContext`c],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[GridBox[{
         {"\[Tau]", 
          StyleBox[GridBox[{
             {"a", "b", "c"},
             {" ", " ", " "}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.], {
                 Offset[0.034999999999999996`]}, 
                Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                 Offset[0.]}}, "RowsIndexed" -> {}}],
           FontSize->Rational[39, 4]]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Center}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.034999999999999996`]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`T[$CellContext`a, $CellContext`b, $CellContext`c],
      Editable->False]}], 
    StyleBox[")",
     FontColor->RGBColor[1, 0, 0]]}],
   ShowAutoStyles->False,
   AutoSpacing->False],
  xAct`xTensor`Scalar[$CellContext`T[-$CellContext`a, -$CellContext`b, \
-$CellContext`c] $CellContext`T[$CellContext`a, $CellContext`b, \
$CellContext`c]],
  Editable->False]], "Output",
 CellChangeTimes->{{3.58313519975589*^9, 3.5831353252269106`*^9}, 
   3.5831380880561633`*^9, 3.5831382091601763`*^9, 3.583146622949006*^9, 
   3.583150173203843*^9, 3.5831502242783327`*^9, 3.5831502725136175`*^9, {
   3.58796518394466*^9, 3.5879652044586964`*^9}, 3.5880798735288296`*^9, 
   3.5880799566301756`*^9, 3.5880833299853077`*^9, 3.5880836912195425`*^9, 
   3.5883190641149774`*^9, 3.5883191700703635`*^9, 3.5883258273732405`*^9, 
   3.588325958631871*^9, 3.5883269169893546`*^9, 3.5883278603864117`*^9, 
   3.5883279295569334`*^9, 3.588328019506691*^9, 3.5883284739042892`*^9, 
   3.588328558019637*^9, 3.5883293974269114`*^9, {3.588329680895009*^9, 
   3.5883297044354506`*^9}, 3.5883299126792154`*^9, 3.615130826186859*^9, 
   3.6151310082608843`*^9, 3.619089166280088*^9, 3.6196262156391582`*^9, 
   3.6205425718685784`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellChangeTimes->{{3.5831352098335075`*^9, 3.583135212329512*^9}}],

Cell[BoxData["\<\"(\\\\tau_{abc} \\\\tau^{abc})\"\>"], "Output",
 CellChangeTimes->{{3.5831352135463142`*^9, 3.5831353252425103`*^9}, 
   3.5831380882277637`*^9, 3.5831382091913757`*^9, 3.5831466229646063`*^9, 
   3.583150173219443*^9, 3.583150224293933*^9, 3.5831502725292172`*^9, {
   3.5879651839758606`*^9, 3.5879652044742966`*^9}, 3.58807987354443*^9, 
   3.588079956645776*^9, 3.588083330063308*^9, 3.5880836912819424`*^9, 
   3.588319064130577*^9, 3.5883191701015635`*^9, 3.5883258273888407`*^9, 
   3.5883259586474714`*^9, 3.5883269170205545`*^9, 3.588327860402012*^9, 
   3.588327929572533*^9, 3.588328019522291*^9, 3.5883284739198895`*^9, 
   3.5883285580352373`*^9, 3.5883293974425116`*^9, {3.5883296809106092`*^9, 
   3.5883297044510508`*^9}, 3.588329912694815*^9, 3.6151308261968594`*^9, 
   3.6151310082764845`*^9, 3.6190891662900877`*^9, 3.6196262156491585`*^9, 
   3.6205425718785787`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"UndefBasis", "[", "B4", "]"}]], "Input",
 CellChangeTimes->{{3.5831502063383007`*^9, 3.5831502105815086`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"non-symmetric Christoffel tensor\"\>", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "ChristoffelPDB4"}],
  
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", 
   "non-symmetric Christoffel tensor", " ", $CellContext`ChristoffelPDB4],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.5831502243095326`*^9, 3.5831502725292172`*^9, {3.5879651839758606`*^9, 
   3.5879652044898963`*^9}, 3.58807987357563*^9, 3.588079956770576*^9, 
   3.588083330094508*^9, 3.588083691500343*^9, 3.5883190716185904`*^9, 
   3.588319170132764*^9, 3.588325827404441*^9, 3.588325958663071*^9, 
   3.588326917051755*^9, 3.5883278604176116`*^9, 3.588327929588133*^9, 
   3.5883280195378914`*^9, 3.588328473935489*^9, 3.588328558082037*^9, 
   3.5883293974581113`*^9, {3.5883296809262094`*^9, 3.5883297044510508`*^9}, 
   3.588329912710415*^9, 3.6151308262068596`*^9, 3.6151310082764845`*^9, 
   3.6190891662900877`*^9, 3.6196262156491585`*^9, 3.6205425718885784`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"Ricci tensor\"\>", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "RicciPDB4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "Ricci tensor", 
   " ", $CellContext`RicciPDB4],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.5831502243095326`*^9, 3.5831502725292172`*^9, {3.5879651839758606`*^9, 
   3.5879652044898963`*^9}, 3.58807987357563*^9, 3.588079956770576*^9, 
   3.588083330094508*^9, 3.588083691500343*^9, 3.5883190716185904`*^9, 
   3.588319170132764*^9, 3.588325827404441*^9, 3.588325958663071*^9, 
   3.588326917051755*^9, 3.5883278604176116`*^9, 3.588327929588133*^9, 
   3.5883280195378914`*^9, 3.588328473935489*^9, 3.588328558082037*^9, 
   3.5883293974581113`*^9, {3.5883296809262094`*^9, 3.5883297044510508`*^9}, 
   3.588329912710415*^9, 3.6151308262068596`*^9, 3.6151310082764845`*^9, 
   3.6190891662900877`*^9, 3.6196262156491585`*^9, 3.6205425718885784`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"Riemann tensor\"\>", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "RiemannPDB4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "Riemann tensor", 
   " ", $CellContext`RiemannPDB4],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.5831502243095326`*^9, 3.5831502725292172`*^9, {3.5879651839758606`*^9, 
   3.5879652044898963`*^9}, 3.58807987357563*^9, 3.588079956770576*^9, 
   3.588083330094508*^9, 3.588083691500343*^9, 3.5883190716185904`*^9, 
   3.588319170132764*^9, 3.588325827404441*^9, 3.588325958663071*^9, 
   3.588326917051755*^9, 3.5883278604176116`*^9, 3.588327929588133*^9, 
   3.5883280195378914`*^9, 3.588328473935489*^9, 3.588328558082037*^9, 
   3.5883293974581113`*^9, {3.5883296809262094`*^9, 3.5883297044510508`*^9}, 
   3.588329912710415*^9, 3.6151308262068596`*^9, 3.6151310082764845`*^9, 
   3.6190891662900877`*^9, 3.6196262156491585`*^9, 3.6205425718885784`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"torsion tensor\"\>", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "TorsionPDB4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "torsion tensor", 
   " ", $CellContext`TorsionPDB4],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.5831502243095326`*^9, 3.5831502725292172`*^9, {3.5879651839758606`*^9, 
   3.5879652044898963`*^9}, 3.58807987357563*^9, 3.588079956770576*^9, 
   3.588083330094508*^9, 3.588083691500343*^9, 3.5883190716185904`*^9, 
   3.588319170132764*^9, 3.588325827404441*^9, 3.588325958663071*^9, 
   3.588326917051755*^9, 3.5883278604176116`*^9, 3.588327929588133*^9, 
   3.5883280195378914`*^9, 3.588328473935489*^9, 3.588328558082037*^9, 
   3.5883293974581113`*^9, {3.5883296809262094`*^9, 3.5883297044510508`*^9}, 
   3.588329912710415*^9, 3.6151308262068596`*^9, 3.6151310082764845`*^9, 
   3.6190891662900877`*^9, 3.6196262156491585`*^9, 3.6205425718885784`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefCovD", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"parallel derivative\"\>", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "PDB4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefCovD, ": Undefined ", "parallel derivative", 
   " ", $CellContext`PDB4],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.5831502243095326`*^9, 3.5831502725292172`*^9, {3.5879651839758606`*^9, 
   3.5879652044898963`*^9}, 3.58807987357563*^9, 3.588079956770576*^9, 
   3.588083330094508*^9, 3.588083691500343*^9, 3.5883190716185904`*^9, 
   3.588319170132764*^9, 3.588325827404441*^9, 3.588325958663071*^9, 
   3.588326917051755*^9, 3.5883278604176116`*^9, 3.588327929588133*^9, 
   3.5883280195378914`*^9, 3.588328473935489*^9, 3.588328558082037*^9, 
   3.5883293974581113`*^9, {3.5883296809262094`*^9, 3.5883297044510508`*^9}, 
   3.588329912710415*^9, 3.6151308262068596`*^9, 3.6151310082764845`*^9, 
   3.6190891662900877`*^9, 3.6196262156491585`*^9, 3.6205425718885784`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"antisymmetric +1 density\"\>", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "etaUpB4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "antisymmetric +1 density",
    " ", $CellContext`etaUpB4],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.5831502243095326`*^9, 3.5831502725292172`*^9, {3.5879651839758606`*^9, 
   3.5879652044898963`*^9}, 3.58807987357563*^9, 3.588079956770576*^9, 
   3.588083330094508*^9, 3.588083691500343*^9, 3.5883190716185904`*^9, 
   3.588319170132764*^9, 3.588325827404441*^9, 3.588325958663071*^9, 
   3.588326917051755*^9, 3.5883278604176116`*^9, 3.588327929588133*^9, 
   3.5883280195378914`*^9, 3.588328473935489*^9, 3.588328558082037*^9, 
   3.5883293974581113`*^9, {3.5883296809262094`*^9, 3.5883297044510508`*^9}, 
   3.588329912710415*^9, 3.6151308262068596`*^9, 3.6151310082764845`*^9, 
   3.6190891662900877`*^9, 3.6196262156491585`*^9, 3.6205425718885784`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"antisymmetric -1 density\"\>", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "etaDownB4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "antisymmetric -1 density",
    " ", $CellContext`etaDownB4],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.5831502243095326`*^9, 3.5831502725292172`*^9, {3.5879651839758606`*^9, 
   3.5879652044898963`*^9}, 3.58807987357563*^9, 3.588079956770576*^9, 
   3.588083330094508*^9, 3.588083691500343*^9, 3.5883190716185904`*^9, 
   3.588319170132764*^9, 3.588325827404441*^9, 3.588325958663071*^9, 
   3.588326917051755*^9, 3.5883278604176116`*^9, 3.588327929588133*^9, 
   3.5883280195378914`*^9, 3.588328473935489*^9, 3.588328558082037*^9, 
   3.5883293974581113`*^9, {3.5883296809262094`*^9, 3.5883297044510508`*^9}, 
   3.588329912710415*^9, 3.6151308262068596`*^9, 3.6151310082764845`*^9, 
   3.6190891662900877`*^9, 3.6196262156491585`*^9, 3.6205425718885784`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefBasis", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"basis\"\>", "\[InvisibleSpace]", "\<\" \"\>", 
   "\[InvisibleSpace]", "B4"}],
  SequenceForm[
  "** ", xAct`xCoba`UndefBasis, ": Undefined ", "basis", " ", $CellContext`B4],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.5831502243095326`*^9, 3.5831502725292172`*^9, {3.5879651839758606`*^9, 
   3.5879652044898963`*^9}, 3.58807987357563*^9, 3.588079956770576*^9, 
   3.588083330094508*^9, 3.588083691500343*^9, 3.5883190716185904`*^9, 
   3.588319170132764*^9, 3.588325827404441*^9, 3.588325958663071*^9, 
   3.588326917051755*^9, 3.5883278604176116`*^9, 3.588327929588133*^9, 
   3.5883280195378914`*^9, 3.588328473935489*^9, 3.588328558082037*^9, 
   3.5883293974581113`*^9, {3.5883296809262094`*^9, 3.5883297044510508`*^9}, 
   3.588329912710415*^9, 3.6151308262068596`*^9, 3.6151310082764845`*^9, 
   3.6190891662900877`*^9, 3.6196262156491585`*^9, 3.6205425718985786`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"UndefTensor", "/@", "$Tensors"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"tensor\"\>", "\[InvisibleSpace]", "\<\" \"\>", 
   "\[InvisibleSpace]", "T"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "tensor", 
   " ", $CellContext`T],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.582347796528718*^9, 3.582353855019652*^9, 3.5823539678724575`*^9, 
   3.583133041224899*^9, 3.5831332610926847`*^9, 3.5831333028071585`*^9, 
   3.5831333347872143`*^9, 3.58313532525811*^9, 3.5831380882433634`*^9, 
   3.5831382091913757`*^9, 3.5831466229802065`*^9, 3.5831501732350426`*^9, 
   3.5831502243407326`*^9, 3.583150272560417*^9, {3.587965184100661*^9, 
   3.587965204583497*^9}, 3.58807987359123*^9, 3.588079956817376*^9, 
   3.5880833301413083`*^9, 3.588083691827944*^9, 3.5883190716809907`*^9, 
   3.5883191701639633`*^9, 3.588325827420041*^9, 3.588325958694271*^9, 
   3.588326917082955*^9, 3.5883278604488115`*^9, 3.588327929603733*^9, 
   3.588328019584691*^9, 3.588328473951089*^9, 3.588328558097637*^9, 
   3.5883293975049114`*^9, {3.588329680941809*^9, 3.5883297044822507`*^9}, 
   3.588329912726015*^9, 3.61513082621686*^9, 3.6151310082920847`*^9, 
   3.619089166310088*^9, 3.619626215669158*^9, 3.6205425718985786`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"tensor\"\>", "\[InvisibleSpace]", "\<\" \"\>", 
   "\[InvisibleSpace]", "\[Lambda]"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "tensor", 
   " ", $CellContext`\[Lambda]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.582347796528718*^9, 3.582353855019652*^9, 3.5823539678724575`*^9, 
   3.583133041224899*^9, 3.5831332610926847`*^9, 3.5831333028071585`*^9, 
   3.5831333347872143`*^9, 3.58313532525811*^9, 3.5831380882433634`*^9, 
   3.5831382091913757`*^9, 3.5831466229802065`*^9, 3.5831501732350426`*^9, 
   3.5831502243407326`*^9, 3.583150272560417*^9, {3.587965184100661*^9, 
   3.587965204583497*^9}, 3.58807987359123*^9, 3.588079956817376*^9, 
   3.5880833301413083`*^9, 3.588083691827944*^9, 3.5883190716809907`*^9, 
   3.5883191701639633`*^9, 3.588325827420041*^9, 3.588325958694271*^9, 
   3.588326917082955*^9, 3.5883278604488115`*^9, 3.588327929603733*^9, 
   3.588328019584691*^9, 3.588328473951089*^9, 3.588328558097637*^9, 
   3.5883293975049114`*^9, {3.588329680941809*^9, 3.5883297044822507`*^9}, 
   3.588329912726015*^9, 3.61513082621686*^9, 3.6151310082920847`*^9, 
   3.619089166310088*^9, 3.619626215669158*^9, 3.6205425718985786`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Null", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.582347796528718*^9, 3.582353855019652*^9, 3.5823539678724575`*^9, 
   3.5831330412404985`*^9, 3.5831332610926847`*^9, 3.5831333028071585`*^9, 
   3.5831333347872143`*^9, 3.5831353252737103`*^9, 3.5831380882433634`*^9, 
   3.583138209206976*^9, 3.5831466229802065`*^9, 3.5831501733598433`*^9, 
   3.5831502243407326`*^9, 3.5831502725760174`*^9, {3.587965184459461*^9, 
   3.587965204583497*^9}, 3.5880798736068296`*^9, 3.588079956817376*^9, 
   3.5880833301413083`*^9, 3.5880836918435435`*^9, 3.588319071696591*^9, 
   3.5883191701639633`*^9, 3.588325827420041*^9, 3.588325958694271*^9, 
   3.588326917082955*^9, 3.5883278604488115`*^9, 3.588327929603733*^9, 
   3.5883280196002913`*^9, 3.588328473951089*^9, 3.5883285581132374`*^9, 
   3.5883293975205116`*^9, {3.588329680957409*^9, 3.5883297044822507`*^9}, 
   3.5883299127416153`*^9, 3.6151308262268596`*^9, 3.6151310082920847`*^9, 
   3.619089166310088*^9, 3.619626215669158*^9, 3.6205425718985786`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"<<", "xAct`SymManipulator`"}]], "Input",
 CellChangeTimes->{{3.5451105751410365`*^9, 3.5451106065594916`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{
  3.582347796544318*^9, 3.582353855035252*^9, 3.582353967888057*^9, 
   3.5831330412560987`*^9, 3.583133261155085*^9, 3.583133302822758*^9, 
   3.5831333348028145`*^9, 3.5831353252893105`*^9, 3.583138088274564*^9, 
   3.583138209222576*^9, 3.5831466229958067`*^9, 3.5831501733754435`*^9, 
   3.583150224356333*^9, 3.5831502725916176`*^9, {3.5879651845218616`*^9, 
   3.5879652046146965`*^9}, 3.58807987362243*^9, 3.5880799568329763`*^9, 
   3.5880833301881084`*^9, 3.588083692732745*^9, 3.5883190717121906`*^9, 
   3.5883191701951637`*^9, 3.588325827435641*^9, 3.5883259587098713`*^9, 
   3.5883269170985546`*^9, 3.5883278604644117`*^9, 3.5883279296193333`*^9, 
   3.5883280196158915`*^9, 3.588328473966689*^9, 3.588328558128837*^9, 
   3.588329397536112*^9, {3.588329680973009*^9, 3.588329704497851*^9}, 
   3.588329912788416*^9, 3.6151308262268596`*^9, 3.6151310083076844`*^9, 
   3.619089166320088*^9, 3.619626215679158*^9, 3.620542571908579*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`SymManipulator`  version \"\>", 
   "\[InvisibleSpace]", "\<\"0.9.2\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2014", ",", "9", ",", "24"}], "}"}]}],
  SequenceForm[
  "Package xAct`SymManipulator`  version ", "0.9.2", ", ", {2014, 9, 24}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.582347796544318*^9, 3.582353855035252*^9, 3.582353967888057*^9, 
   3.5831330412560987`*^9, 3.583133261155085*^9, 3.583133302822758*^9, 
   3.5831333348028145`*^9, 3.5831353252893105`*^9, 3.583138088274564*^9, 
   3.583138209222576*^9, 3.5831466229958067`*^9, 3.5831501733754435`*^9, 
   3.583150224356333*^9, 3.5831502725916176`*^9, {3.5879651845218616`*^9, 
   3.5879652046146965`*^9}, 3.58807987362243*^9, 3.5880799568329763`*^9, 
   3.5880833301881084`*^9, 3.588083692732745*^9, 3.5883190717121906`*^9, 
   3.5883191701951637`*^9, 3.588325827435641*^9, 3.5883259587098713`*^9, 
   3.5883269170985546`*^9, 3.5883278604644117`*^9, 3.5883279296193333`*^9, 
   3.5883280196158915`*^9, 3.588328473966689*^9, 3.588328558128837*^9, 
   3.588329397536112*^9, {3.588329680973009*^9, 3.588329704497851*^9}, 
   3.588329912788416*^9, 3.6151308262268596`*^9, 3.6151310083076844`*^9, 
   3.619089166320088*^9, 3.619626215679158*^9, 3.620542571908579*^9}],

Cell[BoxData["\<\"CopyRight (C) 2011-2014, Thomas B\[ADoubleDot]ckdahl, under \
the General Public License.\"\>"], "Print",
 CellChangeTimes->{
  3.582347796544318*^9, 3.582353855035252*^9, 3.582353967888057*^9, 
   3.5831330412560987`*^9, 3.583133261155085*^9, 3.583133302822758*^9, 
   3.5831333348028145`*^9, 3.5831353252893105`*^9, 3.583138088274564*^9, 
   3.583138209222576*^9, 3.5831466229958067`*^9, 3.5831501733754435`*^9, 
   3.583150224356333*^9, 3.5831502725916176`*^9, {3.5879651845218616`*^9, 
   3.5879652046146965`*^9}, 3.58807987362243*^9, 3.5880799568329763`*^9, 
   3.5880833301881084`*^9, 3.588083692732745*^9, 3.5883190717121906`*^9, 
   3.5883191701951637`*^9, 3.588325827435641*^9, 3.5883259587098713`*^9, 
   3.5883269170985546`*^9, 3.5883278604644117`*^9, 3.5883279296193333`*^9, 
   3.5883280196158915`*^9, 3.588328473966689*^9, 3.588328558128837*^9, 
   3.588329397536112*^9, {3.588329680973009*^9, 3.588329704497851*^9}, 
   3.588329912788416*^9, 3.6151308262268596`*^9, 3.6151310083076844`*^9, 
   3.619089166320088*^9, 3.619626215679158*^9, 3.620542571908579*^9}],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{
  3.582347796544318*^9, 3.582353855035252*^9, 3.582353967888057*^9, 
   3.5831330412560987`*^9, 3.583133261155085*^9, 3.583133302822758*^9, 
   3.5831333348028145`*^9, 3.5831353252893105`*^9, 3.583138088274564*^9, 
   3.583138209222576*^9, 3.5831466229958067`*^9, 3.5831501733754435`*^9, 
   3.583150224356333*^9, 3.5831502725916176`*^9, {3.5879651845218616`*^9, 
   3.5879652046146965`*^9}, 3.58807987362243*^9, 3.5880799568329763`*^9, 
   3.5880833301881084`*^9, 3.588083692732745*^9, 3.5883190717121906`*^9, 
   3.5883191701951637`*^9, 3.588325827435641*^9, 3.5883259587098713`*^9, 
   3.5883269170985546`*^9, 3.5883278604644117`*^9, 3.5883279296193333`*^9, 
   3.5883280196158915`*^9, 3.588328473966689*^9, 3.588328558128837*^9, 
   3.588329397536112*^9, {3.588329680973009*^9, 3.588329704497851*^9}, 
   3.588329912788416*^9, 3.6151308262268596`*^9, 3.6151310083076844`*^9, 
   3.619089166320088*^9, 3.619626215679158*^9, 3.6205425719185786`*^9}],

Cell[BoxData["\<\"These packages come with ABSOLUTELY NO WARRANTY; for \
details type Disclaimer[]. This is free software, and you are welcome to \
redistribute it under certain conditions. See the General Public License for \
details.\"\>"], "Print",
 CellChangeTimes->{
  3.582347796544318*^9, 3.582353855035252*^9, 3.582353967888057*^9, 
   3.5831330412560987`*^9, 3.583133261155085*^9, 3.583133302822758*^9, 
   3.5831333348028145`*^9, 3.5831353252893105`*^9, 3.583138088274564*^9, 
   3.583138209222576*^9, 3.5831466229958067`*^9, 3.5831501733754435`*^9, 
   3.583150224356333*^9, 3.5831502725916176`*^9, {3.5879651845218616`*^9, 
   3.5879652046146965`*^9}, 3.58807987362243*^9, 3.5880799568329763`*^9, 
   3.5880833301881084`*^9, 3.588083692732745*^9, 3.5883190717121906`*^9, 
   3.5883191701951637`*^9, 3.588325827435641*^9, 3.5883259587098713`*^9, 
   3.5883269170985546`*^9, 3.5883278604644117`*^9, 3.5883279296193333`*^9, 
   3.5883280196158915`*^9, 3.588328473966689*^9, 3.588328558128837*^9, 
   3.588329397536112*^9, {3.588329680973009*^9, 3.588329704497851*^9}, 
   3.588329912788416*^9, 3.6151308262268596`*^9, 3.6151310083076844`*^9, 
   3.619089166320088*^9, 3.619626215679158*^9, 3.6205425719185786`*^9}],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{
  3.582347796544318*^9, 3.582353855035252*^9, 3.582353967888057*^9, 
   3.5831330412560987`*^9, 3.583133261155085*^9, 3.583133302822758*^9, 
   3.5831333348028145`*^9, 3.5831353252893105`*^9, 3.583138088274564*^9, 
   3.583138209222576*^9, 3.5831466229958067`*^9, 3.5831501733754435`*^9, 
   3.583150224356333*^9, 3.5831502725916176`*^9, {3.5879651845218616`*^9, 
   3.5879652046146965`*^9}, 3.58807987362243*^9, 3.5880799568329763`*^9, 
   3.5880833301881084`*^9, 3.588083692732745*^9, 3.5883190717121906`*^9, 
   3.5883191701951637`*^9, 3.588325827435641*^9, 3.5883259587098713`*^9, 
   3.5883269170985546`*^9, 3.5883278604644117`*^9, 3.5883279296193333`*^9, 
   3.5883280196158915`*^9, 3.588328473966689*^9, 3.588328558128837*^9, 
   3.588329397536112*^9, {3.588329680973009*^9, 3.588329704497851*^9}, 
   3.588329912788416*^9, 3.6151308262268596`*^9, 3.6151310083076844`*^9, 
   3.619089166320088*^9, 3.619626215679158*^9, 3.6205425719185786`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"T4", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}], ",", 
     RowBox[{"-", "d"}]}], "]"}], ",", "M4", ",", 
   RowBox[{"PrintAs", "\[Rule]", "\"\<T\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5450649705892844`*^9, 3.545064989699318*^9}, {
  3.5451107209700923`*^9, 3.5451107263521023`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"T4", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}], ",", 
     RowBox[{"-", "d"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", xAct`xTensor`DefTensor, ": Defining ", "tensor ", 
   $CellContext`T4[-$CellContext`a, -$CellContext`b, -$CellContext`c, \
-$CellContext`d], ". ", ""],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.587965204645897*^9, 3.5880798736536303`*^9, 3.588079956848576*^9, 
   3.588083330234908*^9, 3.5880836929667454`*^9, 3.588319071743391*^9, 
   3.588319170226364*^9, 3.5883258274668407`*^9, 3.5883259587254715`*^9, 
   3.588326917114155*^9, 3.588327860480012*^9, 3.588327929650533*^9, 
   3.588328019631491*^9, 3.5883284739978895`*^9, 3.5883285581444373`*^9, 
   3.5883293975517116`*^9, {3.5883296811134095`*^9, 3.588329704529051*^9}, 
   3.5883299128040156`*^9, 3.6151308262768593`*^9, 3.6151310083544846`*^9, 
   3.619089166370088*^9, 3.6196262157391586`*^9, 3.620542571958579*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"\[CapitalSigma]2", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], ",", "M4", ",", 
   RowBox[{"PrintAs", "\[Rule]", "\"\<\[CapitalSigma]\>\""}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5450649705892844`*^9, 3.545064989699318*^9}, {
  3.545110131281456*^9, 3.545110135789864*^9}, {3.5451107284113054`*^9, 
  3.5451107330445137`*^9}, {3.5822826873528094`*^9, 3.5822826946380224`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"\[CapitalSigma]2", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", xAct`xTensor`DefTensor, ": Defining ", "tensor ", 
   $CellContext`\[CapitalSigma]2[-$CellContext`a, -$CellContext`b], ". ", ""],
  
  Editable->False]], "Print",
 CellChangeTimes->{
  3.587965204661497*^9, 3.58807987366923*^9, 3.5880799568641763`*^9, 
   3.5880833302661085`*^9, 3.588083693216346*^9, 3.5883190717745905`*^9, 
   3.5883191702575636`*^9, 3.5883258274668407`*^9, 3.5883259587410717`*^9, 
   3.588326917129755*^9, 3.588327860495612*^9, 3.5883279296973333`*^9, 
   3.588328019647091*^9, 3.5883284739978895`*^9, 3.588328558160037*^9, 
   3.5883293975673113`*^9, {3.5883296811134095`*^9, 3.588329704529051*^9}, 
   3.5883299128196154`*^9, 3.6151308262868595`*^9, 3.6151310083544846`*^9, 
   3.619089166370088*^9, 3.6196262157391586`*^9, 3.620542571958579*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ImposeSym", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalSigma]2", "[", 
     RowBox[{"d", ",", 
      RowBox[{"-", "f"}]}], "]"}], 
    RowBox[{"T4", "[", 
     RowBox[{
      RowBox[{"-", "c"}], ",", 
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}], ",", "g"}], "]"}]}], ",", 
   RowBox[{"IndexList", "[", 
    RowBox[{
     RowBox[{"-", "f"}], ",", 
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", "d", ",", "g"}], "]"}], ",", 
   RowBox[{"JoinSGS", "[", 
    RowBox[{
     RowBox[{"Symmetric", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}], "]"}], ",", 
     RowBox[{"Antisymmetric", "[", 
      RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}], "]"}]}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[GridBox[{
     {
      RowBox[{
       UnderscriptBox["Sym", 
        StyleBox[
         RowBox[{
          RowBox[{"(", "36", ")"}], "[", "45", "]"}],
         FontSize->Tiny]], "[", "T", "\[CapitalSigma]", "]"}], 
      StyleBox[GridBox[{
         {" ", " ", " ", "g", "d", " "},
         {"c", "a", "b", " ", " ", "f"}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.], {
             Offset[0.034999999999999996`]}, 
            Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
             Offset[0.]}}, "RowsIndexed" -> {}}],
       FontSize->Rational[39, 4]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.034999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   ShowAutoStyles->False,
   AutoSpacing->False],
  xAct`SymManipulator`SymH[{$CellContext`T4, $CellContext`\[CapitalSigma]2}, 
   xAct`xPerm`StrongGenSet[{3, 4, 5, 6}, 
    xAct`xPerm`GenSet[-xAct`xPerm`Cycles[{4, 5}], 
     xAct`xPerm`Cycles[{3, 6}]]], 
   "(36)[45]"][-$CellContext`c, -$CellContext`a, -$CellContext`b, \
$CellContext`g, $CellContext`d, -$CellContext`f],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.5823477966223183`*^9, 3.582353855113252*^9, 3.5823539679504576`*^9, 
   3.5831330413184986`*^9, 3.583133261233085*^9, 3.5831333029007587`*^9, 
   3.5831333348652143`*^9, 3.583135325351711*^9, 3.5831380883369637`*^9, 
   3.583138209300576*^9, 3.5831466230426064`*^9, 3.5831501734378433`*^9, 
   3.5831502244187326`*^9, 3.5831502726540174`*^9, {3.5879651862534647`*^9, 
   3.587965204677097*^9}, 3.5880798736848297`*^9, 3.588079956879776*^9, 
   3.588083330312908*^9, 3.5880836934191465`*^9, 3.588319071805791*^9, 
   3.588319170288764*^9, 3.588325827498041*^9, 3.588325958756672*^9, 
   3.5883269171609545`*^9, 3.588327860526812*^9, 3.5883279297129335`*^9, 
   3.588328019662691*^9, 3.5883284740290895`*^9, 3.5883285581756372`*^9, 
   3.588329397614112*^9, {3.5883296811446095`*^9, 3.5883297045602508`*^9}, 
   3.588329912850816*^9, 3.6151308262968597`*^9, 3.6151310083700843`*^9, 
   3.619089166390088*^9, 3.619626215759158*^9, 3.6205425719785786`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input"],

Cell[BoxData["\<\"T_{ca(b}{}^{[g}\\\\Sigma^{d]}{}_{f)}\"\>"], "Output",
 CellChangeTimes->{
  3.5823477966535187`*^9, 3.582353855144452*^9, 3.5823539680128574`*^9, 
   3.583133041349699*^9, 3.583133261264285*^9, 3.583133302931958*^9, 
   3.5831333348808146`*^9, 3.5831353253829107`*^9, 3.5831380885553637`*^9, 
   3.5831382093161764`*^9, 3.583146623073807*^9, 3.5831501734690433`*^9, 
   3.583150224449933*^9, 3.583150272685218*^9, {3.5879651863158646`*^9, 
   3.587965204708297*^9}, 3.5880798737316303`*^9, 3.5880799569109764`*^9, 
   3.588083330359709*^9, 3.5880836934503465`*^9, 3.588319071852591*^9, 
   3.588319170319964*^9, 3.588325827529241*^9, 3.5883259587878714`*^9, 
   3.5883269171765547`*^9, 3.588327860542412*^9, 3.5883279297441335`*^9, 
   3.5883280197094917`*^9, 3.588328474044689*^9, 3.588328558206837*^9, 
   3.5883293976297116`*^9, {3.58832968117581*^9, 3.5883297045758505`*^9}, 
   3.5883299128820157`*^9, 3.6151308263568597`*^9, 3.6151310084324846`*^9, 
   3.6190891664400883`*^9, 3.6196262158091583`*^9, 3.6205425720185785`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "@", 
  RowBox[{"Antisymmetrize", "[", 
   RowBox[{
    RowBox[{"T4", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}], ",", 
      RowBox[{"-", "c"}], ",", 
      RowBox[{"-", "d"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}], ",", 
      RowBox[{"-", "c"}], ",", 
      RowBox[{"-", "d"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5822821755699935`*^9, 3.582282204586045*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "b", "c", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`b, -$CellContext`c, \
-$CellContext`d],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "b", "d", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`b, -$CellContext`d, \
-$CellContext`c],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "c", "b", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`c, -$CellContext`b, \
-$CellContext`d],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "c", "d", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`c, -$CellContext`d, \
-$CellContext`b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "d", "b", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`d, -$CellContext`b, \
-$CellContext`c],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "d", "c", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`d, -$CellContext`c, \
-$CellContext`b],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"b", "a", "c", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, -$CellContext`a, -$CellContext`c, \
-$CellContext`d],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"b", "a", "d", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, -$CellContext`a, -$CellContext`d, \
-$CellContext`c],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"b", "c", "a", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, -$CellContext`c, -$CellContext`a, \
-$CellContext`d],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"b", "c", "d", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, -$CellContext`c, -$CellContext`d, \
-$CellContext`a],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"b", "d", "a", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, -$CellContext`d, -$CellContext`a, \
-$CellContext`c],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"b", "d", "c", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, -$CellContext`d, -$CellContext`c, \
-$CellContext`a],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "a", "b", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`a, -$CellContext`b, \
-$CellContext`d],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "a", "d", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`a, -$CellContext`d, \
-$CellContext`b],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "b", "a", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`b, -$CellContext`a, \
-$CellContext`d],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "b", "d", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`b, -$CellContext`d, \
-$CellContext`a],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "d", "a", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`d, -$CellContext`a, \
-$CellContext`b],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "d", "b", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`d, -$CellContext`b, \
-$CellContext`a],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "a", "b", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`a, -$CellContext`b, \
-$CellContext`c],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "a", "c", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`a, -$CellContext`c, \
-$CellContext`b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "b", "a", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`b, -$CellContext`a, \
-$CellContext`c],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "b", "c", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`b, -$CellContext`c, \
-$CellContext`a],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "c", "a", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`c, -$CellContext`a, \
-$CellContext`b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "c", "b", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`c, -$CellContext`b, \
-$CellContext`a],
    Editable->False]}]}]], "Output",
 CellChangeTimes->{
  3.582347796684718*^9, 3.5823538551756525`*^9, 3.5823539680284576`*^9, 
   3.583133041380899*^9, 3.583133271965904*^9, 3.5831333029631586`*^9, 
   3.5831333349120145`*^9, 3.583135325414111*^9, 3.583138088586564*^9, 
   3.5831382093473763`*^9, 3.5831466231050067`*^9, 3.583150173500243*^9, 
   3.5831502244811325`*^9, 3.5831502727164173`*^9, {3.587965186347065*^9, 
   3.587965204739497*^9}, 3.5880798737628303`*^9, 3.5880799569421763`*^9, 
   3.5880833304221087`*^9, 3.5880836938403473`*^9, 3.588319071883791*^9, 
   3.588319170366764*^9, 3.588325827560441*^9, 3.588325958819072*^9, 
   3.588326917207755*^9, 3.588327860573612*^9, 3.5883279297753334`*^9, 
   3.5883280197406917`*^9, 3.5883284740758896`*^9, 3.588328558238037*^9, 
   3.5883293976609116`*^9, {3.58832968120701*^9, 3.588329704622651*^9}, 
   3.5883299129132156`*^9, 3.61513082638686*^9, 3.6151310084480844`*^9, 
   3.6190891664700885`*^9, 3.6196262158491583`*^9, 3.6205425720585785`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr2", "=", 
  RowBox[{"%", "/.", 
   RowBox[{
    RowBox[{"T4", "[", 
     RowBox[{
      RowBox[{"-", "b"}], ",", "c_", ",", "d_", ",", "a_"}], "]"}], 
    "\[RightTeeArrow]", 
    RowBox[{
     RowBox[{"T4", "[", 
      RowBox[{
       RowBox[{"-", "b"}], ",", "f", ",", "d", ",", "a"}], "]"}], 
     RowBox[{"\[CapitalSigma]2", "[", 
      RowBox[{"g", ",", 
       RowBox[{"-", "f"}]}], "]"}], 
     RowBox[{"\[CapitalSigma]2", "[", 
      RowBox[{"c", ",", 
       RowBox[{"-", "g"}]}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.5822824818068485`*^9, 3.5822826115678763`*^9}, {
  3.582282713061654*^9, 3.582282758301734*^9}, {3.5823537640402923`*^9, 
  3.5823537661306963`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "b", "c", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`b, -$CellContext`c, \
-$CellContext`d],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "b", "d", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`b, -$CellContext`d, \
-$CellContext`c],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "c", "b", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`c, -$CellContext`b, \
-$CellContext`d],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "c", "d", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`c, -$CellContext`d, \
-$CellContext`b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "d", "b", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`d, -$CellContext`b, \
-$CellContext`c],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "d", "c", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`d, -$CellContext`c, \
-$CellContext`b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "a", "b", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`a, -$CellContext`b, \
-$CellContext`d],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "a", "d", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`a, -$CellContext`d, \
-$CellContext`b],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "b", "a", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`b, -$CellContext`a, \
-$CellContext`d],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "b", "d", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`b, -$CellContext`d, \
-$CellContext`a],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "d", "a", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`d, -$CellContext`a, \
-$CellContext`b],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "d", "b", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`d, -$CellContext`b, \
-$CellContext`a],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "a", "b", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`a, -$CellContext`b, \
-$CellContext`c],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "a", "c", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`a, -$CellContext`c, \
-$CellContext`b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "b", "a", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`b, -$CellContext`a, \
-$CellContext`c],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "b", "c", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`b, -$CellContext`c, \
-$CellContext`a],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "c", "a", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`c, -$CellContext`a, \
-$CellContext`b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "c", "b", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`c, -$CellContext`b, \
-$CellContext`a],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", "e", " ", " "},
           {"b", " ", "c", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`c, \
-$CellContext`d],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"a", "f"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`a, -$CellContext`f],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {"f", " "},
           {" ", "e"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", "e", " ", " "},
           {"b", " ", "d", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`d, \
-$CellContext`c],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"a", "f"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`a, -$CellContext`f],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {"f", " "},
           {" ", "e"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", "e", " ", " "},
           {"b", " ", "a", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`a, \
-$CellContext`d],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"c", "f"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`c, -$CellContext`f],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {"f", " "},
           {" ", "e"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", "e", " ", " "},
           {"b", " ", "d", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`d, \
-$CellContext`a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"c", "f"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`c, -$CellContext`f],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {"f", " "},
           {" ", "e"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", "e", " ", " "},
           {"b", " ", "a", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`a, \
-$CellContext`c],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"d", "f"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`d, -$CellContext`f],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {"f", " "},
           {" ", "e"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", "e", " ", " "},
           {"b", " ", "c", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`c, \
-$CellContext`a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"d", "f"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`d, -$CellContext`f],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {"f", " "},
           {" ", "e"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
    Editable->False]}]}]], "Output",
 CellChangeTimes->{
  3.5823477967159185`*^9, 3.5823538552068524`*^9, 3.5823539680596576`*^9, 
   3.583133041427699*^9, 3.583133272012704*^9, 3.583133302994358*^9, 
   3.583133334943215*^9, 3.5831353254453106`*^9, 3.583138088633364*^9, 
   3.5831382093941765`*^9, 3.5831466235262074`*^9, 3.5831501735314436`*^9, 
   3.583150224527933*^9, 3.5831502727476177`*^9, {3.587965186581065*^9, 
   3.587965204786297*^9}, 3.5880798738096304`*^9, 3.5880799569733763`*^9, 
   3.588083330468909*^9, 3.5880836960555506`*^9, 3.588319071930591*^9, 
   3.5883191704135637`*^9, 3.5883258275916414`*^9, 3.5883259588502717`*^9, 
   3.588326917238955*^9, 3.5883278606048117`*^9, 3.588327929806534*^9, 
   3.5883280197718916`*^9, 3.5883284741226892`*^9, 3.5883285582692375`*^9, 
   3.588329397692112*^9, {3.5883296812382097`*^9, 3.5883297046538506`*^9}, 
   3.588329912944416*^9, 3.6151308264168596`*^9, 3.6151310084792843`*^9, 
   3.6190891665000887`*^9, 3.6196262159091587`*^9, 3.6205425721085787`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexPrintPageWidth", "=", "latextextwidth"}], ";"}]], "Input",
 CellChangeTimes->{{3.588329844241895*^9, 3.588329854725114*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "expr2"}]], "Input",
 CellChangeTimes->{{3.5822824226515446`*^9, 3.5822824256467495`*^9}, 
   3.588083416003859*^9}],

Cell[BoxData["\<\"\\\\tfrac{1}{24} T_{abcd} -  \\\\tfrac{1}{24} T_{abdc} -  \
\\\\tfrac{1}{24} T_{acbd} + \\\\tfrac{1}{24} T_{acdb} + \\\\tfrac{1}{24} \
T_{adbc} -  \\\\tfrac{1}{24} T_{adcb} + \\\\tfrac{1}{24} T_{cabd} -  \
\\\\tfrac{1}{24} T_{cadb} -  \\\\tfrac{1}{24} T_{cbad} + \\\\tfrac{1}{24} \
T_{cbda} + \\\\tfrac{1}{24} T_{cdab} -  \\\\tfrac{1}{24} T_{cdba} -  \
\\\\tfrac{1}{24} T_{dabc} + \\\\tfrac{1}{24} T_{dacb} + \\\\tfrac{1}{24} \
T_{dbac} -  \\\\tfrac{1}{24} T_{dbca} -  \\\\tfrac{1}{24} T_{dcab} + \
\\\\tfrac{1}{24} T_{dcba} -  \\\\tfrac{1}{24} T_{b}{}^{e}{}_{cd} \
\\\\Sigma_{af} \\\\Sigma^{f}{}_{e} + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{dc} \
\\\\Sigma_{af} \\\\Sigma^{f}{}_{e} + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{ad} \
\\\\Sigma_{cf} \\\\Sigma^{f}{}_{e} -  \\\\tfrac{1}{24} T_{b}{}^{e}{}_{da} \
\\\\Sigma_{cf} \\\\Sigma^{f}{}_{e} -  \\\\tfrac{1}{24} T_{b}{}^{e}{}_{ac} \
\\\\Sigma_{df} \\\\Sigma^{f}{}_{e} + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{ca} \
\\\\Sigma_{df} \\\\Sigma^{f}{}_{e}\"\>"], "Output",
 CellChangeTimes->{
  3.582347796903119*^9, 3.582353855378453*^9, 3.582353968262458*^9, 
   3.5831330415992994`*^9, 3.5831332721999044`*^9, 3.583133303197159*^9, 
   3.5831333351148148`*^9, 3.5831353256637115`*^9, 3.5831380889141645`*^9, 
   3.583138209643777*^9, 3.5831466237290077`*^9, 3.583150173703044*^9, 
   3.5831502246995335`*^9, 3.583150272919218*^9, {3.5879651867994657`*^9, 
   3.587965204957897*^9}, 3.588079873996831*^9, 3.5880799571449766`*^9, 
   3.588083330671709*^9, 3.58808341653426*^9, 3.5880834574531317`*^9, 
   3.5880836966951523`*^9, 3.5883190721177917`*^9, 3.5883191706007643`*^9, 
   3.5883258277632413`*^9, 3.588325959037472*^9, 3.588326917410555*^9, 
   3.588327860792012*^9, 3.588327929978134*^9, 3.588328019943492*^9, 
   3.58832847429429*^9, 3.588328558440838*^9, 3.588329429110567*^9, {
   3.5883296831102133`*^9, 3.588329721954281*^9}, 3.5883298199994526`*^9, 
   3.5883298577671185`*^9, 3.588329913131616*^9, 3.6151308409868803`*^9, 
   3.615131008557285*^9, 3.6190891665800886`*^9, 3.6196262159891586`*^9, 
   3.6205425721785793`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexBreak", "[", 
  RowBox[{"%", ",", "210", ",", " ", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"TexBreakBy", "\[Rule]", "\"\<TexPoint\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.588083333604514*^9, 3.5880834089838467`*^9}, 
   3.588083454551527*^9}],

Cell[BoxData["\<\"\\\\tfrac{1}{24} T_{abcd} -  \\\\tfrac{1}{24} T_{abdc} -  \
\\\\tfrac{1}{24} T_{acbd} + \\\\tfrac{1}{24} T_{acdb} \\\\nonumber \\\\\\\\ \
\\n&& + \\\\tfrac{1}{24} T_{adbc} -  \\\\tfrac{1}{24} T_{adcb} + \
\\\\tfrac{1}{24} T_{cabd} -  \\\\tfrac{1}{24} T_{cadb} \\\\nonumber \\\\\\\\ \
\\n&& -  \\\\tfrac{1}{24} T_{cbad} + \\\\tfrac{1}{24} T_{cbda} + \
\\\\tfrac{1}{24} T_{cdab} -  \\\\tfrac{1}{24} T_{cdba} \\\\nonumber \\\\\\\\ \
\\n&& -  \\\\tfrac{1}{24} T_{dabc} + \\\\tfrac{1}{24} T_{dacb} + \
\\\\tfrac{1}{24} T_{dbac} -  \\\\tfrac{1}{24} T_{dbca} \\\\nonumber \\\\\\\\ \
\\n&& -  \\\\tfrac{1}{24} T_{dcab} + \\\\tfrac{1}{24} T_{dcba} -  \
\\\\tfrac{1}{24} T_{b}{}^{e}{}_{cd} \\\\Sigma_{af} \\\\Sigma^{f}{}_{e} \
\\\\nonumber \\\\\\\\ \\n&& + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{dc} \
\\\\Sigma_{af} \\\\Sigma^{f}{}_{e} + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{ad} \
\\\\Sigma_{cf} \\\\Sigma^{f}{}_{e} \\\\nonumber \\\\\\\\ \\n&& -  \
\\\\tfrac{1}{24} T_{b}{}^{e}{}_{da} \\\\Sigma_{cf} \\\\Sigma^{f}{}_{e} -  \
\\\\tfrac{1}{24} T_{b}{}^{e}{}_{ac} \\\\Sigma_{df} \\\\Sigma^{f}{}_{e} \
\\\\nonumber \\\\\\\\ \\n&& + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{ca} \
\\\\Sigma_{df} \\\\Sigma^{f}{}_{e}\"\>"], "Output",
 CellChangeTimes->{
  3.582347797199519*^9, 3.5823538555188527`*^9, 3.5823539683716583`*^9, 
   3.583133042519701*^9, 3.583133272309105*^9, 3.583133303353159*^9, 
   3.583133335224015*^9, 3.583135325772911*^9, 3.583138089054565*^9, 
   3.583138209752977*^9, 3.5831466244466095`*^9, 3.5831501738278437`*^9, 
   3.583150224808734*^9, 3.5831502730440183`*^9, {3.5879651868150654`*^9, 
   3.587965205160698*^9}, 3.588079874714432*^9, 3.5880799572853765`*^9, {
   3.588083390997015*^9, 3.5880834173922615`*^9}, 3.588083458014733*^9, 
   3.5880836968667526`*^9, 3.588319072242592*^9, 3.588319170725565*^9, 
   3.5883258278880415`*^9, 3.588325959177872*^9, 3.5883269175353556`*^9, 
   3.5883278609324126`*^9, 3.5883279300873337`*^9, 3.588328020052692*^9, 
   3.58832847443469*^9, 3.5883285585500383`*^9, 3.5883294311229706`*^9, 
   3.588329683250613*^9, 3.588329723545484*^9, 3.5883298210134544`*^9, 
   3.5883298582975197`*^9, 3.588329913240816*^9, 3.6151308421968822`*^9, 
   3.6151310124260917`*^9, 3.6190891667000885`*^9, 3.6196262161991587`*^9, 
   3.6205425724685793`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalSigma]2", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], 
   RowBox[{"\[CapitalSigma]2", "[", 
    RowBox[{
     RowBox[{"-", "c"}], ",", 
     RowBox[{"-", "d"}]}], "]"}]}], "==", "expr2"}]], "Input",
 CellChangeTimes->{{3.582353811682776*^9, 3.5823538268928027`*^9}, {
  3.5883191978384123`*^9, 3.5883192064340277`*^9}, {3.5883193231222324`*^9, 
  3.5883193246822352`*^9}, {3.5883258028967977`*^9, 3.5883258077484064`*^9}, {
  3.5883298853011675`*^9, 3.5883298866115694`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"a", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`a, -$CellContext`b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"c", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`c, -$CellContext`d],
    Editable->False]}], "\[Equal]", 
  RowBox[{
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"a", "b", "c", "d"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`a, -$CellContext`b, -$CellContext`c, \
-$CellContext`d],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"a", "b", "d", "c"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`a, -$CellContext`b, -$CellContext`d, \
-$CellContext`c],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"a", "c", "b", "d"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`a, -$CellContext`c, -$CellContext`b, \
-$CellContext`d],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"a", "c", "d", "b"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`a, -$CellContext`c, -$CellContext`d, \
-$CellContext`b],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"a", "d", "b", "c"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`a, -$CellContext`d, -$CellContext`b, \
-$CellContext`c],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"a", "d", "c", "b"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`a, -$CellContext`d, -$CellContext`c, \
-$CellContext`b],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"c", "a", "b", "d"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`c, -$CellContext`a, -$CellContext`b, \
-$CellContext`d],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"c", "a", "d", "b"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`c, -$CellContext`a, -$CellContext`d, \
-$CellContext`b],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"c", "b", "a", "d"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`c, -$CellContext`b, -$CellContext`a, \
-$CellContext`d],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"c", "b", "d", "a"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`c, -$CellContext`b, -$CellContext`d, \
-$CellContext`a],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"c", "d", "a", "b"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`c, -$CellContext`d, -$CellContext`a, \
-$CellContext`b],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"c", "d", "b", "a"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`c, -$CellContext`d, -$CellContext`b, \
-$CellContext`a],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"d", "a", "b", "c"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`d, -$CellContext`a, -$CellContext`b, \
-$CellContext`c],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"d", "a", "c", "b"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`d, -$CellContext`a, -$CellContext`c, \
-$CellContext`b],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"d", "b", "a", "c"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`d, -$CellContext`b, -$CellContext`a, \
-$CellContext`c],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"d", "b", "c", "a"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`d, -$CellContext`b, -$CellContext`c, \
-$CellContext`a],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"d", "c", "a", "b"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`d, -$CellContext`c, -$CellContext`a, \
-$CellContext`b],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"d", "c", "b", "a"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`d, -$CellContext`c, -$CellContext`b, \
-$CellContext`a],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", "e", " ", " "},
            {"b", " ", "c", "d"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`c, \
-$CellContext`d],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {" ", " "},
            {"a", "f"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[-$CellContext`a, -$CellContext`f],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {"f", " "},
            {" ", "e"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", "e", " ", " "},
            {"b", " ", "d", "c"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`d, \
-$CellContext`c],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {" ", " "},
            {"a", "f"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[-$CellContext`a, -$CellContext`f],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {"f", " "},
            {" ", "e"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", "e", " ", " "},
            {"b", " ", "a", "d"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`a, \
-$CellContext`d],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {" ", " "},
            {"c", "f"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[-$CellContext`c, -$CellContext`f],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {"f", " "},
            {" ", "e"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", "e", " ", " "},
            {"b", " ", "d", "a"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`d, \
-$CellContext`a],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {" ", " "},
            {"c", "f"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[-$CellContext`c, -$CellContext`f],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {"f", " "},
            {" ", "e"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", "e", " ", " "},
            {"b", " ", "a", "c"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`a, \
-$CellContext`c],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {" ", " "},
            {"d", "f"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[-$CellContext`d, -$CellContext`f],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {"f", " "},
            {" ", "e"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", "e", " ", " "},
            {"b", " ", "c", "a"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`c, \
-$CellContext`a],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {" ", " "},
            {"d", "f"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[-$CellContext`d, -$CellContext`f],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {"f", " "},
            {" ", "e"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
     Editable->False]}]}]}]], "Output",
 CellChangeTimes->{
  3.5823538555500526`*^9, 3.5823539684028583`*^9, 3.583133042566501*^9, {
   3.5831332814195204`*^9, 3.583133303399959*^9}, 3.5831333353176155`*^9, 
   3.5831353258041115`*^9, 3.583138089101365*^9, 3.5831382097841773`*^9, 
   3.5831466253046103`*^9, 3.583150173859044*^9, 3.5831502248555336`*^9, 
   3.583150273075218*^9, {3.5879651870334663`*^9, 3.5879652052074976`*^9}, 
   3.588079875931234*^9, 3.588079957316577*^9, 3.5880834641455436`*^9, {
   3.588083569570529*^9, 3.5880836152318087`*^9}, 3.588083699237956*^9, 
   3.5883190722893915`*^9, 3.5883191708191648`*^9, {3.588319203314022*^9, 
   3.5883192068708277`*^9}, 3.588319325056636*^9, {3.5883258279504414`*^9, 
   3.5883258690253143`*^9}, {3.5883259592402725`*^9, 
   3.5883259764315023`*^9}, {3.5883269175977554`*^9, 3.588326932027781*^9}, 
   3.588327861884014*^9, 3.588327930149734*^9, 3.588328020099492*^9, 
   3.588328058007559*^9, 3.5883294358809786`*^9, 3.5883297311738977`*^9, 
   3.5883297802203836`*^9, 3.588329826395464*^9, {3.5883298602475233`*^9, 
   3.5883299132720165`*^9}, 3.6151310317389255`*^9, 3.6190891667300887`*^9, 
   3.6196262163291593`*^9, 3.6205425725185795`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrintAlignedEquations", "@", "%"}]], "Input",
 CellChangeTimes->{{3.5823538307928095`*^9, 3.5823538334448137`*^9}}],

Cell[BoxData["\<\"\\\\begin{align}\\n\\\\Sigma_{ab} \
\\\\Sigma_{cd}={}&\\\\tfrac{1}{24} T_{abcd}\\n -  \\\\tfrac{1}{24} \
T_{abdc}\\n -  \\\\tfrac{1}{24} T_{acbd}\\n + \\\\tfrac{1}{24} T_{acdb}\\n + \
\\\\tfrac{1}{24} T_{adbc}\\n -  \\\\tfrac{1}{24} T_{adcb}\\n + \
\\\\tfrac{1}{24} T_{cabd}\\\\nonumber\\\\\\\\\\n& -  \\\\tfrac{1}{24} \
T_{cadb}\\n -  \\\\tfrac{1}{24} T_{cbad}\\n + \\\\tfrac{1}{24} T_{cbda}\\n + \
\\\\tfrac{1}{24} T_{cdab}\\n -  \\\\tfrac{1}{24} T_{cdba}\\n -  \
\\\\tfrac{1}{24} T_{dabc}\\\\nonumber\\\\\\\\\\n& + \\\\tfrac{1}{24} T_{dacb}\
\\n + \\\\tfrac{1}{24} T_{dbac}\\n -  \\\\tfrac{1}{24} T_{dbca}\\n -  \
\\\\tfrac{1}{24} T_{dcab}\\n + \\\\tfrac{1}{24} \
T_{dcba}\\\\nonumber\\\\\\\\\\n& -  \\\\tfrac{1}{24} T_{b}{}^{e}{}_{cd} \
\\\\Sigma_{af} \\\\Sigma^{f}{}_{e}\\n + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{dc} \
\\\\Sigma_{af} \\\\Sigma^{f}{}_{e}\\n + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{ad} \
\\\\Sigma_{cf} \\\\Sigma^{f}{}_{e}\\\\nonumber\\\\\\\\\\n& -  \
\\\\tfrac{1}{24} T_{b}{}^{e}{}_{da} \\\\Sigma_{cf} \\\\Sigma^{f}{}_{e}\\n -  \
\\\\tfrac{1}{24} T_{b}{}^{e}{}_{ac} \\\\Sigma_{df} \\\\Sigma^{f}{}_{e}\\n + \
\\\\tfrac{1}{24} T_{b}{}^{e}{}_{ca} \\\\Sigma_{df} \
\\\\Sigma^{f}{}_{e}.\\n\\\\end{align}\"\>"], "Output",
 CellChangeTimes->{
  3.582353855940054*^9, 3.582353968777259*^9, 3.5831330436429033`*^9, {
   3.583133281809521*^9, 3.58313330380556*^9}, 3.583133335707616*^9, 
   3.5831353261941123`*^9, 3.583138091238569*^9, 3.583138210189778*^9, 
   3.583146625725811*^9, 3.583150174295845*^9, 3.583150225245534*^9, 
   3.583150273449619*^9, {3.5879651872674665`*^9, 3.5879652055818987`*^9}, 
   3.588079876477235*^9, 3.5880799577065773`*^9, 3.5880834653311453`*^9, 
   3.5880835706313305`*^9, 3.5880836160898104`*^9, 3.588083699674757*^9, 
   3.588319076657399*^9, 3.5883191712091656`*^9, 3.5883192109892354`*^9, 
   3.5883193260082374`*^9, 3.5883258286368427`*^9, 3.588325870694517*^9, {
   3.588329889076374*^9, 3.588329913677617*^9}, 3.615131034749731*^9, 
   3.6190891670300894`*^9, 3.6196262166091595`*^9, 3.6205425727785797`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"UndefTensor", "/@", "$Tensors"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"tensor\"\>", "\[InvisibleSpace]", "\<\" \"\>", 
   "\[InvisibleSpace]", "T4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "tensor", 
   " ", $CellContext`T4],
  Editable->False]], "Print",
 CellChangeTimes->{3.5879652056442986`*^9, 3.5880798765084352`*^9, 
  3.5880799577221775`*^9, 3.588083622735422*^9, 3.588083699721557*^9, 
  3.5883299136932173`*^9, 3.6151310380881367`*^9, 3.6190891670300894`*^9, 
  3.6196262166191597`*^9, 3.62054257285858*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"tensor\"\>", "\[InvisibleSpace]", "\<\" \"\>", 
   "\[InvisibleSpace]", "\[CapitalSigma]2"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "tensor", 
   " ", $CellContext`\[CapitalSigma]2],
  Editable->False]], "Print",
 CellChangeTimes->{3.5879652056442986`*^9, 3.5880798765084352`*^9, 
  3.5880799577221775`*^9, 3.588083622735422*^9, 3.588083699721557*^9, 
  3.5883299136932173`*^9, 3.6151310380881367`*^9, 3.6190891670300894`*^9, 
  3.6196262166191597`*^9, 3.62054257285858*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Null", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.5879652056442986`*^9, 3.5880798765084352`*^9, 
  3.5880799577221775`*^9, 3.5880836227510223`*^9, 3.588083699721557*^9, 
  3.5883299136932173`*^9, 3.6151310380881367`*^9, 3.619089167040089*^9, 
  3.6196262166191597`*^9, 3.62054257285858*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"UndefManifold", "[", "M4", "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefVBundle", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"vbundle\"\>", "\[InvisibleSpace]", "\<\" \"\>", 
   "\[InvisibleSpace]", 
   InterpretationBox[
    StyleBox["\[DoubleStruckCapitalT]M4",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`TangentM4,
    Editable->False]}],
  SequenceForm[
  "** ", xAct`xTensor`UndefVBundle, ": Undefined ", "vbundle", 
   " ", $CellContext`TangentM4],
  Editable->False]], "Print",
 CellChangeTimes->{3.5831502255107346`*^9, 3.583150273652419*^9, 
  3.5879652057222986`*^9, 3.5880798766176353`*^9, 3.5880799578001776`*^9, 
  3.5880836234218235`*^9, 3.588083699815158*^9, 3.5883299137712173`*^9, 
  3.6151310381661367`*^9, 3.6190891671100893`*^9, 3.6196262166891594`*^9, 
  3.6205425729285803`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefManifold", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"manifold\"\>", "\[InvisibleSpace]", "\<\" \"\>", 
   "\[InvisibleSpace]", "M4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefManifold, ": Undefined ", "manifold", 
   " ", $CellContext`M4],
  Editable->False]], "Print",
 CellChangeTimes->{3.5831502255107346`*^9, 3.583150273652419*^9, 
  3.5879652057222986`*^9, 3.5880798766176353`*^9, 3.5880799578001776`*^9, 
  3.5880836234218235`*^9, 3.588083699815158*^9, 3.5883299137712173`*^9, 
  3.6151310381661367`*^9, 3.6190891671100893`*^9, 3.6196262166891594`*^9, 
  3.6205425729285803`*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1005, 604},
WindowMargins->{{Automatic, 267}, {171, Automatic}},
ShowSelection->True,
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (July 1, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info3620546170-4902789"->{
  Cell[63918, 1559, 276, 5, 70, "Print",
   CellTags->"Info3620546170-4902789"],
  Cell[64294, 1572, 287, 5, 70, "Print",
   CellTags->"Info3620546170-4902789"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info3620546170-4902789", 491554, 12329}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 54, 1, 90, "Title"],
Cell[636, 25, 144, 6, 50, "Subtitle"],
Cell[783, 33, 378, 8, 126, "Subsubtitle"],
Cell[1164, 43, 748, 20, 107, "Text"],
Cell[CellGroupData[{
Cell[1937, 67, 71, 1, 63, "Section"],
Cell[CellGroupData[{
Cell[2033, 72, 86, 2, 31, "Input"],
Cell[2122, 76, 1539, 23, 31, "Output"]
}, Open  ]],
Cell[3676, 102, 1477, 29, 52, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[5178, 135, 36, 0, 43, "Subsection"],
Cell[5217, 137, 99, 1, 30, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5353, 143, 30, 0, 43, "Subsection"],
Cell[5386, 145, 3344, 71, 392, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[8767, 221, 39, 0, 35, "Subsection"],
Cell[8809, 223, 763, 34, 456, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[9609, 262, 39, 0, 35, "Subsection"],
Cell[9651, 264, 47, 0, 30, "Text"],
Cell[9701, 266, 340, 10, 52, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[10066, 280, 57, 0, 31, "Input"],
Cell[10126, 282, 1425, 20, 31, "Output"]
}, Open  ]],
Cell[11566, 305, 343, 14, 30, "Text"],
Cell[CellGroupData[{
Cell[11934, 323, 260, 7, 31, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[12219, 334, 286, 4, 23, "Print"],
Cell[12508, 340, 558, 12, 23, "Print"],
Cell[13069, 354, 307, 4, 23, "Print"],
Cell[13379, 360, 266, 3, 23, "Print"],
Cell[13648, 365, 247, 3, 23, "Print"],
Cell[13898, 370, 286, 4, 23, "Print"],
Cell[14187, 376, 557, 11, 23, "Print"],
Cell[14747, 389, 307, 4, 23, "Print"]
}, Open  ]],
Cell[15069, 396, 1417, 20, 31, "Output"]
}, Open  ]],
Cell[16501, 419, 124, 5, 30, "Text"],
Cell[16628, 426, 587, 17, 52, "Input",
 InitializationCell->True],
Cell[17218, 445, 24, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[17267, 449, 632, 15, 112, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[17924, 468, 1474, 21, 23, "Print"],
Cell[19401, 491, 1747, 28, 23, "Print"],
Cell[21151, 521, 1546, 22, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[22724, 547, 183, 4, 49, "Text"],
Cell[22910, 553, 1656, 27, 392, "Input",
 InitializationCell->True],
Cell[24569, 582, 88, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[24682, 588, 782, 18, 172, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[25489, 610, 1479, 21, 23, "Print"],
Cell[26971, 633, 1634, 23, 43, "Print"],
Cell[28608, 658, 1479, 21, 23, "Print"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[30148, 686, 41, 0, 35, "Subsection"],
Cell[30192, 688, 10150, 226, 1932, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[40379, 919, 48, 0, 35, "Subsection"],
Cell[CellGroupData[{
Cell[40452, 923, 101, 2, 31, "Input",
 InitializationCell->True],
Cell[40556, 927, 1430, 20, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42047, 954, 64, 1, 63, "Section"],
Cell[CellGroupData[{
Cell[42136, 959, 53, 0, 43, "Subsection"],
Cell[42192, 961, 53, 0, 30, "Text"],
Cell[42248, 963, 343, 8, 50, "Text"],
Cell[42594, 973, 1562, 26, 87, "Text"],
Cell[44159, 1001, 340, 6, 31, "Input",
 InitializationCell->True],
Cell[44502, 1009, 402, 10, 52, "Input",
 InitializationCell->True],
Cell[44907, 1021, 505, 15, 52, "Input",
 InitializationCell->True],
Cell[45415, 1038, 1179, 31, 112, "Input",
 InitializationCell->True],
Cell[46597, 1071, 1933, 57, 352, "Input",
 InitializationCell->True],
Cell[48533, 1130, 540, 17, 52, "Input",
 InitializationCell->True],
Cell[49076, 1149, 386, 11, 72, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[49499, 1165, 40, 0, 35, "Subsection"],
Cell[49542, 1167, 476, 7, 87, "Text"],
Cell[50021, 1176, 1837, 46, 192, "Input",
 InitializationCell->True],
Cell[51861, 1224, 5827, 127, 572, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[57725, 1356, 53, 0, 35, "Subsection"],
Cell[57781, 1358, 136, 3, 30, "Text"],
Cell[57920, 1363, 4916, 148, 472, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[62885, 1517, 68, 1, 63, "Section"],
Cell[CellGroupData[{
Cell[62978, 1522, 43, 0, 43, "Subsection"],
Cell[63024, 1524, 329, 8, 49, "Text"],
Cell[63356, 1534, 250, 8, 52, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[63643, 1547, 36, 0, 35, "Subsection"],
Cell[63682, 1549, 153, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[63860, 1556, 55, 1, 31, "Input"],
Cell[63918, 1559, 276, 5, 70, "Print",
 CellTags->"Info3620546170-4902789"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64231, 1569, 60, 1, 31, "Input"],
Cell[64294, 1572, 287, 5, 70, "Print",
 CellTags->"Info3620546170-4902789"]
}, Open  ]],
Cell[64596, 1580, 394, 10, 72, "Input",
 InitializationCell->True],
Cell[64993, 1592, 174, 3, 49, "Text"],
Cell[65170, 1597, 1008, 22, 72, "Input",
 InitializationCell->True],
Cell[66181, 1621, 197, 2, 30, "Text"],
Cell[66381, 1625, 750, 19, 92, "Input",
 InitializationCell->True],
Cell[67134, 1646, 55, 0, 30, "Text"],
Cell[67192, 1648, 468, 14, 52, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[67697, 1667, 34, 0, 35, "Subsection"],
Cell[67734, 1669, 1916, 56, 172, "Input",
 InitializationCell->True],
Cell[69653, 1727, 74, 0, 30, "Text"],
Cell[69730, 1729, 398, 14, 72, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[70165, 1748, 34, 0, 35, "Subsection"],
Cell[70202, 1750, 164, 5, 30, "Text"],
Cell[70369, 1757, 1784, 46, 152, "Input",
 InitializationCell->True],
Cell[72156, 1805, 216, 4, 30, "Text"],
Cell[72375, 1811, 254, 7, 31, "Input",
 InitializationCell->True],
Cell[72632, 1820, 131, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[72788, 1825, 136, 4, 31, "Input",
 InitializationCell->True],
Cell[72927, 1831, 1087, 15, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[74063, 1852, 36, 0, 35, "Subsection"],
Cell[74102, 1854, 1559, 47, 232, "Input",
 InitializationCell->True],
Cell[75664, 1903, 246, 5, 30, "Text",
 InitializationCell->True],
Cell[75913, 1910, 1978, 53, 112, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[77928, 1968, 34, 0, 35, "Subsection"],
Cell[77965, 1970, 59, 0, 30, "Text"],
Cell[78027, 1972, 534, 15, 52, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[78598, 1992, 34, 0, 35, "Subsection"],
Cell[78635, 1994, 344, 6, 49, "Text"],
Cell[78982, 2002, 378, 10, 31, "Input",
 InitializationCell->True],
Cell[79363, 2014, 231, 4, 49, "Text"],
Cell[79597, 2020, 234, 6, 31, "Input",
 InitializationCell->True],
Cell[79834, 2028, 451, 11, 52, "Input",
 InitializationCell->True],
Cell[80288, 2041, 66, 0, 30, "Text"],
Cell[80357, 2043, 2537, 71, 212, "Input",
 Evaluatable->False],
Cell[82897, 2116, 70, 0, 30, "Text"],
Cell[82970, 2118, 4567, 124, 492, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[87574, 2247, 36, 0, 35, "Subsection"],
Cell[87613, 2249, 503, 10, 87, "Text"],
Cell[88119, 2261, 509, 13, 52, "Input",
 InitializationCell->True],
Cell[88631, 2276, 1140, 32, 112, "Input",
 InitializationCell->True],
Cell[89774, 2310, 1799, 50, 172, "Input",
 InitializationCell->True],
Cell[91576, 2362, 118, 3, 31, "Input",
 InitializationCell->True],
Cell[91697, 2367, 935, 26, 132, "Input",
 InitializationCell->True],
Cell[92635, 2395, 772, 22, 72, "Input",
 InitializationCell->True],
Cell[93410, 2419, 942, 27, 72, "Input",
 InitializationCell->True],
Cell[94355, 2448, 89, 2, 30, "Text"],
Cell[94447, 2452, 562, 18, 72, "Input",
 InitializationCell->True],
Cell[95012, 2472, 2317, 62, 232, "Input",
 InitializationCell->True],
Cell[97332, 2536, 3384, 95, 212, "Input",
 InitializationCell->True],
Cell[100719, 2633, 1068, 29, 92, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[101824, 2667, 82, 1, 35, "Subsection"],
Cell[101909, 2670, 92, 2, 31, "Input",
 InitializationCell->True],
Cell[102004, 2674, 209, 4, 30, "Text"],
Cell[102216, 2680, 347, 9, 31, "Input",
 InitializationCell->True],
Cell[102566, 2691, 400, 10, 31, "Input",
 InitializationCell->True],
Cell[102969, 2703, 1752, 53, 112, "Input",
 InitializationCell->True],
Cell[104724, 2758, 1072, 32, 72, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[105833, 2795, 78, 1, 35, "Subsection"],
Cell[105914, 2798, 60, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[105999, 2802, 789, 23, 72, "Input",
 Evaluatable->False],
Cell[106791, 2827, 373, 9, 23, "Print"]
}, Open  ]],
Cell[107179, 2839, 79, 0, 30, "Text"],
Cell[107261, 2841, 616, 16, 52, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[107914, 2862, 114, 1, 35, "Subsection"],
Cell[108031, 2865, 2319, 63, 192, "Input",
 InitializationCell->True],
Cell[110353, 2930, 2128, 55, 132, "Input",
 InitializationCell->True],
Cell[112484, 2987, 1093, 31, 92, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[113614, 3023, 81, 1, 35, "Subsection"],
Cell[113698, 3026, 567, 16, 52, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[114302, 3047, 88, 1, 35, "Subsection"],
Cell[114393, 3050, 851, 23, 132, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[115281, 3078, 91, 1, 35, "Subsection"],
Cell[115375, 3081, 2683, 70, 192, "Input",
 InitializationCell->True],
Cell[118061, 3153, 895, 25, 92, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[118993, 3183, 151, 2, 35, "Subsection"],
Cell[119147, 3187, 483, 14, 52, "Input",
 InitializationCell->True],
Cell[119633, 3203, 635, 16, 52, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[120305, 3224, 92, 1, 35, "Subsection"],
Cell[120400, 3227, 2425, 67, 232, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[122862, 3299, 204, 3, 35, "Subsection"],
Cell[123069, 3304, 525, 14, 52, "Input",
 InitializationCell->True],
Cell[123597, 3320, 518, 14, 52, "Input",
 InitializationCell->True],
Cell[124118, 3336, 588, 15, 52, "Input",
 InitializationCell->True],
Cell[124709, 3353, 573, 15, 52, "Input",
 InitializationCell->True],
Cell[125285, 3370, 637, 15, 52, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[125959, 3390, 49, 0, 35, "Subsection"],
Cell[126011, 3392, 129, 4, 31, "Input",
 InitializationCell->True],
Cell[126143, 3398, 1423, 31, 92, "Input",
 InitializationCell->True],
Cell[127569, 3431, 486, 14, 52, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[128092, 3450, 130, 2, 35, "Subsection"],
Cell[128225, 3454, 1418, 37, 92, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[129680, 3496, 100, 1, 35, "Subsection"],
Cell[129783, 3499, 408, 7, 49, "Text"],
Cell[130194, 3508, 431, 11, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[130662, 3524, 159, 2, 35, "Subsection"],
Cell[130824, 3528, 154, 2, 30, "Text"],
Cell[130981, 3532, 935, 24, 52, "Input"],
Cell[131919, 3558, 947, 24, 52, "Input"],
Cell[132869, 3584, 149, 2, 30, "Text"],
Cell[133021, 3588, 2005, 49, 72, "Input",
 InitializationCell->True],
Cell[135029, 3639, 2110, 52, 132, "Input",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[137188, 3697, 137, 2, 63, "Section"],
Cell[CellGroupData[{
Cell[137350, 3703, 50, 0, 43, "Subsection"],
Cell[137403, 3705, 652, 16, 52, "Input",
 InitializationCell->True],
Cell[138058, 3723, 713, 17, 52, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[138808, 3745, 34, 0, 35, "Subsection"],
Cell[138845, 3747, 730, 11, 87, "Text"],
Cell[139578, 3760, 1256, 30, 152, "Input",
 InitializationCell->True],
Cell[140837, 3792, 13967, 329, 832, "Input",
 InitializationCell->True],
Cell[154807, 4123, 5882, 144, 432, "Input",
 InitializationCell->True],
Cell[160692, 4269, 2564, 63, 232, "Input",
 InitializationCell->True],
Cell[163259, 4334, 2697, 52, 252, "Input",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[166005, 4392, 202, 3, 63, "Section"],
Cell[CellGroupData[{
Cell[166232, 4399, 154, 2, 43, "Subsection"],
Cell[166389, 4403, 776, 21, 72, "Input",
 InitializationCell->True],
Cell[167168, 4426, 2582, 62, 192, "Input",
 InitializationCell->True],
Cell[169753, 4490, 633, 18, 72, "Input",
 InitializationCell->True],
Cell[170389, 4510, 6919, 174, 412, "Input",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[177357, 4690, 127, 2, 63, "Section"],
Cell[CellGroupData[{
Cell[177509, 4696, 86, 1, 43, "Subsection"],
Cell[177598, 4699, 62, 0, 30, "Text"],
Cell[177663, 4701, 832, 22, 72, "Input",
 Evaluatable->False],
Cell[178498, 4725, 159, 3, 30, "Text"],
Cell[178660, 4730, 560, 15, 52, "Input",
 InitializationCell->True],
Cell[179223, 4747, 818, 24, 52, "Input",
 InitializationCell->True],
Cell[180044, 4773, 22019, 489, 2232, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[202100, 5267, 131, 2, 35, "Subsection"],
Cell[202234, 5271, 554, 9, 68, "Text"],
Cell[202791, 5282, 183, 4, 31, "Input",
 InitializationCell->True],
Cell[202977, 5288, 454, 11, 72, "Input",
 InitializationCell->True],
Cell[203434, 5301, 236, 6, 31, "Input",
 InitializationCell->True],
Cell[203673, 5309, 344, 9, 31, "Input",
 InitializationCell->True],
Cell[204020, 5320, 202, 5, 31, "Input",
 InitializationCell->True],
Cell[204225, 5327, 857, 20, 72, "Input",
 InitializationCell->True],
Cell[205085, 5349, 3027, 68, 312, "Input",
 InitializationCell->True],
Cell[208115, 5419, 1193, 33, 72, "Input",
 InitializationCell->True],
Cell[209311, 5454, 3356, 83, 372, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[212704, 5542, 173, 2, 35, "Subsection"],
Cell[212880, 5546, 436, 7, 30, "Text"],
Cell[213319, 5555, 217, 5, 31, "Input",
 InitializationCell->True],
Cell[213539, 5562, 277, 6, 31, "Input",
 InitializationCell->True],
Cell[213819, 5570, 210, 5, 31, "Input",
 InitializationCell->True],
Cell[214032, 5577, 212, 5, 31, "Input",
 InitializationCell->True],
Cell[214247, 5584, 187, 4, 31, "Input",
 InitializationCell->True],
Cell[214437, 5590, 182, 4, 31, "Input",
 InitializationCell->True],
Cell[214622, 5596, 4154, 98, 272, "Input",
 InitializationCell->True],
Cell[218779, 5696, 1861, 44, 132, "Input",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[220689, 5746, 228, 4, 63, "Section"],
Cell[CellGroupData[{
Cell[220942, 5754, 178, 2, 43, "Subsection"],
Cell[221123, 5758, 183, 4, 31, "Input",
 InitializationCell->True],
Cell[221309, 5764, 3826, 82, 232, "Input",
 InitializationCell->True],
Cell[225138, 5848, 1925, 41, 172, "Input",
 InitializationCell->True],
Cell[227066, 5891, 4362, 99, 432, "Input",
 InitializationCell->True],
Cell[231431, 5992, 1652, 42, 92, "Input",
 InitializationCell->True],
Cell[233086, 6036, 321, 8, 31, "Input",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[233456, 6050, 286, 5, 63, "Section"],
Cell[CellGroupData[{
Cell[233767, 6059, 213, 3, 43, "Subsection"],
Cell[233983, 6064, 4233, 103, 372, "Input",
 InitializationCell->True],
Cell[238219, 6169, 1301, 28, 172, "Input",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[239569, 6203, 177, 3, 63, "Section"],
Cell[CellGroupData[{
Cell[239771, 6210, 78, 2, 31, "Input",
 InitializationCell->True],
Cell[239852, 6214, 1419, 20, 70, "Output"]
}, Open  ]],
Cell[241286, 6237, 85, 2, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[241408, 6244, 207, 4, 49, "Section"],
Cell[CellGroupData[{
Cell[241640, 6252, 123, 2, 31, "Input"],
Cell[CellGroupData[{
Cell[241788, 6258, 1026, 15, 23, "Print"],
Cell[242817, 6275, 1293, 22, 23, "Print"],
Cell[244113, 6299, 1065, 15, 23, "Print"],
Cell[245181, 6316, 1026, 15, 23, "Print"],
Cell[246210, 6333, 1181, 17, 43, "Print"],
Cell[247394, 6352, 1026, 15, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[248469, 6373, 202, 5, 31, "Input"],
Cell[CellGroupData[{
Cell[248696, 6382, 620, 12, 23, "Print"],
Cell[249319, 6396, 630, 12, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[249998, 6414, 204, 5, 31, "Input"],
Cell[250205, 6421, 1306, 22, 23, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[251548, 6448, 447, 14, 31, "Input"],
Cell[251998, 6464, 4555, 109, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[256590, 6578, 104, 2, 31, "Input"],
Cell[256697, 6582, 1524, 21, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[258258, 6608, 107, 2, 31, "Input"],
Cell[258368, 6612, 1549, 22, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[259954, 6639, 303, 5, 31, "Input"],
Cell[260260, 6646, 861, 13, 92, "Output"]
}, Open  ]],
Cell[261136, 6662, 379, 12, 72, "Input"],
Cell[CellGroupData[{
Cell[261540, 6678, 214, 7, 31, "Input"],
Cell[261757, 6687, 1341, 18, 31, "Output"]
}, Open  ]],
Cell[263113, 6708, 91, 2, 31, "Input"],
Cell[CellGroupData[{
Cell[263229, 6714, 214, 7, 31, "Input"],
Cell[263446, 6723, 1322, 18, 31, "Output"]
}, Open  ]],
Cell[264783, 6744, 90, 2, 31, "Input"],
Cell[CellGroupData[{
Cell[264898, 6750, 238, 5, 31, "Input"],
Cell[CellGroupData[{
Cell[265161, 6759, 1089, 19, 23, "Print"],
Cell[266253, 6780, 1187, 21, 23, "Print"],
Cell[267443, 6803, 1289, 24, 23, "Print"],
Cell[268735, 6829, 1339, 26, 23, "Print"],
Cell[270077, 6857, 1359, 26, 23, "Print"],
Cell[271439, 6885, 1275, 24, 23, "Print"],
Cell[272717, 6911, 1285, 23, 23, "Print"],
Cell[274005, 6936, 1377, 27, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[275431, 6969, 387, 11, 31, "Input"],
Cell[275821, 6982, 2054, 48, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[277912, 7035, 198, 3, 31, "Input"],
Cell[278113, 7040, 1075, 14, 31, "Output"]
}, Open  ]],
Cell[279203, 7057, 461, 11, 31, "Input"],
Cell[CellGroupData[{
Cell[279689, 7072, 258, 4, 31, "Input"],
Cell[279950, 7078, 1084, 14, 31, "Output"]
}, Open  ]],
Cell[281049, 7095, 305, 8, 31, "Input"],
Cell[281357, 7105, 268, 6, 31, "Input"],
Cell[CellGroupData[{
Cell[281650, 7115, 271, 7, 31, "Input"],
Cell[281924, 7124, 1938, 43, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[283899, 7172, 121, 2, 31, "Input"],
Cell[284023, 7176, 997, 14, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[285057, 7195, 322, 8, 31, "Input"],
Cell[285382, 7205, 1943, 43, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[287362, 7253, 121, 2, 31, "Input"],
Cell[287486, 7257, 1013, 14, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[288536, 7276, 188, 4, 31, "Input"],
Cell[288727, 7282, 1109, 19, 23, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[289873, 7306, 221, 8, 31, "Input"],
Cell[290097, 7316, 2151, 46, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[292285, 7367, 124, 2, 31, "Input"],
Cell[292412, 7371, 1184, 16, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[293633, 7392, 134, 4, 31, "Input"],
Cell[293770, 7398, 1340, 25, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[295147, 7428, 275, 8, 31, "Input"],
Cell[295425, 7438, 1470, 31, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[296932, 7474, 56, 1, 31, "Input"],
Cell[296991, 7477, 1163, 16, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[298191, 7498, 192, 5, 31, "Input"],
Cell[298386, 7505, 1161, 16, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[299584, 7526, 201, 6, 31, "Input"],
Cell[299788, 7534, 1330, 25, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[301155, 7564, 56, 1, 31, "Input"],
Cell[301214, 7567, 1179, 16, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[302430, 7588, 349, 8, 31, "Input"],
Cell[302782, 7598, 1341, 26, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[304160, 7629, 56, 1, 31, "Input"],
Cell[304219, 7632, 1163, 16, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[305419, 7653, 192, 5, 31, "Input"],
Cell[305614, 7660, 1163, 17, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[306814, 7682, 148, 4, 31, "Input"],
Cell[306965, 7688, 1302, 24, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[308304, 7717, 56, 1, 31, "Input"],
Cell[308363, 7720, 1137, 16, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[309537, 7741, 255, 7, 31, "Input"],
Cell[309795, 7750, 1342, 25, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[311174, 7780, 56, 1, 31, "Input"],
Cell[311233, 7783, 1160, 16, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[312430, 7804, 171, 4, 31, "Input"],
Cell[312604, 7810, 1165, 19, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[313806, 7834, 56, 1, 31, "Input"],
Cell[313865, 7837, 1156, 16, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[315058, 7858, 250, 7, 31, "Input"],
Cell[315311, 7867, 1350, 26, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[316698, 7898, 122, 2, 31, "Input"],
Cell[316823, 7902, 1168, 16, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[318028, 7923, 192, 5, 31, "Input"],
Cell[318223, 7930, 1149, 16, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[319409, 7951, 404, 13, 31, "Input"],
Cell[319816, 7966, 2377, 55, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[322230, 8026, 126, 2, 31, "Input"],
Cell[322359, 8030, 1189, 17, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[323585, 8052, 192, 5, 31, "Input"],
Cell[323780, 8059, 1159, 17, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[324976, 8081, 583, 17, 31, "Input"],
Cell[325562, 8100, 1813, 41, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[327412, 8146, 121, 2, 31, "Input"],
Cell[327536, 8150, 1219, 17, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[328792, 8172, 290, 5, 31, "Input"],
Cell[329085, 8179, 1370, 18, 72, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[330492, 8202, 390, 12, 31, "Input"],
Cell[330885, 8216, 3526, 84, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[334448, 8305, 124, 2, 31, "Input"],
Cell[334575, 8309, 923, 13, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[335535, 8327, 389, 11, 31, "Input"],
Cell[335927, 8340, 3443, 84, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[339407, 8429, 124, 2, 31, "Input"],
Cell[339534, 8433, 905, 12, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[340476, 8450, 134, 2, 31, "Input"],
Cell[CellGroupData[{
Cell[340635, 8456, 1150, 20, 23, "Print"],
Cell[341788, 8478, 1095, 19, 23, "Print"],
Cell[342886, 8499, 1103, 19, 23, "Print"],
Cell[343992, 8520, 1103, 19, 23, "Print"],
Cell[345098, 8541, 1095, 19, 23, "Print"],
Cell[346196, 8562, 1115, 19, 23, "Print"],
Cell[347314, 8583, 1119, 19, 23, "Print"],
Cell[348436, 8604, 1059, 18, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[349544, 8628, 67, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[349636, 8633, 1349, 23, 23, "Print"],
Cell[350988, 8658, 1365, 23, 23, "Print"]
}, Open  ]],
Cell[352368, 8684, 1060, 16, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[353465, 8705, 134, 2, 31, "Input"],
Cell[CellGroupData[{
Cell[353624, 8711, 1066, 15, 23, "Print"],
Cell[354693, 8728, 1356, 23, 23, "Print"],
Cell[356052, 8753, 1093, 15, 23, "Print"],
Cell[357148, 8770, 1068, 15, 23, "Print"],
Cell[358219, 8787, 1223, 17, 43, "Print"],
Cell[359445, 8806, 1068, 15, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[360562, 8827, 420, 11, 31, "Input"],
Cell[360985, 8840, 1252, 24, 23, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[362274, 8869, 488, 11, 31, "Input"],
Cell[362765, 8882, 1188, 22, 23, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[363990, 8909, 757, 24, 52, "Input"],
Cell[364750, 8935, 2441, 53, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[367228, 8993, 56, 1, 31, "Input"],
Cell[367287, 8996, 1049, 14, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[368373, 9015, 511, 16, 31, "Input"],
Cell[368887, 9033, 27379, 759, 118, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[396303, 9797, 714, 20, 31, "Input"],
Cell[397020, 9819, 39677, 1095, 118, "Output"]
}, Open  ]],
Cell[436712, 10917, 163, 3, 31, "Input"],
Cell[CellGroupData[{
Cell[436900, 10924, 156, 3, 31, "Input"],
Cell[437059, 10929, 2081, 29, 192, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[439177, 10963, 278, 6, 31, "Input"],
Cell[439458, 10971, 2286, 32, 312, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[441781, 11008, 571, 14, 31, "Input"],
Cell[442355, 11024, 43002, 1156, 118, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[485394, 12185, 142, 2, 31, "Input"],
Cell[485539, 12189, 2067, 29, 532, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[487643, 12223, 67, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[487735, 12228, 649, 13, 23, "Print"],
Cell[488387, 12243, 677, 13, 23, "Print"]
}, Open  ]],
Cell[489079, 12259, 341, 6, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[489457, 12270, 67, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[489549, 12275, 877, 20, 23, "Print"],
Cell[490429, 12297, 711, 14, 23, "Print"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
