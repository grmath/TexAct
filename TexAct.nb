Notebook[{

Cell[CellGroupData[{
Cell["TexAct", "Title",
 FontColor->RGBColor[1, 0, 0]],

Cell[TextData[{
 "Tex code to format ",
 StyleBox["xAct",
  FontSlant->"Italic"],
 " expressions"
}], "Subtitle",
 FontColor->RGBColor[0, 0, 1]],

Cell[TextData[{
 StyleBox["Thomas B\[ADoubleDot]ckdahl, Jos\[EAcute] M. Mart\[IAcute]n-Garc\
\[IAcute]a and Barry Wardell\n",
  FontSize->18],
 "(c) 2008-2013, under GPL\n\nt.backdahl@ed.ac.uk, jose@xact.es, \
barry.wardell@gmail.com\nhttp://www.xact.es/\n\
http://groups.google.com/group/xact"
}], "Subsubtitle"],

Cell[TextData[{
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " has a function TeXForm but does not behave well with the indexed \
expressions of ",
 StyleBox["xAct",
  FontSlant->"Italic"],
 ". We construct our own Tex function, which starts from the internal form, \
and not the box-form of the expression. The objective is building a ",
 Cell[BoxData[
  StyleBox[
   RowBox[{"T", 
    AdjustmentBox["E",
     BoxBaselineShift->0.5,
     BoxMargins->{{-0.075, -0.085}, {0, 0}}], "X"}]]]],
 " string from our expression.\n\nJose: This package has been excised from ",
 StyleBox["xTensor",
  FontSlant->"Italic"],
 " in April 2012, to make it easier to mantain, and to acknowledge the \
essential contributions by Thomas and Barry."
}], "Text"],

Cell[CellGroupData[{

Cell["1. Info and copyright", "Section",
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IntegerPart", "/@", 
  RowBox[{"Date", "[", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2013", ",", "10", ",", "24", ",", "10", ",", "51", ",", "1"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xAct`TexAct`$Version", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<0.3.3\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"2013", ",", "12", ",", "07"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"xAct`TexAct`$xTensorVersionExpected", "=", "\[NoBreak]", 
   RowBox[{"{", 
    RowBox[{"\"\<1.0.5\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"2013", ",", "1", ",", "30"}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["1.0. TODO LIST", "Subsection"],

Cell["Representation of SeriesData expressions.", "Text"]
}, Closed]],

Cell[CellGroupData[{

Cell["1.1. GPL", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"TexAct", ",", " ", 
    RowBox[{
    "Tex", " ", "code", " ", "to", " ", "format", " ", "xAct", " ", 
     "expressions"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Copyright", " ", 
      RowBox[{"(", "C", ")"}], " ", "2008"}], "-", 
     RowBox[{"2013", " ", "Thomas", " ", "B\[ADoubleDot]ckdahl"}]}], ",", " ", 
    RowBox[{
     RowBox[{"Jose", " ", 
      RowBox[{"M", ".", " ", "Martin"}]}], "-", 
     RowBox[{"Garcia", " ", "and", " ", "Barry", " ", "Wardell"}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "This", " ", "program", " ", "is", " ", "free", " ", "software"}], ";", 
     " ", 
     RowBox[{"you", " ", "can", " ", "redistribute", " ", "it", " ", 
      RowBox[{"and", "/", "or"}], " ", "modify", "\[IndentingNewLine]", " ", 
      "it", " ", "under", " ", "the", " ", "terms", " ", "of", " ", "the", 
      " ", "GNU", " ", "General", " ", "Public", " ", "License", " ", "as", 
      " ", "published", "\[IndentingNewLine]", " ", "by", " ", "the", " ", 
      "Free", " ", "Software", " ", "Foundation"}], ";", " ", 
     RowBox[{
     "either", " ", "version", " ", "2", " ", "of", " ", "the", " ", 
      "License"}]}], ",", "\[IndentingNewLine]", "  ", 
    RowBox[{"or", " ", 
     RowBox[{"(", 
      RowBox[{"at", " ", "your", " ", "option"}], ")"}], " ", "any", " ", 
     "later", " ", 
     RowBox[{
     "version", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "This"}], 
     " ", "program", " ", "is", " ", "distributed", " ", "in", " ", "the", 
     " ", "hope", " ", "that", " ", "it", " ", "will", " ", "be", " ", 
     "useful"}], ",", "\[IndentingNewLine]", "  ", 
    RowBox[{
     RowBox[{"but", " ", "WITHOUT", " ", "ANY", " ", "WARRANTY"}], ";", " ", 
     RowBox[{
     "without", " ", "even", " ", "the", " ", "implied", " ", "warranty", " ",
       "of", "\[IndentingNewLine]", " ", "MERCHANTABILITY", " ", "or", " ", 
      "FITNESS", " ", "FOR", " ", "A", " ", "PARTICULAR", " ", 
      RowBox[{"PURPOSE", ".", " ", "See"}], " ", "the", " ", "GNU", 
      "\[IndentingNewLine]", " ", "General", " ", "Public", " ", "License", 
      " ", "for", " ", "more", " ", 
      RowBox[{
      "details", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "You"}], 
      " ", "should", " ", "have", " ", "received", " ", "a", " ", "copy", " ",
       "of", " ", "the", " ", "GNU", " ", "General", " ", "Public", " ", 
      "License", "\[IndentingNewLine]", " ", "along", " ", "with", " ", 
      "this", " ", "program"}], ";", " ", 
     RowBox[{"if", " ", "not"}]}], ",", " ", 
    RowBox[{
    "write", " ", "to", " ", "the", " ", "Free", " ", "Software", 
     "\[IndentingNewLine]", " ", "Foundation"}], ",", " ", 
    RowBox[{"Inc", "."}], ",", " ", 
    RowBox[{
     RowBox[{"59", " ", "Temple", " ", "Place"}], "-", 
     RowBox[{"Suite", " ", "330"}]}], ",", " ", "Boston", ",", " ", 
    RowBox[{
     RowBox[{"MA", " ", "02111"}], "-", "1307"}], ",", "\[IndentingNewLine]", 
    "  ", 
    RowBox[{"USA", "."}]}], " ", "\[IndentingNewLine]", "*)"}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["1.2. Info package", "Subsection"],

Cell["\<\
(* :Title: TexAct *)

(* :Author: Thomas B\[ADoubleDot]ckdahl, Jose M. Martin-Garcia and Barry \
Wardell *)

(* :Summary: Tex code to format xAct expressions *)

(* :Brief Discussion:
*)
  
(* :Context: xAct`Texsor` *)

(* :Package Version: 0.3.2 *)

(* :Copyright: Thomas B\[ADoubleDot]ckdahl, Jose M. Martin-Garcia and Barry \
Wardell (2008-2013) *)

(* :History: see TexAct.History file *)

(* :Keywords: *)

(* :Source: Texsor.nb *)

(* :Warning: *)

(* :Mathematica Version: 5.1 and later *)

(* :Limitations: *)\
\>", "Input",
 PageWidth->PaperWidth,
 CellMargins->{{60, -272}, {Inherited, Inherited}},
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["1.3. BeginPackage", "Subsection"],

Cell["Last package read in a session:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Unevaluated", "[", "xAct`xCore`Private`$LastPackage", "]"}], "===",
      "xAct`xCore`Private`$LastPackage"}], ",", 
    RowBox[{
    "xAct`xCore`Private`$LastPackage", "=", "\"\<xAct`TexAct`\>\""}]}], "]"}],
   ";"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData["xAct`xCore`Private`$LastPackage"], "Input"],

Cell[BoxData["\<\"xAct`TexAct`\"\>"], "Output"]
}, Open  ]],

Cell[TextData[{
 "Explicit (not hidden) import of ",
 StyleBox["xCore",
  FontSlant->"Italic"],
 ",  ",
 StyleBox["xPerm",
  FontSlant->"Italic"],
 " and ",
 StyleBox["ExpressionManipulation",
  FontSlant->"Italic"],
 " (the latter is not automatically read from version 0.6.2 of ",
 StyleBox["xCore",
  FontSlant->"Italic"],
 "):"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BeginPackage", "[", 
  RowBox[{"\"\<xAct`TexAct`\>\"", ",", 
   RowBox[{"{", 
    RowBox[{
    "\"\<xAct`xCore`\>\"", ",", "\"\<xAct`xPerm`\>\"", ",", 
     "\"\<xAct`xTensor`\>\""}], "}"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`xPerm`  version \"\>", 
   "\[InvisibleSpace]", "\<\"1.2.1\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2013", ",", "7", ",", "1"}], "}"}]}],
  SequenceForm["Package xAct`xPerm`  version ", "1.2.1", ", ", {2013, 7, 1}],
  Editable->False]], "Print"],

Cell[BoxData["\<\"CopyRight (C) 2003-2013, Jose M. Martin-Garcia, under the \
General Public License.\"\>"], "Print"],

Cell[BoxData["\<\"Connecting to external cygwin executable...\"\>"], "Print"],

Cell[BoxData["\<\"Connection established.\"\>"], "Print"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`xTensor`  version \"\>", 
   "\[InvisibleSpace]", "\<\"1.1.0\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2013", ",", "9", ",", "1"}], "}"}]}],
  SequenceForm["Package xAct`xTensor`  version ", "1.1.0", ", ", {2013, 9, 1}],
  Editable->False]], "Print"],

Cell[BoxData["\<\"CopyRight (C) 2002-2013, Jose M. Martin-Garcia, under the \
General Public License.\"\>"], "Print"]
}, Open  ]],

Cell[BoxData["\<\"xAct`TexAct`\"\>"], "Output"]
}, Open  ]],

Cell[TextData[{
 "Check version of ",
 StyleBox["xTensor",
  FontSlant->"Italic"],
 ". We simply compare dates:"
}], "Text"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"Not", "@", 
    RowBox[{"OrderedQ", "@", 
     RowBox[{"Map", "[", 
      RowBox[{"Last", ",", 
       RowBox[{"{", 
        RowBox[{
        "xAct`TexAct`$xTensorVersionExpected", ",", "xAct`xTensor`$Version"}],
         "}"}]}], "]"}]}]}], ",", 
   RowBox[{"Throw", "@", 
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"General", "::", "versions"}], ",", "\"\<xTensor\>\"", ",", 
      "xAct`xTensor`$Version", ",", "xAct`TexAct`$xTensorVersionExpected"}], 
     "]"}]}]}], "]"}]], "Input",
 InitializationCell->True],

Cell["Message:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "xAct`xCore`Private`bars", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Package xAct`TexAct`  version \>\"", ",", 
    RowBox[{"xAct`TexAct`$Version", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<, \>\"", ",", 
    RowBox[{"xAct`TexAct`$Version", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{"Print", "[", 
  "\"\<CopyRight (C) 2008-2013, Thomas B\[ADoubleDot]ckdahl, Jose M. \
Martin-Garcia and Barry Wardell, under the General Public License.\>\"", 
  "]"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`TexAct`  version \"\>", 
   "\[InvisibleSpace]", "\<\"0.3.3\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2013", ",", "9", ",", "16"}], "}"}]}],
  SequenceForm["Package xAct`TexAct`  version ", "0.3.3", ", ", {2013, 9, 16}],
  Editable->False]], "Print"],

Cell[BoxData["\<\"CopyRight (C) 2008-2013, Thomas B\[ADoubleDot]ckdahl, Jose \
M. Martin-Garcia and Barry Wardell, under the General Public License.\"\>"], \
"Print"]
}, Open  ]]
}, Open  ]],

Cell["\<\
We specify the context xAct`TexAct` to avoid overriding the Disclaimer of \
other packages. However we need to turn off the message General:shdw \
temporarily:\
\>", "Text"],

Cell[BoxData[{
 RowBox[{"Off", "[", 
  RowBox[{"General", "::", "shdw"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xAct`TexAct`Disclaimer", "[", "]"}], ":=", 
  RowBox[{
  "Print", "[", 
   "\"\<These are points 11 and 12 of the General Public \
License:\\n\\nBECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO \
WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT \
WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES \
PROVIDE THE PROGRAM `AS IS\.b4 WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED \
OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF \
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO \
THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU. SHOULD THE PROGRAM \
PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR \
CORRECTION.\\n\\nIN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO \
IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY \
AND/OR REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR \
DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES \
ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT \
LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED \
BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER \
PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE \
POSSIBILITY OF SUCH DAMAGES.\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"On", "[", 
  RowBox[{"General", "::", "shdw"}], "]"}]}], "Input",
 InitializationCell->True],

Cell["\<\
If TexAct is the last package begin read, print the GPL message:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"xAct`xCore`Private`$LastPackage", "===", "\"\<xAct`TexAct`\>\""}],
    ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Unset", "[", "xAct`xCore`Private`$LastPackage", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "xAct`xCore`Private`bars", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Print", "[", 
     "\"\<These packages come with ABSOLUTELY NO WARRANTY; for details type \
Disclaimer[]. This is free software, and you are welcome to redistribute it \
under certain conditions. See the General Public License for details.\>\"", 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "xAct`xCore`Private`bars", "]"}]}]}], 
  "]"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"],

Cell[BoxData["\<\"These packages come with ABSOLUTELY NO WARRANTY; for \
details type Disclaimer[]. This is free software, and you are welcome to \
redistribute it under certain conditions. See the General Public License for \
details.\"\>"], "Print"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["1.4. Usage messages", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "::", "usage"}], "=", 
   "\"\<Tex[expr] returns a string with the TeX formatting of the tensorial \
expression expr.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexPrint", "::", "usage"}], "=", 
   "\"\<TexPrint[expr] returns a string for screen printing of the TeX \
formatting of the tensorial expression expr. TexPrint[expr, n] starts using \
parenthesization of level n, instead of the Automatic level.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexBreak", "::", "usage"}], "=", 
   "\"\<TexBreak[string] breaks the string (the output of TexPrint) into \
different lines of TeX code, always before a sum, approximately every 200 \
characters (or terms, using the option TexBreakBy) of the string. \
TexBreak[string, n] allows specifying the frequency of characters or terms. \
TexBreak[string, n, list] allows specifying different lengths for different \
lines. Other relevant options are TexBreakAt and TexBreakString.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexBreakBy", "::", "usage"}], "=", 
   "\"\<TexBreakBy is an option for TexBreak specifying whether the string of \
TeX code must be broken by counting characters (value \\\"Character\\\") or \
by counting terms (value \\\"Term\\\").\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexBreakAt", "::", "usage"}], "=", 
   "\"\<TexBreakAt is an option for TexBreak specifying where to break the \
string of TeX code.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexBreakString", "::", "usage"}], "=", 
   "\"\<TexBreakString is an option for TexBreak specifying the string to be \
introduced at the breaking points.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexPrintInitialBracesQ", "::", "usage"}], "=", 
   "\"\<$TexPrintInitialBracesQ is a Boolean global variable, with default \
False. If set to True a tensor is formatted as T{}^{ab}{}_{cd}. If set to \
False the same tensor is formatted as T^{ab}{}_{cd}.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexScalarParentheses", "::", "usage"}], "=", 
   "\"\<$TexScalarParentheses is a Boolean global variable, with default \
True. If set to True the Scalar expressions are formatted with wrapping \
parentheses.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexFraction", "::", "usage"}], "=", 
   "\"\<$TexFraction is a global variable specifying the Tex command to be \
used to format fractions, with default \\\"\\\\frac\\\".\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexSmallFraction", "::", "usage"}], "=", 
   "\"\<$TexSmallFraction is a global variable specifying the Tex command to \
be use to format rational numbers, with default \\\"\\\\tfrac\\\".\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexSmallFractionExponent", "::", "usage"}], "=", 
   "\"\<$TexSmallFractionExponent is a global variable specifying the Tex \
command to be use to format rational numbers, with default False.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexFractionAsFraction", "::", "usage"}], "=", 
   "\"\<Option for TexPrint. If True, fractions are printed as fractions, \
otherwize they are printed as a product with negative exponents.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexParenthesisInitLevel", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexFixExtraRules", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexMatrix", "::", "usage"}], " ", "=", 
   "\"\<TexMatrix[M] produces TeX code for the matrix M, where all elements \
are typset by the function Tex. TexMatrix[M, F] uses the function F instead \
of Tex on the elements.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexIndexForm", "::", "usage"}], " ", "=", 
   "\"\<Special formatting for indices.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexTmpDirectory", "::", "usage"}], " ", "=", 
   "\"\<Directory for placement of the TexActWidthTest.tex file for \
determining of widths for linebreaking.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexDirectory", "::", "usage"}], "=", 
   "\"\<Directory for placement of the output .tex file.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexInitLatexCode", "::", "usage"}], "=", 
   "\"\<A function that produces the initial lines of the TexActWidthTest.tex \
file for determining of widths for linebreaking. Observe that \
\\\\begin{document} should not be included. This is constructed from the \
string $TexInitLatexClassCode, and the lists $TexInitLatexPackages, \
$TexInitLatexExtraCode.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexInitLatexClassCode", "::", "usage"}], "=", 
   "\"\<The document class code for the LaTeX output.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexInitLatexPackages", "::", "usage"}], "=", 
   "\"\<A list of packages for the LaTeX output. This should be a list of \
strings, where each string has teh form {package}. This is then transformed \
to \\\\usepackage{package}\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexInitLatexExtraCode", "::", "usage"}], "=", 
   "\"\<Extra lines for definition of special LaTeX commands. This should be \
a list of strings.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexPrintAlignedEquations", "::", "usage"}], " ", "=", 
   "\"\<TexPrintAlignedEquations takes a list of equations and typesets them \
in an align environment with line breaking so the total length does not \
exceed $TexPrintPageWidth.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexPrintPageWidth", "::", "usage"}], " ", "=", " ", 
   "\"\<Parameter to adjust the line breaking for TexPrintAlignedEquations. \
This is measured in printer points. Observe that you can use the textwidth \
variable which is read from the latex environment.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"latextextwidth", "::", "usage"}], "=", 
   "\"\<A symbol representing the textwidth variable in the current latex \
environment.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FormatTexBasis", "::", "usage"}], " ", "=", 
   "\"\<FormatTexBasis works the same way as FormatBasis, but for the Tex \
output.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EquationMarks", "::", "usage"}], " ", "=", 
   "\"\<An option for TexBreak to include \\\\begin{equation} \
\\\\end{equation} or similar constructions. Default is False, but a standard \
value would be \\\"equation\\\". Warning, do not use this on TexPrint if the \
result is passed to TexBreak.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddEquationMarks", "::", "usage"}], "=", 
   "\"\<Adds \\\\begin{equation} \\\\end{equation} or similar constructions \
to a tex string. The default is Automatic which makes an educated \
guess.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexView", "::", "usage"}], "=", 
   "\"\<TexView is used to compile and view tex output. The first argument \
can be a tex string, a list of equations, a single equation or expression. A \
second optional argument can be given to set the file name without extension. \
The compiler is set by $LatexExecutable. The file extension of the file to \
view is set by $TexViewExt.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$LatexExecutable", "::", "usage"}], " ", "=", 
   "\"\<Command for compiling LaTeX. The default is pdflatex. Add the path to \
the file if the default value does not work.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexViewExt", "::", "usage"}], " ", "=", " ", 
   "\"\<The file extension for output file to view. The defailt is .pdf. If \
you want to open the .tex file in your default editor use .tex instead. \
Observe however that TexView overwrites files without asking so editing this \
file might not be a good idea.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexPrintAlignedExpressions", "::", "usage"}], "=", 
   "\"\<Takes a list of expressions, and typesets them in an aligned \
environment.\>\""}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["1.5. Begin private section", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData["\<\"xAct`TexAct`Private`\"\>"], "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2. Parentheses", "Section",
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell["2.1. Open and close parentheses", "Subsection"],

Cell["We define a hierarchy of parenthesis.", "Text"],

Cell[TextData[{
 "There is a global variable ",
 StyleBox["level", "Input"],
 " that stores the parenthesization level at each particular time. There is \
also the global variable ",
 StyleBox["minlevel", "Input"],
 ". The idea is that each call to TexMaximumLevel has a Block with these two \
variables. This is not very elegant."
}], "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TexOpen", "[", "string_String", "]"}], ":=", 
   RowBox[{
    RowBox[{"OpenParenthesis", "[", 
     RowBox[{"Decrement", "[", "level", "]"}], "]"}], "<>", "string"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexClose", "[", "string_String", "]"}], ":=", 
   RowBox[{
    RowBox[{"CloseParenthesis", "[", 
     RowBox[{"PreIncrement", "[", "level", "]"}], "]"}], "<>", "string"}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Trick", " ", "to", " ", "count", " ", "maximum", " ", "depth"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"OpenParenthesis", "[", 
      RowBox[{"level_Integer", "?", "Negative"}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"minlevel", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"minlevel", ",", "level"}], "]"}]}], ";", "\"\<\>\""}], 
      ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CloseParenthesis", "[", 
      RowBox[{"level_Integer", "?", "Negative"}], "]"}], ":=", "\"\<\>\""}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OpenParenthesis", "[", "0", "]"}], ":=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CloseParenthesis", "[", "0", "]"}], ":=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OpenParenthesis", "[", "1", "]"}], ":=", "\"\<\\\\bigl\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CloseParenthesis", "[", "1", "]"}], ":=", "\"\<\\\\bigr\>\""}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OpenParenthesis", "[", "2", "]"}], ":=", "\"\<\\\\Bigl\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CloseParenthesis", "[", "2", "]"}], ":=", "\"\<\\\\Bigr\>\""}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OpenParenthesis", "[", "3", "]"}], ":=", "\"\<\\\\biggl\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CloseParenthesis", "[", "3", "]"}], ":=", "\"\<\\\\biggr\>\""}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OpenParenthesis", "[", "4", "]"}], ":=", "\"\<\\\\Biggl\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CloseParenthesis", "[", "4", "]"}], ":=", "\"\<\\\\Biggr\>\""}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OpenParenthesis", "[", 
      RowBox[{"level_Integer", "?", "Positive"}], "]"}], ":=", 
     "\"\<\\\\left\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CloseParenthesis", "[", 
      RowBox[{"level_Integer", "?", "Positive"}], "]"}], ":=", 
     "\"\<\\\\right\>\""}], ";"}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Main", ".", " ", "Private"}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"TexMaximumLevel", "[", "expr_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"level", "=", "0"}], ",", 
        RowBox[{"minlevel", "=", "0"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"Tex", "[", "expr", "]"}], ";", 
       RowBox[{"-", "minlevel"}]}]}], "]"}]}], ";"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Safety", " ", "definitions", " ", "for", " ", "direct", " ", "examples", 
    " ", "with", " ", "Tex"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"level", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"minlevel", "=", "0"}], ";"}]}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["2.2. Main function", "Subsection"],

Cell["\<\
The key idea here is that there are two calls to the function Tex. We first \
run through the whole expression with TexMaximumLevel, which uses Tex, to \
discover the number of parentheses needed. In this first run the resulting \
expression string  has wrong parentheses (actually no parentheses). Then we \
call Tex again, this time producing the correct parentheses. If we provide \
the second argument of TexParenthesis then we avoid the first run.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$VerboseParenthesizationLevel", "=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexParenthesis", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"initlevel_:", "Automatic"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"level", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"initlevel", "===", "Automatic"}], ",", 
         RowBox[{"TexMaximumLevel", "[", "expr", "]"}], ",", "initlevel"}], 
        "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"$VerboseParenthesationLevel", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Maximum parenthesization level: \>\"", ",", "level"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Tex", "[", "expr", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["2.3. Alternative code. Not used", "Subsection"],

Cell["\<\
This is some alternative code whose origin or purpose has been forgotten... \
It is not included in the package.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ZParenth", "[", 
     RowBox[{"ZParenth", "[", "expr_", "]"}], "]"}], ":=", 
    RowBox[{"ZParenth", "[", "expr", "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Atoms", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", 
    RowBox[{"x", ":", 
     RowBox[{"(", 
      RowBox[{
      "_Symbol", "|", "_String", "|", "_Integer", "|", "_Rational", "|", 
       "_Real"}], ")"}]}], "]"}], ":=", "x"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddParenth", "[", "x_Complex", "]"}], ":=", 
    RowBox[{"ZParenth", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Products", " ", "and", " ", "sums"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", 
    RowBox[{"Times", "[", 
     RowBox[{"x_", ",", "y_Plus"}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"AddParenth", "[", "x", "]"}], 
    RowBox[{"ZParenth", "[", 
     RowBox[{"AddParenth", "[", "y", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", "expr_Times", "]"}], ":=", 
   RowBox[{"AddParenth", "/@", "expr"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddParenth", "[", "expr_Plus", "]"}], ":=", 
    RowBox[{"AddParenth", "/@", "expr"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Powers", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", 
    RowBox[{"Power", "[", 
     RowBox[{
      RowBox[{"x", ":", 
       RowBox[{"(", 
        RowBox[{"_Symbol", "|", 
         RowBox[{
          RowBox[{"_", "?", "xTensorQ"}], "[", "___", "]"}]}], ")"}]}], ",", 
      "n_"}], "]"}], "]"}], ":=", 
   RowBox[{"Power", "[", 
    RowBox[{
     RowBox[{"AddParenth", "[", "x", "]"}], ",", 
     RowBox[{"AddParenth", "[", "n", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddParenth", "[", 
     RowBox[{"Power", "[", 
      RowBox[{"x_", ",", "n_"}], "]"}], "]"}], ":=", 
    RowBox[{"Power", "[", 
     RowBox[{
      RowBox[{"ZParenth", "[", 
       RowBox[{"AddParenth", "[", "x", "]"}], "]"}], ",", 
      RowBox[{"AddParenth", "[", "n", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Objects", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", 
    RowBox[{"t", ":", 
     RowBox[{
      RowBox[{"_", "?", "xTensorQ"}], "[", "___", "]"}]}], "]"}], ":=", "t"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", 
    RowBox[{"c", ":", 
     RowBox[{
      RowBox[{
       RowBox[{"_Symbol", "?", "CovDQ"}], "[", "__", "]"}], "[", "_", "]"}]}],
     "]"}], ":=", "c"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddParenth", "[", "c_CovD", "]"}], ":=", "c"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Scalar", " ", "functions", " ", "and", " ", "inert", " ", "heads"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", 
    RowBox[{
     RowBox[{"f_", "?", "ScalarFunctionQ"}], "[", "exprs__", "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"AddParenth", "[", "f", "]"}], "[", 
    RowBox[{"AddParenth", "/@", 
     RowBox[{"OParenth", "[", "exprs", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddParenth", "[", 
     RowBox[{
      RowBox[{"ih_Symbol", "?", "InertHeadQ"}], "[", 
      RowBox[{"expr_", ",", "z___"}], "]"}], "]"}], ":=", 
    RowBox[{"ih", "[", 
     RowBox[{
      RowBox[{"OParenth", "[", 
       RowBox[{"AddParenth", "[", "expr", "]"}], "]"}], ",", "z"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Parametric", " ", "derivatives"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", 
    RowBox[{
     RowBox[{"ParamD", "[", "ps__", "]"}], "[", "expr_", "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ParamD", "[", "ps", "]"}], "[", 
    RowBox[{"OParenth", "[", 
     RowBox[{"AddParenth", "[", "expr", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddParentheses", "[", "expr_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Pexpr", "=", 
       RowBox[{"AddParenth", "[", "expr", "]"}]}], ",", "pos"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pos", "=", 
      RowBox[{"Most", "/@", 
       RowBox[{"Position", "[", 
        RowBox[{"Pexpr", ",", "ZParenth", ",", 
         RowBox[{"Heads", "\[Rule]", "True"}]}], "]"}]}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3. Type formatting", "Section",
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell["3.0. The Tex function", "Subsection"],

Cell[TextData[{
 "The function Tex does most of the actual construction of the final string. \
It gets directly the ",
 StyleBox["xAct",
  FontSlant->"Italic"],
 " expressions and returns a string. The final result will be simply a \
concatenation of the individual strings, except for the parenthesization \
issues."
}], "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Just", " ", "in", " ", "case"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", "]"}], ":=", "\"\<\>\""}], ";"}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.1. Fractions", "Subsection"],

Cell["\<\
Because some people might want to use the \"\\\\tfrac\" or \"\\\\dfrac\" \
commands of amsmath, we introduce these two variables:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "$TexFraction"}]], "Input"],

Cell[BoxData[
 StyleBox["\<\"$TexFraction is a global variable specifying the Tex command \
to be used to format fractions, with default \\\"\\\\frac\\\".\"\>", 
  "MSG"]], "Print", "PrintUsage"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "$TexSmallFraction"}]], "Input"],

Cell[BoxData[
 StyleBox["\<\"$TexSmallFraction is a global variable specifying the Tex \
command to be use to format rational numbers, with default \\\"\\\\tfrac\\\".\
\"\>", "MSG"]], "Print", "PrintUsage"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$TexFraction", "=", "\"\<\\\\frac\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$TexSmallFraction", "=", "\"\<\\\\tfrac\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$TexSmallFractionExponent", "=", "False"}], ";"}]}], "Input",
 InitializationCell->True],

Cell["\<\
Code to avoid printing fractions as products. One can avoid all fractions \
except rationals and square roots by setting TexFractionAsFraction->False.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexFrac1", "[", 
    RowBox[{"numer_", ",", " ", "denom_", ",", "fracsymbol_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"fracsymbol", "===", "False"}], ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"Tex", "[", "numer", "]"}], ",", "\"\</\>\"", ",", 
       RowBox[{"Tex", "[", "denom", "]"}]}], "]"}], ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"fracsymbol", ",", "\"\<{\>\"", ",", 
       RowBox[{"Tex", "[", "numer", "]"}], ",", "\"\<}{\>\"", ",", 
       RowBox[{"Tex", "[", "denom", "]"}], ",", "\"\<}\>\""}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell["If the numerator begins with a minus, we move the sign out. ", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexFracExpression", "[", 
    RowBox[{"numer_", ",", " ", "denom_", ",", "fracsymbol_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"WithMinusQ", "[", "numer", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexOperator", "[", "Minus", "]"}], ",", 
       RowBox[{"TexFrac1", "[", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", "numer", ")"}]}], ",", "denom", ",", "fracsymbol"}], 
        "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"TexFrac1", "[", 
      RowBox[{"numer", ",", "denom", ",", "fracsymbol"}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell["Detect the presence of a negative sign:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"WithMinusQ", "[", "expr_String", "]"}], ":=", 
   RowBox[{"SameQ", "[", 
    RowBox[{
     RowBox[{"StringTake", "[", 
      RowBox[{"expr", ",", "1"}], "]"}], ",", "\"\<-\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WithMinusQ", "[", "expr_", "]"}], ":=", 
   RowBox[{"WithMinusQ", "[", 
    RowBox[{"Tex", "[", "expr", "]"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.2. Numbers", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Numbers", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "x_Integer", "]"}], ":=", 
     RowBox[{"ToString", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "x_Real", "]"}], ":=", 
     RowBox[{"ToString", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "x_Rational", "]"}], ":=", 
     RowBox[{"TexFracExpression", "[", 
      RowBox[{
       RowBox[{"Numerator", "[", "x", "]"}], ",", 
       RowBox[{"Denominator", "[", "x", "]"}], ",", "$TexSmallFraction"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Complex", "[", 
       RowBox[{"0", ",", "1"}], "]"}], "]"}], "=", "\"\<i\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Complex", "[", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], "=", "\"\<-i\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Complex", "[", 
       RowBox[{"0", ",", "im_"}], "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"Tex", "[", "im", "]"}], ",", 
       RowBox[{"Tex", "[", "I", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Complex", "[", 
       RowBox[{"re_", ",", "im_"}], "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
       RowBox[{"Tex", "[", "re", "]"}], ",", "\"\<+\>\"", ",", 
       RowBox[{"Tex", "[", 
        RowBox[{"im", " ", "I"}], "]"}], ",", 
       RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True],

Cell["Should we give definitions for other numeric objects here?", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Numeric", " ", "expressions"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "E", "]"}], "=", "\"\<e\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Pi", "]"}], "=", "\"\<\\\\pi\>\""}], 
    ";"}]}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.3. Strings", "Subsection"],

Cell[TextData[{
 "With strings we call ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "'s TeXForm, removing the frequent and annoying \\text{*} :"
}], "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Strings", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Removetext", "[", "string_String", "]"}], ":=", 
     RowBox[{
      RowBox[{"StringDrop", "[", 
       RowBox[{
        RowBox[{"StringDrop", "[", 
         RowBox[{"string", ",", "6"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "/;", 
      RowBox[{"StringMatchQ", "[", 
       RowBox[{"string", ",", "\"\<\\\\text{*}\>\""}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Removetext", "[", "string_String", "]"}], ":=", "string"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "TeXForm", " ", "does", " ", "not", " ", "work", " ", "on", " ", 
     "StyleBoxes", " ", "so", " ", "we", " ", "remove", " ", "them", " ", 
     RowBox[{"first", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RemoveStyleBoxes", "[", "string_String", "]"}], ":=", 
    RowBox[{"StringReplace", "[", 
     RowBox[{"string", ",", 
      RowBox[{
       RowBox[{"StringExpression", "[", 
        RowBox[{
        "\"\<\\!\\(\\*StyleBox[\\\"\>\"", ",", "x___", ",", "\"\<\\\"\>\"", 
         ",", "y___", ",", "\"\<]\\)\>\""}], "]"}], "\[RuleDelayed]", "x"}]}],
      "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "string_String", "]"}], ":=", 
     RowBox[{"Removetext", "@", 
      RowBox[{"ToString", "@", 
       RowBox[{"TeXForm", "@", 
        RowBox[{"RemoveStyleBoxes", "@", "string"}]}]}]}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True],

Cell["Special strings not properly handled by TeXForm", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Tex", "[", "\"\<\[Eth]\>\"", "]"}], "=", 
  "\"\<\\\\eth\>\""}]], "Input",
 InitializationCell->True],

Cell[BoxData["\<\"\\\\eth\"\>"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["3.4. Functions", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Functions", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Sin", "]"}], ":=", "\"\<\\\\sin\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Cos", "]"}], ":=", "\"\<\\\\cos\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Sec", "]"}], ":=", "\"\<\\\\sec\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Csc", "]"}], ":=", "\"\<\\\\csc\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Cot", "]"}], ":=", "\"\<\\\\cot\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Tan", "]"}], ":=", "\"\<\\\\tan\>\""}], 
    ";"}]}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.5. Symbols", "Subsection"],

Cell["Symbol formatting on the result of PrintAs:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Symbols", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"including", " ", "constant"}], "-", 
      RowBox[{"symbols", " ", "and", " ", "parameters"}]}], ")"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", "symbol_Symbol", "]"}], ":=", 
    RowBox[{"Tex", "@", 
     RowBox[{"PrintAs", "[", "symbol", "]"}]}]}], ";"}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.6. Indices", "Subsection"],

Cell["\<\
Add an extra space at the end of the string if we find a backslash. This is \
to avoid things like \[OpenCurlyDoubleQuote]\\alphab\[CloseCurlyDoubleQuote] \
instead of \[OpenCurlyDoubleQuote]\\alpha b\[CloseCurlyDoubleQuote] in the \
list of indices.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtraSpaceIfBackslash", "[", "str_String", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"StringFreeQ", "[", 
      RowBox[{"str", ",", "\"\<\\\\\>\""}], "]"}], ",", "str", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"str", ",", "\"\< \>\""}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell["\<\
Those indices which are not recognized by neither UpIndexQ or DownIndexQ (for \
example patterns) are treated as symbols from the IndexForm:\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexIndexForm", "[", "index_", "]"}], ":=", 
  RowBox[{"Tex", "[", 
   RowBox[{"IndexForm", "[", "index", "]"}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"One", " ", "index"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TexUpIndex", "[", "index_", "]"}], ":=", 
    RowBox[{"ExtraSpaceIfBackslash", "@", 
     RowBox[{"TexIndexForm", "@", "index"}]}]}], ";"}]}]], "Input",
 InitializationCell->True],

Cell["\<\
Jose\[CloseCurlyQuote]s old code. Now deactivated.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Lists", " ", "of", " ", "indices"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", "list_IndexList", "]"}], ":=", 
     RowBox[{"Apply", "[", 
      RowBox[{"StringJoin", ",", 
       RowBox[{"TexIndex", "/@", "list"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", 
      RowBox[{"list_IndexList", ",", "der_String"}], "]"}], ":=", 
     "\"\<TODO\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", 
      RowBox[{"IndexList", "[", "]"}], "]"}], ":=", 
     RowBox[{"Sequence", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Individual", " ", "index"}], ",", " ", 
     RowBox[{
     "with", " ", "or", " ", "without", " ", "a", " ", "derivative"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", 
      RowBox[{"index_", "?", "UpIndexQ"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<{}^{\>\"", ",", 
       RowBox[{"TexUpIndex", "[", "index", "]"}], ",", "\"\<}\>\""}], "]"}]}],
     ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", 
      RowBox[{"index_", "?", "DownIndexQ"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<{}_{\>\"", ",", 
       RowBox[{"TexUpIndex", "[", 
        RowBox[{"ChangeIndex", "[", "index", "]"}], "]"}], ",", "\"\<}\>\""}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", 
      RowBox[{
       RowBox[{"index_", "?", "UpIndexQ"}], ",", "der_String"}], "]"}], ":=", 
     
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<{}^{\>\"", ",", 
       RowBox[{"Tex", "@", "der"}], ",", 
       RowBox[{"TexUpIndex", "[", "index", "]"}], ",", "\"\<}\>\""}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", 
      RowBox[{
       RowBox[{"index_", "?", "DownIndexQ"}], ",", "der_String"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<{}_{\>\"", ",", 
       RowBox[{"Tex", "@", "der"}], ",", 
       RowBox[{"TexUpIndex", "[", 
        RowBox[{"ChangeIndex", "[", "index", "]"}], "]"}], ",", "\"\<}\>\""}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", "index_", "]"}], ":=", 
     RowBox[{"ToString", "[", "index", "]"}]}], ";"}]}]}]], "Input",
 Evaluatable->False],

Cell["\<\
Thomas\[CloseCurlyQuote] newer code. Highly recursive:\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$TexPrintInitialBracesQ", "=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"initbraces", "[", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{"$TexPrintInitialBracesQ", ",", "\"\<{}\>\"", ",", "\"\<\>\""}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Main", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexIndices", "[", "]"}], ":=", 
   RowBox[{"Sequence", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexIndices", "[", 
    RowBox[{
     RowBox[{"first_", "?", "UpIndexQ"}], ",", "more___"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"initbraces", "[", "]"}], ",", "\"\<^{\>\"", ",", 
     RowBox[{"TexUpIndex", "[", "first", "]"}], ",", 
     RowBox[{"TexIndicesFromUp", "[", "more", "]"}], ",", "\"\<}\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TexIndices", "[", 
     RowBox[{
      RowBox[{"first_", "?", "DownIndexQ"}], ",", "more___"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"initbraces", "[", "]"}], ",", "\"\<_{\>\"", ",", 
      RowBox[{"TexUpIndex", "[", 
       RowBox[{"ChangeIndex", "@", "first"}], "]"}], ",", 
      RowBox[{"TexIndicesFromDown", "[", "more", "]"}], ",", "\"\<}\>\""}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Previous", " ", "index", " ", "was", " ", "up"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexIndicesFromUp", "[", "]"}], ":=", 
   RowBox[{"Sequence", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexIndicesFromUp", "[", 
    RowBox[{
     RowBox[{"first_", "?", "UpIndexQ"}], ",", "more___"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"TexUpIndex", "[", "first", "]"}], ",", 
     RowBox[{"TexIndicesFromUp", "[", "more", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TexIndicesFromUp", "[", 
     RowBox[{
      RowBox[{"first_", "?", "DownIndexQ"}], ",", "more___"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<}{}_{\>\"", ",", 
      RowBox[{"TexUpIndex", "[", 
       RowBox[{"ChangeIndex", "@", "first"}], "]"}], ",", 
      RowBox[{"TexIndicesFromDown", "[", "more", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Previous", " ", "index", " ", "was", " ", "down"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexIndicesFromDown", "[", "]"}], ":=", 
   RowBox[{"Sequence", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexIndicesFromDown", "[", 
    RowBox[{
     RowBox[{"first_", "?", "DownIndexQ"}], ",", "more___"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"TexUpIndex", "[", 
      RowBox[{"ChangeIndex", "@", "first"}], "]"}], ",", 
     RowBox[{"TexIndicesFromDown", "[", "more", "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TexIndicesFromDown", "[", 
     RowBox[{
      RowBox[{"first_", "?", "UpIndexQ"}], ",", "more___"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<}{}^{\>\"", ",", 
      RowBox[{"TexUpIndex", "[", "first", "]"}], ",", 
      RowBox[{"TexIndicesFromUp", "[", "more", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "With", " ", "derivative", " ", "indices", " ", "in", " ", "postfix", " ", 
    "notation"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TexCovDIndices", "[", "post_", "]"}], "[", 
    RowBox[{
     RowBox[{"first_", "?", "UpIndexQ"}], ",", "more___"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<{}^{\>\"", ",", "post", ",", 
     RowBox[{"TexUpIndex", "[", "first", "]"}], ",", 
     RowBox[{"TexIndicesFromUp", "[", "more", "]"}], ",", "\"\<}\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TexCovDIndices", "[", "post_", "]"}], "[", 
    RowBox[{
     RowBox[{"first_", "?", "DownIndexQ"}], ",", "more___"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<{}_{\>\"", ",", "post", ",", 
     RowBox[{"TexUpIndex", "[", 
      RowBox[{"ChangeIndex", "@", "first"}], "]"}], ",", 
     RowBox[{"TexIndicesFromDown", "[", "more", "]"}], ",", "\"\<}\>\""}], 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.7. Operators", "Subsection"],

Cell[TextData[{
 "Note that ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " expands -(a+b) into -a-b, but not -2(a+b). We also include the former \
case, because we could be formatting a held expression, for instance."
}], "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Unary", " ", "minus"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TexOperator", "[", "Minus", "]"}], "=", "\"\<- \>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"-", "expr_Plus"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexOperator", "[", "Minus", "]"}], ",", 
       RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
       RowBox[{"Tex", "[", "expr", "]"}], ",", 
       RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"-", "expr_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"TexOperator", "[", "Minus", "]"}], "<>", 
      RowBox[{"Tex", "[", "expr", "]"}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Product", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TexOperator", "[", "Times", "]"}], ":=", "\"\< \>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexFactor", "[", "1", "]"}], ":=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexFactor", "[", 
      RowBox[{"-", "1"}], "]"}], ":=", 
     RowBox[{"TexOperator", "[", "Minus", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexFactor", "[", "expr_Plus", "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
       RowBox[{"Tex", "[", "expr", "]"}], ",", 
       RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexFactor", "[", "expr_", "]"}], ":=", 
     RowBox[{"Tex", "[", "expr", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexOrdinaryTimes", "[", "expr_Times", "]"}], ":=", 
     RowBox[{"StringJoin", "@@", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"TexFactor", "/@", 
         RowBox[{"List", "@@", "expr"}]}], ",", 
        RowBox[{"TexOperator", "[", "Times", "]"}]}], "]"}]}]}], ";"}], "\n", 
   
   RowBox[{
    RowBox[{
     RowBox[{"TexOrdinaryTimes", "[", "expr_", "]"}], ":=", 
     RowBox[{"Tex", "@", "expr"}]}], ";"}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexFractionAsFraction", "=", "True"}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", "expr_Times", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"numer", "=", 
        RowBox[{"Numerator", "[", "expr", "]"}]}], ",", 
       RowBox[{"denom", "=", 
        RowBox[{"Denominator", "[", "expr", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"And", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"NumberQ", "[", "denom", "]"}]}], ",", 
         "$TexFractionAsFraction"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"TexFracExpression", "[", 
        RowBox[{"numer", ",", "denom", ",", "$TexFraction"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TexOrdinaryTimes", "[", "expr", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Sum", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TexOperator", "[", "Plus", "]"}], ":=", "\"\< + \>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "expr_Plus", "]"}], ":=", 
     RowBox[{"StringJoin", "@@", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"Tex", "/@", 
         RowBox[{"List", "@@", "expr"}]}], ",", 
        RowBox[{"TexOperator", "[", "Plus", "]"}]}], "]"}]}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Square", " ", "root", " ", "of", " ", "a", " ", "number"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"num_", "?", "NumberQ"}], "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<\\\\sqrt{\>\"", ",", 
       RowBox[{"Tex", "[", "num", "]"}], ",", "\"\<}\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Power", "[", 
       RowBox[{
        RowBox[{"num_", "?", "NumberQ"}], ",", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]}], "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"$TexSmallFraction", ",", "\"\<{1}{\\\\sqrt{\>\"", ",", 
       RowBox[{"Tex", "[", "num", "]"}], ",", "\"\<}}\>\""}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True],

Cell["\<\
Special code to include square roots of numbers in the fractions.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExtractNumericalFactor", "[", "expr_Times", "]"}], ":=", 
   RowBox[{"Times", "@@", 
    RowBox[{"(", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"List", "@@", "expr"}], ",", "NumberQ"}], "]"}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtractNumericalFactor", "[", 
    RowBox[{"num_", "?", "NumberQ"}], "]"}], ":=", "num"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtractNumericalFactor", "[", "___", "]"}], ":=", "1"}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Other", " ", "square", " ", "roots"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{"expr", ":", 
      RowBox[{"Times", "[", 
       RowBox[{
        RowBox[{"Power", "[", 
         RowBox[{
          RowBox[{"num_", "?", "NumberQ"}], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "]"}], ",", "___"}], "]"}]}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"numfactor", "=", 
         RowBox[{"ExtractNumericalFactor", "[", 
          RowBox[{"expr", " ", 
           RowBox[{"Sqrt", "[", "num", "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"numer", "=", 
         RowBox[{"Numerator", "[", 
          RowBox[{"expr", " ", 
           RowBox[{"Sqrt", "[", "num", "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"denom1", "=", 
         RowBox[{"Denominator", "[", 
          RowBox[{"expr", " ", 
           RowBox[{"Sqrt", "[", "num", "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Or", "[", 
         RowBox[{
          RowBox[{"!", "$TexFractionAsFraction"}], ",", 
          RowBox[{"NumberQ", "[", "denom1", "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{"TexFracExpression", "[", 
           RowBox[{
            RowBox[{"Numerator", "[", "numfactor", "]"}], ",", 
            RowBox[{
             RowBox[{"Denominator", "[", "numfactor", "]"}], 
             RowBox[{"Sqrt", "[", "num", "]"}]}], ",", "$TexSmallFraction"}], 
           "]"}], ",", 
          RowBox[{"TexFactor", "[", 
           RowBox[{"expr", " ", 
            RowBox[{
             RowBox[{"Sqrt", "[", "num", "]"}], "/", "numfactor"}]}], "]"}]}],
          "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"TexFracExpression", "[", 
         RowBox[{"numer", ",", 
          RowBox[{"denom1", " ", 
           RowBox[{"Sqrt", "[", "num", "]"}]}], ",", "$TexFraction"}], 
         "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Power", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TexOperator", "[", "Power", "]"}], ":=", "\"\<^\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexBase", "[", 
      RowBox[{"x", ":", 
       RowBox[{"(", 
        RowBox[{"_Symbol", "|", "_Integer", "|", 
         RowBox[{
          RowBox[{"_", "?", "xTensorQ"}], "[", "___", "]"}]}], ")"}]}], "]"}],
      ":=", 
     RowBox[{"Tex", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexBase", "[", 
      RowBox[{"x", ":", 
       RowBox[{"Scalar", "[", "expr_", "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Tex", "[", "x", "]"}], "/;", "$TexScalarParentheses"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexBase", "[", "x_", "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
       RowBox[{"Tex", "[", "x", "]"}], ",", 
       RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexExponent", "[", "x_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$TexSmallFraction", "=", "$TexSmallFractionExponent"}], 
        "}"}], ",", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tex", "=", 
           RowBox[{"Tex", "[", "x", "]"}]}], "}"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringLength", "[", "tex", "]"}], "===", "1"}], ",", 
           "tex", ",", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<{\>\"", ",", "tex", ",", "\"\<}\>\""}], "]"}]}], 
          "]"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Tex", "[", 
       RowBox[{"Power", "[", 
        RowBox[{"x_", ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<\\\\frac{1}{\>\"", ",", 
         RowBox[{"Tex", "[", "x", "]"}], ",", "\"\<}\>\""}], "]"}], "/;", 
       RowBox[{
        RowBox[{"ByteCount", "[", "x", "]"}], "<", "200"}]}]}], ";"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Power", "[", 
       RowBox[{"x_", ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"TexFracExpression", "[", 
       RowBox[{"1", ",", "x", ",", "$TexFraction"}], "]"}], "/;", 
      "$TexFractionAsFraction"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Power", "[", 
       RowBox[{"x_", ",", "n_"}], "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexBase", "[", "x", "]"}], ",", 
       RowBox[{"TexOperator", "[", "Power", "]"}], ",", 
       RowBox[{"TexExponent", "[", "n", "]"}]}], "]"}]}], ";"}]}]}]], "Input",
 
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.8. Basis objects", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", " ", "Basis", " ", "*)"}]], "Input",
 InitializationCell->True],

Cell["\<\
This has to come before the general tensor code because we might want to \
change the typesetting for a basis object.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Basis", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
  RowBox[{"TexBasis", "[", 
   RowBox[{"a", ",", "b"}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexBasis", "[", "inds__", "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"Tex", "[", "Basis", "]"}], ",", 
     RowBox[{"TexIndices", "[", "inds", "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FormatTexBasis", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i_Integer", ",", 
       RowBox[{"basis_", "?", "BasisQ"}]}], "}"}], ",", "texstring_String"}], 
    "]"}], ":=", 
   RowBox[{"SetDelayed", "[", 
    RowBox[{
     RowBox[{"TexBasis", "[", 
      RowBox[{"ind_", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "basis"}], "}"}]}], "]"}], ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"texstring", ",", 
       RowBox[{"TexIndices", "[", "ind", "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FormatTexBasis", "[", 
    RowBox[{"{", 
     RowBox[{"i_Integer", ",", 
      RowBox[{"basis_", "?", "BasisQ"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Unset", "[", 
    RowBox[{"TexBasis", "[", 
     RowBox[{"ind_", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "basis"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FormatTexBasis", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i_Integer", ",", 
       RowBox[{"-", 
        RowBox[{"basis_", "?", "BasisQ"}]}]}], "}"}], ",", 
     "texstring_String"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"SetDelayed", "[", 
    RowBox[{
     RowBox[{"TexBasis", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"-", "basis"}]}], "}"}], ",", "ind_"}], "]"}], ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"texstring", ",", 
       RowBox[{"TexIndices", "[", "ind", "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FormatTexBasis", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"covd_Symbol", "?", "CovDQ"}], "[", 
      RowBox[{"{", 
       RowBox[{"i_Integer", ",", "basis_"}], "}"}], "]"}], ",", 
     "texstring_String"}], "]"}], ":=", 
   RowBox[{"SetDelayed", "[", 
    RowBox[{
     RowBox[{"TexCovDPrefix", "[", 
      RowBox[{"covd", ",", 
       RowBox[{"IndexList", "[", 
        RowBox[{"{", 
         RowBox[{"i", ",", "basis"}], "}"}], "]"}]}], "]"}], ",", 
     "texstring"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormatTexBasis", "[", 
   RowBox[{
    RowBox[{"covd_Symbol", "?", "CovDQ"}], "[", 
    RowBox[{"{", 
     RowBox[{"i_Integer", ",", "basis_"}], "}"}], "]"}], "]"}], ":=", 
  RowBox[{"Unset", "[", 
   RowBox[{"TexCovDPrefix", "[", 
    RowBox[{"covd", ",", 
     RowBox[{"IndexList", "[", 
      RowBox[{"{", 
       RowBox[{"i", ",", "basis"}], "}"}], "]"}]}], "]"}], "]"}]}]}], "Input",
 
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.9. Tensors", "Subsection"],

Cell["Jose\[CloseCurlyQuote]s old code on tensors:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Tensors", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{
       RowBox[{"tensor_", "?", "xTensorQ"}], "[", "indices___", "]"}], "]"}], 
     ":=", 
     RowBox[{"TexTensorCombine", "[", 
      RowBox[{
       RowBox[{"Tex", "[", "tensor", "]"}], ",", 
       RowBox[{"TexIndex", "/@", 
        RowBox[{"IndexList", "[", "indices", "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexTensorCombine", "[", 
      RowBox[{"tensor_", ",", 
       RowBox[{"IndexList", "[", "indices___", "]"}]}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"tensor", ",", "indices"}], "]"}]}], ";"}]}]}]], "Input",
 Evaluatable->False],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"New symbol created: \"\>", 
   "\[InvisibleSpace]", "\<\"TexTensorCombine\"\>", 
   "\[InvisibleSpace]", "\<\", Context: \"\>", 
   "\[InvisibleSpace]", "\<\"xAct`xTensor`Private`\"\>"}],
  SequenceForm[
  "New symbol created: ", "TexTensorCombine", ", Context: ", 
   "xAct`xTensor`Private`"],
  Editable->False]], "Print"]
}, Open  ]],

Cell["\<\
Thomas\[CloseCurlyQuote] code, producing less parenthesization:\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Tensors", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{
      RowBox[{"tensor_", "?", "xTensorQ"}], "[", "indices___", "]"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"Tex", "[", "tensor", "]"}], ",", 
      RowBox[{"TexIndices", "[", "indices", "]"}]}], "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.10. Scalar functions", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Derivatives", " ", "of", " ", "scalar", " ", "functions"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"deriv", "[", 
      RowBox[{"var_", ",", "1"}], "]"}], ":=", 
     RowBox[{"\"\<\\\\partial \>\"", "<>", 
      RowBox[{"Tex", "[", "var", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"deriv", "[", 
      RowBox[{"var_", ",", "n_"}], "]"}], ":=", 
     RowBox[{"\"\<\\\\partial^{\>\"", "<>", 
      RowBox[{"Tex", "[", "n", "]"}], "<>", "\"\<}\>\"", "<>", 
      RowBox[{"Tex", "[", "var", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"withrespectto", "[", 
      RowBox[{"vars_List", ",", "ders_List"}], "]"}], ":=", 
     RowBox[{"Inner", "[", 
      RowBox[{"withrespectto", ",", "vars", ",", "ders", ",", "StringJoin"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"withrespectto", "[", 
      RowBox[{"var_", ",", "0"}], "]"}], ":=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"withrespectto", "[", 
      RowBox[{"var_", ",", "1"}], "]"}], ":=", 
     RowBox[{"\"\<\\\\partial \>\"", "<>", 
      RowBox[{"Tex", "[", "var", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"withrespectto", "[", 
      RowBox[{"var_", ",", "n_"}], "]"}], ":=", 
     RowBox[{"\"\<\\\\partial \>\"", "<>", 
      RowBox[{"Tex", "[", "var", "]"}], "<>", "\"\<^{\>\"", "<>", 
      RowBox[{"Tex", "[", "n", "]"}], "<>", "\"\<}\>\""}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "ders__", "]"}], "[", 
        RowBox[{"f_", "?", "ScalarFunctionQ"}], "]"}], "[", "vars__", "]"}], 
      "]"}], ":=", 
     RowBox[{"\"\<\\\\frac{\>\"", "<>", 
      RowBox[{"deriv", "[", 
       RowBox[{
        RowBox[{"f", "[", "vars", "]"}], ",", 
        RowBox[{"Plus", "[", "ders", "]"}]}], "]"}], "<>", "\"\<}{\>\"", "<>", 
      RowBox[{"withrespectto", "[", 
       RowBox[{
        RowBox[{"{", "vars", "}"}], ",", 
        RowBox[{"{", "ders", "}"}]}], "]"}], "<>", "\"\<}\>\""}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Factorial", "[", "n_Symbol", "]"}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"Tex", "[", "n", "]"}], ",", "\"\<!\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Factorial", "[", "n_", "]"}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
    RowBox[{"Tex", "[", "n", "]"}], ",", 
    RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}], ",", "\"\<!\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Factorial2", "[", "n_Symbol", "]"}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"Tex", "[", "n", "]"}], ",", "\"\<!!\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Factorial2", "[", "n_", "]"}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
    RowBox[{"Tex", "[", "n", "]"}], ",", 
    RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}], ",", "\"\<!!\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Pochhammer", "[", 
    RowBox[{"n_", ",", "k_"}], "]"}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
    RowBox[{"Tex", "[", "n", "]"}], ",", 
    RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}], ",", "\"\<_{\>\"", ",", 
    RowBox[{"Tex", "[", "k", "]"}], ",", "\"\<}\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Binomial", "[", 
    RowBox[{"n_", ",", "k_"}], "]"}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{"\"\<\\\\binom{\>\"", ",", 
    RowBox[{"Tex", "[", "n", "]"}], ",", "\"\<}{\>\"", ",", 
    RowBox[{"Tex", "[", "k", "]"}], ",", "\"\<}\>\""}], "]"}]}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Other", " ", "scalar", " ", "functions"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{
       RowBox[{"f_", "?", "ScalarFunctionQ"}], "[", "args__", "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"Tex", "[", "f", "]"}], ",", 
       RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"InsertComma", "[", 
         RowBox[{"Tex", "/@", 
          RowBox[{"{", "args", "}"}]}], "]"}]}], ",", 
       RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"InsertComma", "[", "arguments_List", "]"}], ":=", 
     RowBox[{"Insert", "[", 
      RowBox[{"arguments", ",", "\"\<, \>\"", ",", 
       RowBox[{"List", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"2", ",", 
          RowBox[{"Length", "[", "arguments", "]"}]}], "]"}]}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.11. Inert heads", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Innert", " ", "heads"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{
      RowBox[{"ih_", "?", "InertHeadQ"}], "[", 
      RowBox[{"expr_", ",", "z___"}], "]"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"Tex", "[", "ih", "]"}], ",", 
      RowBox[{"TexOpen", "[", "\"\<[\>\"", "]"}], ",", 
      RowBox[{"Tex", "[", "expr", "]"}], ",", 
      RowBox[{"TexClose", "[", "\"\<]\>\"", "]"}]}], "]"}]}], 
   ";"}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.12. Scalar expressions", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Remove", " ", "the", " ", "Scalar", " ", "head"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"$TexScalarParentheses", "=", "True"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Scalar", "[", "expr_", "]"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{"$TexScalarParentheses", ",", "\[IndentingNewLine]", 
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
         RowBox[{"Tex", "[", "expr", "]"}], ",", 
         RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Tex", "[", "expr", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.13. Covariant derivatives", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Covariant", " ", "derivatives"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"covd_Symbol", "?", "CovDQ"}], "[", "inds__", "]"}], "[", 
       "expr_", "]"}], "]"}], ":=", 
     RowBox[{"TexCovDCombine", "[", 
      RowBox[{"covd", ",", 
       RowBox[{"Tex", "[", "expr", "]"}], ",", 
       RowBox[{"IndexList", "[", "inds", "]"}], ",", "$CovDFormat"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexCovDCombine", "[", 
      RowBox[{
      "covd_", ",", "exprstring_String", ",", "list_IndexList", ",", 
       "\"\<Prefix\>\""}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexCovDPrefix", "[", 
        RowBox[{"covd", ",", "list"}], "]"}], ",", "exprstring"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexCovDPrefix", "[", 
      RowBox[{"covd_", ",", "list_IndexList"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"Last", "@", 
        RowBox[{"TexCovD", "[", "covd", "]"}]}], ",", 
       RowBox[{"TexIndices", "@@", "list"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexCovDCombine", "[", 
      RowBox[{
      "covd_", ",", "exprstring_String", ",", "list_IndexList", ",", 
       "\"\<Postfix\>\""}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"exprstring", ",", 
       RowBox[{
        RowBox[{"TexCovDIndices", "[", 
         RowBox[{"First", "@", 
          RowBox[{"TexCovD", "@", "covd"}]}], "]"}], "@@", "list"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "If", " ", "the", " ", "$CovDFormat", " ", "only", " ", "gives", " ", 
      "one", " ", "string"}], ",", " ", 
     RowBox[{"use", " ", "it", " ", "for", " ", "both", " ", 
      RowBox[{"cases", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexCovD", "[", "covd_", "]"}], ":=", 
     RowBox[{"Tex", "/@", 
      RowBox[{"SymbolOfCovD", "[", "covd", "]"}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"TexCovDCombine", "[", 
     RowBox[{
      RowBox[{"{", "a_", "}"}], ",", "b___"}], "]"}], ":=", 
    RowBox[{"TexCovDCombine", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "a"}], "}"}], ",", "b"}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{"CovD", "[", 
      RowBox[{"expr_", ",", "ders___", ",", 
       RowBox[{
        RowBox[{"der_Symbol", "?", "CovDQ"}], "[", "inds__", "]"}]}], "]"}], 
     "]"}], ":=", 
    RowBox[{"TexCovDCombine", "[", 
     RowBox[{
      RowBox[{"TexCovD", "[", "der", "]"}], ",", 
      RowBox[{"Tex", "[", "expr", "]"}], ",", 
      RowBox[{"IndexList", "[", "inds", "]"}], ",", "$CovDFormat"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "*)"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.14. Lie derivatives", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Lie", " ", "derivatives"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{
      RowBox[{"LieD", "[", 
       RowBox[{"n_Symbol", "[", "_", "]"}], "]"}], "[", "expr_", "]"}], "]"}],
     ":=", 
    RowBox[{"\"\<\\\\mathcal{L}_\>\"", "<>", 
     RowBox[{"Tex", "[", "n", "]"}], "<>", 
     RowBox[{"Tex", "[", "expr", "]"}]}]}], ";"}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.15. Parametric derivatives", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Parametric", " ", "derivative"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TexParamD", "[", 
      RowBox[{"{", "ps_", "}"}], "]"}], ":=", 
     RowBox[{"\"\<\\\\partial_\>\"", "<>", 
      RowBox[{"Tex", "[", "ps", "]"}], "<>", "\"\< \>\""}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexParamD", "[", 
      RowBox[{"ps", ":", 
       RowBox[{"{", "__", "}"}]}], "]"}], ":=", 
     RowBox[{"\"\<\\\\partial_\>\"", "<>", 
      RowBox[{"Tex", "[", 
       RowBox[{"First", "[", "ps", "]"}], "]"}], "<>", "\"\<^{\>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"Length", "[", "ps", "]"}], "]"}], "<>", "\"\<} \>\""}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{
       RowBox[{"ParamD", "[", "ps__", "]"}], "[", "expr_", "]"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"$ParamDFormat", "==", "\"\<Postfix\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"Tex", "[", "expr", "]"}], ",", "\"\<{}_{,\>\"", ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{"Tex", "/@", 
            RowBox[{"{", "ps", "}"}]}], ")"}]}], ",", "\"\<}\>\""}], "]"}], 
       ",", 
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{"StringJoin", ",", 
          RowBox[{"TexParamD", "/@", 
           RowBox[{"Split", "@", 
            RowBox[{"Sort", "[", 
             RowBox[{"{", "ps", "}"}], "]"}]}]}]}], "]"}], "<>", 
        RowBox[{"Tex", "[", "expr", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Tex", "[", 
       RowBox[{
        RowBox[{"ParamD", "[", "ps__", "]"}], "[", "expr_", "]"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"StringJoin", ",", 
         RowBox[{"TexParamD", "/@", 
          RowBox[{"Split", "@", 
           RowBox[{"Sort", "[", "ps", "]"}]}]}]}], "]"}], "<>", 
       RowBox[{"TexOpen", "[", "\"\<[\>\"", "]"}], "<>", 
       RowBox[{"Tex", "[", "expr", "]"}], "<>", 
       RowBox[{"TexClose", "[", "\"\<]\>\"", "]"}]}]}], ";"}], 
    "\[IndentingNewLine]", "*)"}]}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.16. Equalities and inequalities", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Equal", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{"Equal", "[", 
      RowBox[{"lhs_", ",", "rhs_"}], "]"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"Tex", "[", "lhs", "]"}], ",", "\"\< = \>\"", ",", 
      RowBox[{"Tex", "[", "rhs", "]"}]}], "]"}]}], ";"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Less", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{"Less", "[", 
      RowBox[{"lhs_", ",", "rhs_"}], "]"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"Tex", "[", "lhs", "]"}], ",", "\"\< < \>\"", ",", 
      RowBox[{"Tex", "[", "rhs", "]"}]}], "]"}]}], ";"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "LessEqual", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{"LessEqual", "[", 
      RowBox[{"lhs_", ",", "rhs_"}], "]"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"Tex", "[", "lhs", "]"}], ",", "\"\< \\\\leq \>\"", ",", 
      RowBox[{"Tex", "[", "rhs", "]"}]}], "]"}]}], ";"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Less", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{"Greater", "[", 
      RowBox[{"lhs_", ",", "rhs_"}], "]"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"Tex", "[", "lhs", "]"}], ",", "\"\< > \>\"", ",", 
      RowBox[{"Tex", "[", "rhs", "]"}]}], "]"}]}], ";"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "LessEqual", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{"GreaterEqual", "[", 
      RowBox[{"lhs_", ",", "rhs_"}], "]"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"Tex", "[", "lhs", "]"}], ",", "\"\< \\\\geq \>\"", ",", 
      RowBox[{"Tex", "[", "rhs", "]"}]}], "]"}]}], ";"}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.17. The TexPrint function", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexFixExtraRules", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Note", " ", "that", " ", "we", " ", "remove", " ", "the", " ", 
    RowBox[{"dollars", "!"}], " ", "This", " ", "is", " ", "because", " ", 
    "\[Mu]3", " ", "is", " ", "converted", " ", "into", " ", 
    RowBox[{"$", "\\", "mu$3"}], " ", "for", " ", "instance"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TexFix", "[", "string_String", "]"}], ":=", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringReplace", "[", 
       RowBox[{"string", ",", 
        RowBox[{"\"\<$\>\"", "->", "\"\<\>\""}]}], "]"}], ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<+-\>\"", "\[Rule]", "\"\<-\>\""}], ",", 
          RowBox[{"\"\<+ -\>\"", "\[Rule]", "\"\<- \>\""}], ",", 
          RowBox[{"\"\< _\>\"", "->", "\"\<_\>\""}], ",", 
          RowBox[{"\"\< ^\>\"", "->", "\"\<^\>\""}], ",", 
          RowBox[{"\"\<  \>\"", "->", "\"\< \>\""}], ",", 
          RowBox[{"\"\<   \>\"", "->", "\"\< \>\""}], ",", " ", 
          RowBox[{"\"\< }\>\"", "\[Rule]", "\"\<}\>\""}]}], "}"}], ",", 
        "$TexFixExtraRules"}], "]"}]}], "]"}]}], ";"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Main", ".", " ", "Public"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TexPrint", "[", 
     RowBox[{"expr_", ",", 
      RowBox[{"initlevel_:", "Automatic"}]}], "]"}], ":=", 
    RowBox[{"TexFix", "@", 
     RowBox[{"TexParenthesis", "[", 
      RowBox[{
       RowBox[{"ScreenDollarIndices", "[", "expr", "]"}], ",", "initlevel"}], 
      "]"}]}]}], ";"}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.18. Matrices", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexMatrix", "[", 
   RowBox[{
    RowBox[{"M_", "?", "MatrixQ"}], ",", 
    RowBox[{"F_:", " ", "Tex"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rows", "=", 
       RowBox[{"Length", "[", "M", "]"}]}], ",", 
      RowBox[{"cols", "=", 
       RowBox[{"Length", "@", 
        RowBox[{"First", "@", "M"}]}]}]}], "}"}], ",", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<\\\\left(\\\\begin{array}{\>\"", ",", 
      RowBox[{"StringJoin", "@@", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"\"\<c\>\"", ",", 
         RowBox[{"{", "cols", "}"}]}], "]"}]}], ",", "\"\<}\\n\>\"", ",", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"Riffle", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{"Riffle", "[", 
             RowBox[{
              RowBox[{"F", "/@", "#"}], ",", "\"\< & \>\""}], "]"}], "]"}], 
           "&"}], "/@", "M"}], ",", "\"\<\\\\\\\\\\n\>\""}], "]"}], "]"}], 
      ",", "\"\<\\n\\\\end{array}\\\\right)\>\""}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["3.19. Hold", "Subsection"],

Cell["\<\
Hold can be used to stop a derivative to use the Leibniz rule, and it can \
also stop other automatic rules to be applied. Therefore, it might be a \
useful tool for typesetting too. We just typeset it as a parentesis.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"Hold", "[", "expr_", "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
     RowBox[{"Tex", "[", "expr", "]"}], ",", 
     RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["4. SymManipulator", "Section",
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell["4.1. Tex for SymH and CovarD", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xAct`SymManipulator`SymH", "[", 
      RowBox[{"headlist_", ",", "sym_", ",", "label_"}], "]"}], "?", 
     "xTensorQ"}], "[", "inds___", "]"}], "]"}], ":=", 
  RowBox[{"TexSymH", "[", 
   RowBox[{
    RowBox[{"xAct`SymManipulator`SymH", "[", 
     RowBox[{"headlist", ",", "sym", ",", "label"}], "]"}], "[", "inds", 
    "]"}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"xAct`SymManipulator`CovarD", "[", 
     RowBox[{
      RowBox[{"D1_", "?", "CovDQ"}], ",", 
      RowBox[{"T_", "?", "xTensorQ"}], ",", "list_"}], "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Last", "@", 
       RowBox[{"SymbolOfCovD", "[", "D1", "]"}]}], "]"}], ",", 
     RowBox[{"Tex", "[", "T", "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["4.2. TexSymH", "Subsection"],

Cell["\<\
This is a new code that can handle all cases that are possible to write in a \
nice way. The symmetries that are accepted are disjoint unions of symmetric \
and antisymmetric groups. The indices belonging to one such disjoint subgroup \
have to be all up or all down. If two disjoint subgroups are both acting on \
up or down indices, they have to act on disjoint ranges of indices. If any of \
these criteria fails, messages are printed, and the output is similar to the \
display form. \
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexGroupSymbols", "[", 
    RowBox[{"points_", ",", "sym_"}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"xAct`SymManipulator`SubgroupQ", "[", 
      RowBox[{
       RowBox[{"Symmetric", "[", "points", "]"}], ",", "sym"}], "]"}], ",", 
     RowBox[{"(*", " ", "Symmetric", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<(\>\"", ",", "\"\<)\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"xAct`SymManipulator`SubgroupQ", "[", 
      RowBox[{
       RowBox[{"Antisymmetric", "[", "points", "]"}], ",", "sym"}], "]"}], 
     ",", 
     RowBox[{"(*", " ", "Antisymmetric", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<[\>\"", ",", "\"\<]\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", "True", ",", 
     RowBox[{"(*", " ", 
      RowBox[{"Everything", " ", "else"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<Unkown\>\"", ",", "\"\<Unkown\>\""}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexSymH", "[", 
   RowBox[{"x", ":", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"xAct`SymManipulator`SymH", "[", 
       RowBox[{"headlist_", ",", "sym_", ",", "label_"}], "]"}], "[", 
      "inds___", "]"}], ")"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"texfail", "=", "False"}], ",", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "@", 
        RowBox[{"List", "[", "inds", "]"}]}]}], ",", " ", 
      RowBox[{"indlist", "=", 
       RowBox[{"List", "@", "inds"}]}], ",", " ", "longorbits", ",", " ", 
      "orbitgroupsymbols", ",", "orbitondowninds", ",", "orbitonupinds", ",", 
      " ", "downsymorbits", ",", " ", "upsymorbits", ",", " ", 
      "excludesymdowninds", ",", "excludesymupinds", ",", " ", 
      "downindexslots", ",", " ", "beginsym", ",", " ", "endsym", ",", " ", 
      "beginexclude", ",", " ", "endexclude", ",", " ", "preindexsymbolrules",
       ",", " ", "postindexsymbolrules"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"longorbits", "=", 
      RowBox[{"Sort", "/@", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Orbits", "[", 
          RowBox[{"sym", ",", "n"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], ">", "1"}], "&"}]}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"orbitgroupsymbols", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"TexGroupSymbols", "[", 
         RowBox[{"#", ",", "sym"}], "]"}], "&"}], "/@", "longorbits"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{"Select", "[", 
          RowBox[{"orbitgroupsymbols", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#", "]"}], "===", "\"\<Unkown\>\""}], 
            "&"}]}], "]"}]}], ">", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"texfail", "=", "True"}], ";", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", 
         "\"\<Not a disjoint union of symmetric and antisymmetric \
groups.\>\"", "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"downindexslots", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "@", "indlist"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"DownIndexQ", "[", 
          RowBox[{"indlist", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"orbitondowninds", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"xAct`SymManipulator`Private`SubsetQ", "[", 
         RowBox[{"#", ",", "downindexslots"}], "]"}], "&"}], "/@", 
       "longorbits"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"orbitonupinds", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Intersection", "[", 
           RowBox[{"#", ",", "downindexslots"}], "]"}], "]"}], "\[Equal]", 
         "0"}], "&"}], "/@", "longorbits"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"And", "@@", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Or", ",", 
           RowBox[{"{", 
            RowBox[{"orbitondowninds", ",", "orbitonupinds"}], "}"}]}], 
          "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"texfail", "=", "True"}], ";", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\<Not all indices are good positions.\>\"", 
         "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"downsymorbits", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"longorbits", ",", "orbitondowninds"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"upsymorbits", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"longorbits", ",", "orbitonupinds"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "@", 
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{"OrderedQ", "[", 
           RowBox[{"Join", "@@", "downsymorbits"}], "]"}], ",", 
          RowBox[{"OrderedQ", "[", 
           RowBox[{"Join", "@@", "upsymorbits"}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"texfail", "=", "True"}], ";", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\<The symmetries are overlapping.\>\"", "]"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"excludesymdowninds", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"First", "@", "#"}], ",", 
            RowBox[{"Last", "@", "#"}]}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
        "downsymorbits"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"excludesymdowninds", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Intersection", "[", 
         RowBox[{"#", ",", "downindexslots"}], "]"}], "&"}], "/@", 
       "excludesymdowninds"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"excludesymupinds", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"First", "@", "#"}], ",", 
            RowBox[{"Last", "@", "#"}]}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
        "upsymorbits"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"excludesymupinds", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Intersection", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"Range", "@", "n"}], ",", "downindexslots"}], "]"}]}], 
         "]"}], "&"}], "/@", "excludesymupinds"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"beginsym", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"First", "/@", "downsymorbits"}], ",", 
        RowBox[{"First", "/@", "upsymorbits"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"endsym", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Last", "/@", "downsymorbits"}], ",", 
        RowBox[{"Last", "/@", "upsymorbits"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"beginexclude", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"First", "/@", 
         RowBox[{"Select", "[", 
          RowBox[{"excludesymdowninds", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "@", "#"}], ">", "0"}], ")"}], "&"}]}], 
          "]"}]}], ",", 
        RowBox[{"First", "/@", 
         RowBox[{"Select", "[", 
          RowBox[{"excludesymupinds", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "@", "#"}], ">", "0"}], ")"}], "&"}]}], 
          "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"endexclude", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Last", "/@", 
         RowBox[{"Select", "[", 
          RowBox[{"excludesymdowninds", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "@", "#"}], ">", "0"}], ")"}], "&"}]}], 
          "]"}]}], ",", 
        RowBox[{"Last", "/@", 
         RowBox[{"Select", "[", 
          RowBox[{"excludesymupinds", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "@", "#"}], ">", "0"}], ")"}], "&"}]}], 
          "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"preindexsymbolrules", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{"#", ",", 
          RowBox[{"orbitgroupsymbols", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"First", "@", 
              RowBox[{"First", "@", 
               RowBox[{"Position", "[", 
                RowBox[{"longorbits", ",", "#", ",", "2", ",", "1"}], 
                "]"}]}]}], ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], "/@", 
       "beginsym"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"postindexsymbolrules", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{"#", ",", 
          RowBox[{"orbitgroupsymbols", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"First", "@", 
              RowBox[{"First", "@", 
               RowBox[{"Position", "[", 
                RowBox[{"longorbits", ",", "#", ",", "2", ",", "1"}], 
                "]"}]}]}], ",", "2"}], "]"}], "]"}]}], "]"}], "&"}], "/@", 
       "endsym"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"preindexsymbolrules", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"preindexsymbolrules", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Rule", "[", 
           RowBox[{"#", ",", "\"\<|\>\""}], "]"}], "&"}], "/@", 
         "beginexclude"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"postindexsymbolrules", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"postindexsymbolrules", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Rule", "[", 
           RowBox[{"#", ",", "\"\<|\>\""}], "]"}], "&"}], "/@", 
         "endexclude"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"preindexsymbolrules", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "/.", "preindexsymbolrules"}], ")"}], "/.", 
           RowBox[{"Rule", "[", 
            RowBox[{"#", ",", "\"\<\>\""}], "]"}]}]}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", "n", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"postindexsymbolrules", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "/.", "postindexsymbolrules"}], ")"}], "/.", 
           RowBox[{"Rule", "[", 
            RowBox[{"#", ",", "\"\<\>\""}], "]"}]}]}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", "n", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"texfail", ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<Could not typset the SymH object nicely.\>\"", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
         "\"\<\\\\underset{\>\"", ",", "label", ",", "\"\<}{Sym}(\>\"", ",", 
          RowBox[{"TexPrint", "@", 
           RowBox[{"xAct`SymManipulator`RemoveSym", "@", "x"}]}], ",", 
          "\"\<)\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"TexKnownSymH", "[", 
        RowBox[{
        "headlist", ",", "n", ",", " ", "indlist", ",", "preindexsymbolrules",
          ",", " ", "postindexsymbolrules"}], "]"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexKnownSymH", "[", 
   RowBox[{
   "headlist_", ",", "n_", ",", " ", "indlist_", ",", "preindexsymbolrules_", 
    ",", " ", "postindexsymbolrules_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"numindices", "=", 
       RowBox[{"Length", "/@", 
        RowBox[{"SlotsOfTensor", "/@", "headlist"}]}]}], ",", 
      "partitionedslots", ",", "internalexpr", ",", " ", "indicesoftensor", 
      ",", " ", 
      RowBox[{"texstring", "=", "\"\<\>\""}], ",", "  ", 
      RowBox[{"texstringtensor", "=", "\"\<\>\""}], ",", " ", 
      RowBox[{"i", "=", "1"}], ",", " ", "CovarDs", ",", " ", 
      RowBox[{"newheadlist", "=", "headlist"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CovarDs", "=", 
      RowBox[{"First", "/@", 
       RowBox[{"Position", "[", 
        RowBox[{"newheadlist", ",", "xAct`SymManipulator`CovarD", ",", "2"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "CovarDs"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"numindices", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"numindices", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "\[Rule]", 
               RowBox[{"Sequence", "[", 
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{"newheadlist", "[", 
                   RowBox[{"[", 
                    RowBox[{"#", ",", "3"}], "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"numindices", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "-", 
                  RowBox[{"Length", "@", 
                   RowBox[{"newheadlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "3"}], "]"}], "]"}]}]}]}], "]"}]}], 
              ")"}], "&"}], "/@", "CovarDs"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newheadlist", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"newheadlist", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "\[Rule]", 
               RowBox[{"Sequence", "[", 
                RowBox[{
                 RowBox[{"Last", "@", 
                  RowBox[{"SymbolOfCovD", "@", 
                   RowBox[{"newheadlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "1"}], "]"}], "]"}]}]}], ",", 
                 RowBox[{"newheadlist", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", ",", "2"}], "]"}], "]"}]}], "]"}]}], ")"}], 
             "&"}], "/@", "CovarDs"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"CovarDs", "=", 
         RowBox[{"First", "/@", 
          RowBox[{"Position", "[", 
           RowBox[{
           "newheadlist", ",", "xAct`SymManipulator`CovarD", ",", "2"}], 
           "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Extract", " ", "indices", " ", "belonging", " ", "to", " ", "the", " ",
        "different", " ", 
       RowBox[{"tensors", ".", " ", "Can"}], " ", "this", " ", "be", " ", 
       "done", " ", "in", " ", "a", " ", "simpler", " ", 
       RowBox[{"way", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"partitionedslots", "=", 
      RowBox[{"Last", "/@", 
       RowBox[{"Rest", "@", 
        RowBox[{"FoldList", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Drop", "[", 
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "#2"}], "]"}], ",", 
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "#2"}], "]"}]}], "}"}], 
           "&"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", "n", "]"}], ",", 
            RowBox[{"{", "}"}]}], "}"}], ",", "numindices"}], "]"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"indicesoftensor", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"indlist", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "partitionedslots"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "@", "newheadlist"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"texstringtensor", "=", " ", 
         RowBox[{"TexTensorWithSym", "[", 
          RowBox[{
           RowBox[{"newheadlist", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"indicesoftensor", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"partitionedslots", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", ",", "preindexsymbolrules", 
           ",", " ", "postindexsymbolrules"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"texstring", "=", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"texstring", ",", "texstringtensor"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"i", "=", 
         RowBox[{"i", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "texstring"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexTensorWithSym", "[", 
   RowBox[{
   "head_", ",", "inds_", ",", "slots_", ",", "preindexsymbolrules_", ",", 
    " ", "postindexsymbolrules_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"texstring", "=", 
       RowBox[{"Tex", "@", "head"}]}], ",", " ", 
      RowBox[{"i", "=", "1"}], ",", " ", "fromdown", ",", 
      RowBox[{"postindexsymbol", "=", "\"\<\>\""}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "inds", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"texstring", "=", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"texstring", ",", 
           RowBox[{"TexSymIndex", "[", 
            RowBox[{
             RowBox[{"inds", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"i", "\[Equal]", "1"}], ",", "fromdown", ",", 
             RowBox[{
              RowBox[{"slots", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "/.", 
              "preindexsymbolrules"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"fromdown", "=", 
         RowBox[{"DownIndexQ", "[", 
          RowBox[{"inds", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"postindexsymbol", "=", 
         RowBox[{
          RowBox[{"slots", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "/.", "postindexsymbolrules"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"texstring", "=", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"texstring", ",", "postindexsymbol"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"i", "=", 
         RowBox[{"i", "+", "1"}]}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "inds"}], ">", "0"}], ",", " ", 
       RowBox[{"texstring", "=", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"texstring", ",", "\"\<}\>\""}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "texstring"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexSymIndex", "[", 
   RowBox[{
   "index_", ",", "firstindexQ_", ",", "fromdownQ_", ",", "preindexsymbol_"}],
    "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "indexstring", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"indexstring", "=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"firstindexQ", "&&", 
         RowBox[{"DownIndexQ", "[", "index", "]"}], "&&", 
         RowBox[{"Not", "[", "$TexPrintInitialBracesQ", "]"}]}], ",", 
        "\"\<_{\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"firstindexQ", "&&", 
         RowBox[{"DownIndexQ", "[", "index", "]"}], "&&", 
         "$TexPrintInitialBracesQ"}], ",", "\"\<{}_{\>\"", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"firstindexQ", "&&", 
         RowBox[{"Not", "[", "$TexPrintInitialBracesQ", "]"}]}], ",", 
        "\"\<^{\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"firstindexQ", "&&", "$TexPrintInitialBracesQ"}], ",", 
        "\"\<{}^{\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"fromdownQ", "&&", 
         RowBox[{"DownIndexQ", "[", "index", "]"}]}], ",", "\"\<\>\"", ",", 
        "\[IndentingNewLine]", "fromdownQ", ",", "\"\<}{}^{\>\"", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"DownIndexQ", "[", "index", "]"}], ",", "\"\<}{}_{\>\"", ",", 
        "\[IndentingNewLine]", "True", ",", "\"\<\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"indexstring", ",", "preindexsymbol", ",", 
       RowBox[{"TexUpIndex", "[", 
        RowBox[{"UpIndex", " ", "@", "index"}], "]"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["5. TexBreak", "Section",
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell["5.1. TexBreak function", "Subsection"],

Cell["Jose\[CloseCurlyQuote]s old code for TexBreak:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexBreak", "[", 
    RowBox[{"string_String", ",", "n_Integer"}], "]"}], ":=", 
   RowBox[{"StringInsert", "[", 
    RowBox[{"string", ",", "\"\< \\\\nonumber \\\\\\\\ \\n\>\"", ",", 
     RowBox[{"Last", "/@", 
      RowBox[{"Split", "[", 
       RowBox[{
        RowBox[{"First", "/@", 
         RowBox[{"StringPosition", "[", 
          RowBox[{"string", ",", 
           RowBox[{"\"\< + \>\"", "|", "\"\< - \>\""}]}], "]"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"IntegerPart", "[", 
           RowBox[{"#1", "/", "n"}], "]"}], "===", 
          RowBox[{"IntegerPart", "[", 
           RowBox[{"#2", "/", "n"}], "]"}]}], "&"}]}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 Evaluatable->False],

Cell["\<\
Barry\[CloseCurlyQuote]s new code with the TexBreakBy option \
\[OpenCurlyDoubleQuote]TexPoint\[CloseCurlyDoubleQuote] added by Thomas:\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "TexBreak", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"TexBreakBy", "\[Rule]", "\"\<Character\>\""}], ",", 
     RowBox[{"TexBreakAt", "\[Rule]", 
      RowBox[{"\"\< + \>\"", "|", "\"\< - \>\""}]}], ",", 
     RowBox[{
     "TexBreakString", "\[Rule]", "\"\< \\\\nonumber \\\\\\\\ \\n&&\>\""}], 
     ",", 
     RowBox[{"EquationMarks", "\[Rule]", "False"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"BreakingFunction", "[", 
   RowBox[{"rulelist_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"best", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"rulelist", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "n"}], "&"}]}], 
       "]"}]}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "@", "best"}], "\[Equal]", "0"}], ",", 
      RowBox[{"Last", "@", 
       RowBox[{"First", "[", "rulelist", "]"}]}], ",", 
      RowBox[{"Last", "@", 
       RowBox[{"Last", "@", "best"}]}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TexBreak", "[", 
     RowBox[{"string_String", ",", "n_", ",", "l_List", ",", "options___"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "splittablePositions", ",", "breakat", ",", "breakby", ",", 
        "breakstring", ",", "splitat", ",", "positions", ",", "perLine", ",", 
        "splitted", ",", "texedwidth", ",", "splitstructure", ",", "mark", 
        ",", "pagewidth"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"breakat", ",", "breakby", ",", "breakstring", ",", "mark"}],
          "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "TexBreakAt", ",", "TexBreakBy", ",", "TexBreakString", ",", " ", 
            "EquationMarks"}], "}"}], "/.", 
          RowBox[{"CheckOptions", "[", "options", "]"}]}], "/.", 
         RowBox[{"Options", "[", "TexBreak", "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Positions", " ", "where", " ", "the", " ", "string", " ", "can", " ",
          "be", " ", 
         RowBox[{"split", ":", " ", 
          RowBox[{"wherever", " ", "+", " ", "or", " ", "-", " ", 
           RowBox[{"is", " ", "encountered"}]}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Older", " ", 
           RowBox[{"code", ":", " ", "splittablePositions"}]}], "=", 
          RowBox[{"First", "/@", 
           RowBox[{"StringPosition", "[", 
            RowBox[{"string", ",", "breakat"}], "]"}]}]}], ";"}], " ", "*)"}],
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Count", " ", "the", " ", "bracket", " ", "level", " ", "and", " ", 
         "split", " ", "only", " ", "when", " ", "breakat", " ", "appears", 
         " ", "at", " ", "bracket", " ", "level", " ", "0."}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "At", " ", "which", " ", "position", " ", "do", " ", "we", " ", 
         "find", " ", "breakat", " ", "or", " ", 
         RowBox[{"brackets", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"splittablePositions", "=", 
        RowBox[{"First", "/@", 
         RowBox[{"StringPosition", "[", 
          RowBox[{"string", ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{"breakat", ",", "\"\<{\>\""}], "]"}], ",", 
             "\"\<}\>\""}], "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "Construct", " ", "a", " ", "structure", " ", "of", " ", "the", " ", 
          "kind", " ", 
          RowBox[{"{", 
           RowBox[{"pos", ",", " ", "n", ",", " ", "notbracketQ"}], "}"}]}], 
         ",", " ", 
         RowBox[{
         "where", " ", "pos", " ", "is", " ", "the", " ", "position", " ", 
          "of", " ", "the", " ", "character"}], ",", " ", 
         RowBox[{
         "n", " ", "is", " ", "1", " ", "for", " ", "opening", " ", 
          "brackets"}], ",", " ", 
         RowBox[{
          RowBox[{"-", "1"}], " ", "for", " ", "closing", " ", "brackets", 
          " ", "and", " ", "0", " ", "for", " ", "everything", " ", 
          RowBox[{"else", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"splitstructure", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Switch", "[", 
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{"string", ",", 
              RowBox[{"{", "#", "}"}]}], "]"}], ",", "\"\<{\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"#", ",", "1", ",", "False"}], "}"}], ",", "\"\<}\>\"", 
            ",", 
            RowBox[{"{", 
             RowBox[{"#", ",", 
              RowBox[{"-", "1"}], ",", "False"}], "}"}], ",", "_", ",", 
            RowBox[{"{", 
             RowBox[{"#", ",", "0", ",", "True"}], "}"}]}], "]"}], "&"}], "/@",
          "splittablePositions"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "Compute", " ", "the", " ", "bracket", " ", "level", " ", "by", " ", 
          "accumulating", " ", "the", " ", 
          RowBox[{"n", "'"}], 
          RowBox[{"s", ".", " ", "Return"}], " ", "a", " ", "structure", " ", 
          
          RowBox[{"{", 
           RowBox[{"pos", ",", " ", "possiblebreakQ"}], "}"}]}], ",", " ", 
         RowBox[{
         "and", " ", "extract", " ", "the", " ", "possible", " ", "breaking", 
          " ", 
          RowBox[{"positions", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"splitstructure", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{"#2", "\[Equal]", "0"}], ",", 
               RowBox[{"#1", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}], "&"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"splitstructure", ",", 
            RowBox[{"Accumulate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
              "splitstructure"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"splittablePositions", "=", 
        RowBox[{"First", "/@", 
         RowBox[{"Select", "[", 
          RowBox[{"splitstructure", ",", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"The", " ", 
         RowBox[{"terms", "/", "characters"}], " ", "per", " ", "line", " ", 
         "that", " ", "the", " ", "user", " ", "specified"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"l", "\[NotEqual]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"perLine", "=", 
          RowBox[{"SparseArray", "[", 
           RowBox[{"l", ",", "Automatic", ",", "n"}], "]"}]}], ",", 
         RowBox[{"perLine", "=", 
          RowBox[{"{", "n", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Positions", " ", "at", " ", "which", " ", "the", " ", "string", " ", 
         "will", " ", "be", " ", "split"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "breakby", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\"\<Character\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"positions", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"iter", ",", 
              RowBox[{"currentPosition", "=", "0"}], ",", "nearestPosition", 
              ",", 
              RowBox[{"strlen", "=", 
               RowBox[{"StringLength", "[", "string", "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Split", " ", "parts", " ", "where", " ", "lengths", " ", "are", 
              " ", "given", " ", "explicitly"}], " ", "*)"}], 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"iter", "=", "1"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"iter", "\[LessEqual]", 
                  RowBox[{"Length", "[", "perLine", "]"}]}], ")"}], "&&", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"currentPosition", "+", 
                   RowBox[{"perLine", "[", 
                    RowBox[{"[", "iter", "]"}], "]"}]}], "<", "strlen"}], 
                 ")"}]}], ",", 
               RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"nearestPosition", "=", 
                 RowBox[{"Nearest", "[", 
                  RowBox[{
                   RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"splittablePositions", "-", "currentPosition"}], 
                    ",", "Positive"}], "]"}], ",", 
                   RowBox[{"perLine", "[", 
                    RowBox[{"[", "iter", "]"}], "]"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"nearestPosition", "\[NotEqual]", 
                   RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"currentPosition", "+=", 
                    RowBox[{"First", "@", "nearestPosition"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"positions", ",", "currentPosition"}], "]"}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"currentPosition", "=", "strlen"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{" ", 
               RowBox[{
               "Split", " ", "remainder", " ", "into", " ", "strings", " ", 
                "of", " ", 
                RowBox[{"length", "~", "n"}]}], ")"}], " ", "*)"}], 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"currentPosition", "+", "n"}], "<", "strlen"}], 
                ")"}], ",", 
               RowBox[{
                RowBox[{"nearestPosition", "=", 
                 RowBox[{"Nearest", "[", 
                  RowBox[{
                   RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"splittablePositions", "-", "currentPosition"}], 
                    ",", "Positive"}], "]"}], ",", "n"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"nearestPosition", "\[NotEqual]", 
                   RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"currentPosition", "+=", 
                    RowBox[{"First", "@", "nearestPosition"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"positions", ",", "currentPosition"}], "]"}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"currentPosition", "=", "strlen"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<Term\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "The", " ", "terms", " ", "at", " ", "which", " ", "we", " ", 
           "want", " ", "to", " ", "split"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"splitat", "=", 
           RowBox[{"Accumulate", "[", "perLine", "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Pad", " ", "out", " ", "every", " ", "n", " ", "terms"}], 
           " ", "*)"}], 
          RowBox[{"splitat", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"splitat", ",", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "[", "splitat", "]"}], "+", "n"}], ",", 
                RowBox[{"Length", "[", "splittablePositions", "]"}], ",", 
                "n"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Remove", " ", "split", " ", "points", " ", "which", " ", "are", 
            " ", "past", " ", "the", " ", "end", " ", "of", " ", "the", " ", 
            "string"}], " ", "*)"}], 
          RowBox[{"splitat", "=", 
           RowBox[{"Select", "[", 
            RowBox[{"splitat", ",", 
             RowBox[{
              RowBox[{"#", "\[LessEqual]", 
               RowBox[{"Length", "[", "splittablePositions", "]"}]}], "&"}]}],
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "The", " ", "positions", " ", "in", " ", "the", " ", "string", " ",
             "to", " ", "split", " ", "at"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"positions", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"splittablePositions", ",", "#"}], "]"}], "&"}], ",", 
             "splitat"}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\"\<TexPoint\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"positions", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"splitted", "=", 
           RowBox[{"StringTake", "[", 
            RowBox[{"string", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Prepend", "[", 
                 RowBox[{"splittablePositions", ",", "1"}], "]"}], ",", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"splittablePositions", "-", "1"}], ",", 
                  RowBox[{"StringLength", "@", "string"}]}], "]"}]}], "}"}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"texedwidth", "=", 
           RowBox[{"TexWidths", "@@", "splitted"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pagewidth", "=", 
           RowBox[{"First", "@", "texedwidth"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"texedwidth", "=", 
           RowBox[{"Rest", "@", "texedwidth"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", "nearestTerm", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Split", " ", "parts", " ", "where", " ", "lengths", " ", "are", 
              " ", "given", " ", "explicitly"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{"And", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", "perLine"}], ">", "0"}], ",", 
                 RowBox[{
                  RowBox[{"Length", "@", "splittablePositions"}], ">", 
                  "0"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"nearestTerm", "=", 
                 RowBox[{"BreakingFunction", "[", 
                  RowBox[{
                   RowBox[{"Thread", "@", 
                    RowBox[{"Rule", "[", 
                    RowBox[{
                    RowBox[{"Accumulate", "@", "texedwidth"}], ",", " ", 
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "@", "texedwidth"}]}]}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"perLine", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/.", 
                    RowBox[{"latextextwidth", "->", "pagewidth"}]}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"perLine", "=", 
                 RowBox[{"Rest", "@", 
                  RowBox[{"Normal", "@", "perLine"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"nearestTerm", "\[LessEqual]", 
                   RowBox[{"Length", "@", "splittablePositions"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"positions", ",", 
                    RowBox[{"splittablePositions", "[", 
                    RowBox[{"[", "nearestTerm", "]"}], "]"}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"splittablePositions", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"splittablePositions", ",", "nearestTerm"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"texedwidth", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"texedwidth", ",", "nearestTerm"}], "]"}]}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"splittablePositions", "=", 
                    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"texedwidth", "=", 
                    RowBox[{"{", "}"}]}], ";"}]}], "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{" ", 
               RowBox[{
               "Split", " ", "remainder", " ", "into", " ", "strings", " ", 
                "of", " ", 
                RowBox[{"length", "~", "n"}]}], ")"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "@", "splittablePositions"}], ">", "0"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"nearestTerm", "=", 
                 RowBox[{"BreakingFunction", "[", 
                  RowBox[{
                   RowBox[{"Thread", "@", 
                    RowBox[{"Rule", "[", 
                    RowBox[{
                    RowBox[{"Accumulate", "@", "texedwidth"}], ",", " ", 
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "@", "texedwidth"}]}]}], "]"}]}], ",", 
                   RowBox[{"n", "/.", 
                    RowBox[{"latextextwidth", "->", "pagewidth"}]}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"nearestTerm", "\[LessEqual]", 
                   RowBox[{"Length", "@", "splittablePositions"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"positions", ",", 
                    RowBox[{"splittablePositions", "[", 
                    RowBox[{"[", "nearestTerm", "]"}], "]"}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"splittablePositions", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"splittablePositions", ",", "nearestTerm"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"texedwidth", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"texedwidth", ",", "nearestTerm"}], "]"}]}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"splittablePositions", "=", 
                    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"texedwidth", "=", 
                    RowBox[{"{", "}"}]}], ";"}]}], "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "_", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
         "Throw", "[", "\"\<Invalid value for option TexBreakBy.\>\"", 
          "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Split", " ", "string"}], " ", "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"AddEquationMarks", "[", 
        RowBox[{
         RowBox[{"StringInsert", "[", 
          RowBox[{"string", ",", "breakstring", ",", "positions"}], "]"}], 
         ",", "mark"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Shortcuts", " ", "and", " ", "defaults"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TexBreak", "[", 
    RowBox[{"string_String", ",", "n_", ",", "options___"}], "]"}], ":=", 
   RowBox[{"TexBreak", "[", 
    RowBox[{"string", ",", "n", ",", 
     RowBox[{"{", "}"}], ",", "options"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexBreak", "[", 
    RowBox[{"string_String", ",", "options___"}], "]"}], ":=", 
   RowBox[{"TexBreak", "[", 
    RowBox[{"string", ",", "200", ",", 
     RowBox[{"{", "}"}], ",", "options"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["5.2. TexWidths", "Subsection"],

Cell["\<\
Thomas\[CloseCurlyQuote] code for determining the widths of a sequence of tex \
expressions measured in printer points. 
A file TexActWidthTest.tex is written and passed to the inline latex command. \
The widths are then extracted from the output.The first output is the latex \
textwidth environment variable.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Protect", "[", "latextextwidth", "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$TexDirectory", "=", "$TemporaryDirectory"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$TexTmpDirectory", "=", "$TemporaryDirectory"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$LatexExecutable", "=", "\"\<pdflatex\>\""}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "$TexInitLatexClassCode", "=", 
   "\"\<\\\\documentclass[10pt,a4paper]{article}\>\""}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexInitLatexPackages", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<{amssymb}\>\"", ",", " ", "\"\<{amsmath}\>\"", ",", " ", 
     "\"\<{amsthm}\>\"", ",", " ", "\"\<{latexsym}\>\""}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexInitLatexExtraCode", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexInitLatexCode", "[", "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{"$TexInitLatexClassCode", ",", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<\\\\usepackage\>\"", ",", "#", ",", "\"\<\\n\>\""}], 
        "]"}], "&"}], "/@", "$TexInitLatexPackages"}], "]"}], ",", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"#", ",", "\"\<\\n\>\""}], "]"}], "&"}], "/@", 
      "$TexInitLatexExtraCode"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexWidthsWriteFile", "[", "strs___", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tmpfile", "=", 
       RowBox[{"OpenWrite", "[", "\"\<TexActWidthTest.tex\>\"", "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"WriteString", "[", 
       RowBox[{"tmpfile", ",", 
        RowBox[{"TexInitLatexCode", "[", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{
       "tmpfile", ",", 
        "\"\<\\\\newlength{\\\\widthofexpr}\n\
\\\\newcommand{\\\\testwidth}[1]{\\\\settowidth{\\\\widthofexpr}{\\\\hbox{${}#\
1$}}}\n\\\\newcommand{\\\\writewidth}[1]{\\\\settowidth{\\\\widthofexpr}{\\\\\
hbox{${}#1$}}\n\\\\immediate\\\\write0{\\\\the\\\\widthofexpr}}\n\
\\\\begin{document}\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"WriteString", "[", 
         RowBox[{"tmpfile", ",", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<\\\\testwidth{\>\"", ",", "#", ",", "\"\<}\\n\>\""}], 
           "]"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "strs", "}"}]}], ";", 
      RowBox[{"WriteString", "[", 
       RowBox[{
       "tmpfile", ",", "\"\<\\\\immediate\\\\write0{xActWidthStart}\\n\>\""}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{
       "tmpfile", ",", 
        "\"\<\\\\immediate\\\\write0{\\\\the\\\\textwidth}\\n\>\""}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"WriteString", "[", 
         RowBox[{"tmpfile", ",", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<\\\\writewidth{\>\"", ",", "#", ",", "\"\<}\\n\>\""}],
            "]"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "strs", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{
       "tmpfile", ",", 
        "\"\<\\\\immediate\\\\write0{xActWidthEnd}\n\\\\end{document}\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "tmpfile", "]"}], ";"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtractTexWidths", "[", "str1_List", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"str2", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"str1", ",", 
        RowBox[{"First", "@", 
         RowBox[{"First", "@", 
          RowBox[{"Position", "[", 
           RowBox[{
           "str1", ",", "\"\<xActWidthStart\>\"", ",", "1", ",", "1"}], 
           "]"}]}]}]}], "]"}]}], "}"}], ",", 
    RowBox[{"ToExpression", "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{"#", ",", 
          RowBox[{"\"\<pt\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "&"}], "/@", 
       RowBox[{"Take", "[", 
        RowBox[{"str2", ",", 
         RowBox[{
          RowBox[{"First", "@", 
           RowBox[{"First", "@", 
            RowBox[{"Position", "[", 
             RowBox[{
             "str2", ",", "\"\<xActWidthEnd\>\"", ",", "1", ",", "1"}], 
             "]"}]}]}], "-", "1"}]}], "]"}]}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexWidths", "[", "strs___", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"TexOut", ",", "errorpos"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"SetDirectory", "[", "$TexTmpDirectory", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TexWidthsWriteFile", "[", "strs", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TexOut", "=", 
       RowBox[{"ReadList", "[", 
        RowBox[{
         RowBox[{
         "\"\<!\>\"", "<>", "$LatexExecutable", "<>", 
          "\"\< TexActWidthTest.tex\>\""}], ",", "String"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"errorpos", "=", 
       RowBox[{"DeleteFile", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<TexActWidthTest.tex\>\"", ",", "\"\<TexActWidthTest.log\>\"", 
          ",", "\"\<TexActWidthTest.aux\>\""}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"errorpos", "=!=", "Null"}], ",", 
        RowBox[{
        "Print", "[", "\"\<Tex Error: could not delete temporary files\>\"", 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ResetDirectory", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"Position", "[", 
           RowBox[{
           "TexOut", ",", "\"\<xActWidthEnd\>\"", ",", "1", ",", "1"}], 
           "]"}]}], "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ExtractTexWidths", "@", "TexOut"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"errorpos", "=", 
          RowBox[{"Position", "[", 
           RowBox[{"TexOut", ",", 
            RowBox[{"str_String", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"StringMatchQ", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                 "StartOfString", " ", "~~", " ", "\"\<!\>\"", "~~", 
                  "___"}]}], "]"}], "&"}], ")"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "errorpos"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Tex Error:\\n\>\"", ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"Drop", "[", 
               RowBox[{"TexOut", ",", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"First", "@", "errorpos"}]}], "-", "1"}]}], 
               "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Tex Error:\\n\>\"", ",", 
              RowBox[{"Sequence", "@@", "TexOut"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Throw", "[", "\"\<Tex Error\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["5.2. TexPrintAlignedEquations", "Subsection"],

Cell["\<\
Thomas\[CloseCurlyQuote] code for typesetting a list of equations in an \
aligned environment. Use $TexprintPageWidth to adjust the linebreaking.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexPrintPageWidth", "=", "latextextwidth"}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexPrintAlignedEquations", "[", "eq_Equal", "]"}], ":=", 
  RowBox[{"TexPrintAlignedEquations", "[", 
   RowBox[{"{", "eq", "}"}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"LHSpart", "[", 
   RowBox[{"a_", "\[Equal]", "b_"}], "]"}], ":=", "a"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"RHSpart", "[", 
   RowBox[{"a_", "\[Equal]", "b_"}], "]"}], ":=", "b"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"LHSpart", "[", "b_", "]"}], ":=", "\"\<\>\""}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"RHSpart", "[", "b_", "]"}], ":=", "b"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexPrintAlignedEquations", "[", 
   RowBox[{"eqlist", ":", 
    RowBox[{"{", "eqs___", "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TexLHS", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"TexPrint", "[", 
          RowBox[{"LHSpart", "@", "#"}], "]"}], "&"}], "/@", "eqlist"}]}], 
      ",", 
      RowBox[{"TexRHS", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"TexPrint", "[", 
          RowBox[{"RHSpart", "@", "#"}], "]"}], "&"}], "/@", "eqlist"}]}], 
      ",", "LHSWidths", ",", "MaxRHSWidth", ",", "pagewidth"}], "}"}], ",", 
    RowBox[{
     RowBox[{"LHSWidths", "=", 
      RowBox[{"xAct`TexAct`Private`TexWidths", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{"#", ",", "\"\< ={}\>\""}], "]"}], "&"}], "/@", "TexLHS"}],
         ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pagewidth", "=", 
      RowBox[{"First", "@", "LHSWidths"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"LHSWidths", "=", 
      RowBox[{"Rest", "@", "LHSWidths"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"MaxRHSWidth", "=", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"$TexPrintPageWidth", "/.", 
          RowBox[{"latextextwidth", "\[Rule]", "pagewidth"}]}], ")"}], "-", 
        RowBox[{"Max", "@", "LHSWidths"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"TexRHS", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"TexBreak", "[", 
         RowBox[{"#", ",", "1", ",", 
          RowBox[{"TexBreakBy", "\[Rule]", "\"\<Term\>\""}], ",", 
          RowBox[{"TexBreakString", "\[Rule]", "\"\<\\n\>\""}]}], "]"}], 
        "&"}], "/@", "TexRHS"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TexRHS", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"TexBreak", "[", 
         RowBox[{"#", ",", "MaxRHSWidth", ",", 
          RowBox[{"TexBreakBy", "\[Rule]", "\"\<TexPoint\>\""}], ",", 
          RowBox[{
          "TexBreakString", "\[Rule]", "\"\<\\\\nonumber\\\\\\\\\\n&\>\""}]}],
          "]"}], "&"}], "/@", "TexRHS"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TexRHS", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{"#", ",", 
          RowBox[{
          "\"\<\\n\\\\nonumber\>\"", "\[Rule]", "\"\<\\\\nonumber\>\""}]}], 
         "]"}], "&"}], "/@", "TexRHS"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<\\\\begin{align}\\n\>\"", ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{"Riffle", "[", 
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{"#1", ",", "\"\<={}&\>\"", ",", "#2"}], "]"}], "&"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"TexLHS", ",", "TexRHS"}], "}"}]}], "]"}], ",", 
            "\"\<,\\\\\\\\\\n\>\""}], "]"}], "]"}], ",", 
         RowBox[{
         "\"\<,\\\\\\\\\\n=\>\"", "\[Rule]", " ", "\"\<\\\\\\\\\\n=\>\""}]}], 
        "]"}], ",", "\"\<.\\n\\\\end{align}\>\""}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexPrintAlignedExpressions", "[", "list_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Texed", "=", 
      RowBox[{"TexPrint", "/@", "list"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Texed", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"TexBreak", "[", 
         RowBox[{"#", ",", "1", ",", 
          RowBox[{"TexBreakBy", "\[Rule]", "\"\<Term\>\""}], ",", 
          RowBox[{"TexBreakString", "\[Rule]", "\"\<\\n\>\""}]}], "]"}], 
        "&"}], "/@", "Texed"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Texed", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"TexBreak", "[", 
         RowBox[{"#", ",", "$TexPrintPageWidth", ",", 
          RowBox[{"TexBreakBy", "\[Rule]", "\"\<TexPoint\>\""}], ",", 
          RowBox[{
          "TexBreakString", "\[Rule]", "\"\<\\\\nonumber\\\\\\\\\\n&\>\""}]}],
          "]"}], "&"}], "/@", "Texed"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Texed", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{"#", ",", 
          RowBox[{
          "\"\<\\n\\\\nonumber\>\"", "\[Rule]", "\"\<\\\\nonumber\>\""}]}], 
         "]"}], "&"}], "/@", "Texed"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<\\\\begin{align}\\n&\>\"", ",", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"Riffle", "[", 
         RowBox[{"Texed", ",", "\"\<,\\\\\\\\\\n&\>\""}], "]"}], "]"}], ",", 
       "\"\<.\\n\\\\end{align}\>\""}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["6. TexView", "Section",
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell["6.1. TexView", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexViewExt", "=", "\"\<.pdf\>\""}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AddEquationMarks", "[", 
    RowBox[{"string_", ",", 
     RowBox[{"mark_:", "Automatic"}]}], "]"}], ":=", 
   RowBox[{"Switch", "[", 
    RowBox[{
    "mark", ",", "\[IndentingNewLine]", "False", ",", " ", "string", ",", 
     "\[IndentingNewLine]", "Automatic", ",", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"string", ",", "6"}], "]"}], "===", "\"\<\\\\begin\>\""}], 
       ",", "string", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "@", 
          RowBox[{"StringMatchQ", "[", 
           RowBox[{"string", ",", 
            RowBox[{"___", "~~", " ", "\"\<\\\\\\\\\>\"", "~~", "___"}]}], 
           "]"}]}], ",", 
         RowBox[{"AddEquationMarks", "[", 
          RowBox[{"string", ",", "\"\<equation\>\""}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"firstlinebreak", "=", 
             RowBox[{"Last", "@", 
              RowBox[{"First", "@", 
               RowBox[{"StringPosition", "[", 
                RowBox[{"string", ",", " ", "\"\<\\\\\\\\\>\"", ",", "1"}], 
                "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{"string", ",", "firstlinebreak"}], "]"}], ",", 
               RowBox[{"___", "~~", "\"\<&\>\"", "~~", "___"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AddEquationMarks", "[", 
              RowBox[{"string", ",", "\"\<eqnarray\>\""}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"StringMatchQ", "[", 
                RowBox[{
                 RowBox[{"StringTake", "[", 
                  RowBox[{"string", ",", "firstlinebreak"}], "]"}], ",", 
                 RowBox[{"___", "~~", "\"\<=\>\"", "~~", "___"}]}], "]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"AddEquationMarks", "[", 
                RowBox[{
                 RowBox[{"StringReplace", "[", 
                  RowBox[{"string", ",", 
                   RowBox[{"\"\<=\>\"", "\[Rule]", "\"\<&=&\>\""}], ",", 
                   "1"}], "]"}], ",", "\"\<eqnarray\>\""}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"AddEquationMarks", "[", 
                RowBox[{
                 RowBox[{"StringJoin", "[", 
                  RowBox[{"\"\<&&\>\"", ",", "string"}], "]"}], ",", 
                 "\"\<eqnarray\>\""}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
        "]"}]}], "]"}], ",", "\[IndentingNewLine]", "_", ",", " ", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
      "\"\<\\\\begin{\>\"", ",", "mark", ",", "\"\<}\\n\>\"", ",", " ", 
       "string", ",", " ", "\"\<\\n\\\\end{\>\"", ",", "mark", ",", 
       "\"\<}\\n\>\""}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexWriteFile", "[", 
    RowBox[{"str_String", ",", "file_String"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"outfile", "=", 
       RowBox[{"OpenWrite", "[", "file", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"WriteString", "[", 
       RowBox[{"outfile", ",", 
        RowBox[{"TexInitLatexCode", "[", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"outfile", ",", "\"\<\\\\begin{document}\\n\>\""}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"outfile", ",", "str"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{
       "outfile", ",", 
        "\"\<\\n\\\\immediate\\\\write0{TexActFinished}\n\
\\\\end{document}\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "outfile", "]"}], ";"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexView", "[", 
    RowBox[{"texstr_String", ",", 
     RowBox[{"file_String:", "\"\<TexActView\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"TexOut", ",", "errorpos"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"SetDirectory", "[", "$TexDirectory", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TexWriteFile", "[", 
       RowBox[{"texstr", ",", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"file", ",", "\"\<.tex\>\""}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TexOut", "=", 
       RowBox[{"ReadList", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"\"\<!\>\"", "<>", "$LatexExecutable", "<>", "\"\< \>\""}],
            ",", "file", ",", "\"\<.tex\>\""}], "]"}], ",", "String"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ResetDirectory", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"Position", "[", 
           RowBox[{
           "TexOut", ",", "\"\<TexActFinished\>\"", ",", "1", ",", "1"}], 
           "]"}]}], "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SetDirectory", "[", "$TexDirectory", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "\"\<Typesetting OK.\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Opening file: \>\"", ",", " ", "file", ",", "$TexViewExt"}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"SystemOpen", "[", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"file", ",", "$TexViewExt"}], "]"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ResetDirectory", "[", "]"}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"errorpos", "=", 
          RowBox[{"Position", "[", 
           RowBox[{"TexOut", ",", 
            RowBox[{"str_String", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"StringMatchQ", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                 "StartOfString", " ", "~~", " ", "\"\<!\>\"", "~~", 
                  "___"}]}], "]"}], "&"}], ")"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "errorpos"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Tex Error:\\n\>\"", ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"Drop", "[", 
               RowBox[{"TexOut", ",", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"First", "@", "errorpos"}]}], "-", "1"}]}], 
               "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Tex Error:\\n\>\"", ",", 
              RowBox[{"Sequence", "@@", "TexOut"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Throw", "[", "\"\<Tex Error\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TexView", "[", 
   RowBox[{
    RowBox[{"eqlist", ":", 
     RowBox[{"{", 
      RowBox[{"eq_Equal", ",", "eqs___"}], " ", "}"}]}], ",", "opt___"}], 
   "]"}], ":=", 
  RowBox[{"TexView", "[", 
   RowBox[{
    RowBox[{"TexPrintAlignedEquations", "[", "eqlist", "]"}], ",", "opt"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TexView", "[", 
   RowBox[{"list_List", ",", "opt___"}], "]"}], ":=", 
  RowBox[{"TexView", "[", 
   RowBox[{
    RowBox[{"TexPrintAlignedExpressions", "[", "list", "]"}], ",", "opt"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TexView", "[", 
   RowBox[{"eq_Equal", ",", "opt___"}], "]"}], ":=", 
  RowBox[{"TexView", "[", 
   RowBox[{
    RowBox[{"TexPrintAlignedEquations", "[", "eq", "]"}], ",", "opt"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TexView", "[", 
   RowBox[{"expr_", ",", "opt___"}], "]"}], ":=", 
  RowBox[{"TexView", "[", 
   RowBox[{
    RowBox[{"AddEquationMarks", "[", 
     RowBox[{
      RowBox[{"TexPrint", "[", "expr", "]"}], ",", "Automatic"}], "]"}], ",", 
    "opt"}], "]"}]}]}], "Input",
 InitializationCell->True]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["7. EndPackage", "Section",
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"End", "[", "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData["\<\"xAct`TexAct`Private`\"\>"], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"EndPackage", "[", "]"}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["8. Examples", "Section",
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"<<", "xAct`xCoba`"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`xCoba`  version \"\>", 
   "\[InvisibleSpace]", "\<\"0.8.1\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2013", ",", "7", ",", "1"}], "}"}]}],
  SequenceForm["Package xAct`xCoba`  version ", "0.8.1", ", ", {2013, 7, 1}],
  Editable->False]], "Print"],

Cell[BoxData["\<\"CopyRight (C) 2005-2013, David Yllanes and Jose M. \
Martin-Garcia, under the General Public License.\"\>"], "Print"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"],

Cell[BoxData["\<\"These packages come with ABSOLUTELY NO WARRANTY; for \
details type Disclaimer[]. This is free software, and you are welcome to \
redistribute it under certain conditions. See the General Public License for \
details.\"\>"], "Print"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefManifold", "[", 
  RowBox[{"M4", ",", "4", ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f", ",", "g"}],
     "}"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefManifold", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"manifold \"\>", "\[InvisibleSpace]", "M4", 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefManifold, ": Defining ", 
   "manifold ", $CellContext`M4, ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefVBundle", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"vbundle \"\>", "\[InvisibleSpace]", "TangentM4", 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefVBundle, ": Defining ", 
   "vbundle ", $CellContext`TangentM4, ". ", ""],
  Editable->False]], "Print"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"T", "[", 
    RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "M4", ",", 
   RowBox[{"PrintAs", "->", "\"\<\[Tau]\>\""}]}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"T", "[", 
    RowBox[{"a", ",", "b", ",", "c"}], "]"}], 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", xAct`xTensor`DefTensor, ": Defining ", "tensor ", 
   $CellContext`T[$CellContext`a, $CellContext`b, $CellContext`c], ". ", ""],
  Editable->False]], "Print"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "3"}], 
    RowBox[{"T", "[", 
     RowBox[{"a", ",", 
      RowBox[{"-", "b"}], ",", "c"}], "]"}]}], "+", 
   RowBox[{"7", 
    RowBox[{"T", "[", 
     RowBox[{"d", ",", "f"}], "]"}]}], "+", 
   RowBox[{"Pi", " ", 
    RowBox[{"T", "[", 
     RowBox[{"g", ",", "f"}], "]"}]}], "-", "5"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "5"}], "+", 
  RowBox[{"7", " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[Tau]", 
        StyleBox[GridBox[{
           {"d", "f"},
           {" ", " "}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T[$CellContext`d, $CellContext`f],
    Editable->False]}], "+", 
  RowBox[{"\[Pi]", " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[Tau]", 
        StyleBox[GridBox[{
           {"g", "f"},
           {" ", " "}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T[$CellContext`g, $CellContext`f],
    Editable->False]}], "-", 
  RowBox[{"3", " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[Tau]", 
        StyleBox[GridBox[{
           {"a", " ", "c"},
           {" ", "b", " "}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T[$CellContext`a, -$CellContext`b, $CellContext`c],
    Editable->False]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tex", "[", "expr1", "]"}]], "Input"],

Cell[BoxData["\<\"-5 + 7 \\\\tau^{df} + \\\\pi \\\\tau^{gf} + -3 \
\\\\tau^{a}{}_{b}{}^{c}\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "[", "expr1", "]"}]], "Input"],

Cell[BoxData["\<\"-5 + 7 \\\\tau^{df} + \\\\pi \\\\tau^{gf} - 3 \
\\\\tau^{a}{}_{b}{}^{c}\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddEquationMarks", "[", 
  RowBox[{"%", ",", "\"\<equation*\>\""}], "]"}]], "Input"],

Cell[BoxData["\<\"\\\\begin{equation*}\\n-5 + 7 \\\\tau^{df} + \\\\pi \
\\\\tau^{gf} - 3 \\\\tau^{a}{}_{b}{}^{c}\\n\\\\end{equation*}\\n\"\>"], \
"Output"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$CovDFormat", "=", "\"\<Prefix\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CovDQ", "[", "CD", "]"}], "^=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SymbolOfCovD", "[", "CD", "]"}], "^=", 
   RowBox[{"{", 
    RowBox[{"\"\<;\>\"", ",", "\"\<D\>\""}], "}"}]}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "[", 
  RowBox[{
   RowBox[{"CD", "[", 
    RowBox[{"-", "a"}], "]"}], "[", 
   RowBox[{"T", "[", 
    RowBox[{"b", ",", 
     RowBox[{"-", "c"}]}], "]"}], "]"}], "]"}]], "Input"],

Cell[BoxData["\<\"D_{a}\\\\tau^{b}{}_{c}\"\>"], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"$CovDFormat", "=", "\"\<Postfix\>\""}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "[", 
  RowBox[{
   RowBox[{"CD", "[", 
    RowBox[{"-", "a"}], "]"}], "[", 
   RowBox[{"T", "[", 
    RowBox[{"b", ",", 
     RowBox[{"-", "c"}]}], "]"}], "]"}], "]"}]], "Input"],

Cell[BoxData["\<\"\\\\tau^{b}{}_{c}{}_{;a}\"\>"], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"$CovDFormat", "=", "\"\<Prefix\>\""}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefBasis", "[", 
  RowBox[{"B4", ",", "TangentM4", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefBasis", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"basis \"\>", "\[InvisibleSpace]", "B4", 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xCoba`DefBasis, ": Defining ", "basis ", $CellContext`B4, ". ", 
   ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefCovD", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"parallel derivative \"\>", "\[InvisibleSpace]", 
   RowBox[{"PDB4", "[", 
    RowBox[{"-", "a"}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefCovD, ": Defining ", "parallel derivative ", 
   $CellContext`PDB4[-$CellContext`a], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"torsion tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"TorsionPDB4", "[", 
    RowBox[{"a", ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefTensor, ": Defining ", "torsion tensor ", 
   $CellContext`TorsionPDB4[$CellContext`a, -$CellContext`b, -$CellContext`c],
    ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"non-symmetric Christoffel tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"ChristoffelPDB4", "[", 
    RowBox[{"a", ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefTensor, ": Defining ", 
   "non-symmetric Christoffel tensor ", 
   $CellContext`ChristoffelPDB4[$CellContext`a, -$CellContext`b, \
-$CellContext`c], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"vanishing Riemann tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"RiemannPDB4", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}], ",", "d"}], "]"}], "\[InvisibleSpace]", "\<\". \"\>",
    "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefTensor, ": Defining ", "vanishing Riemann tensor ", 
   $CellContext`RiemannPDB4[-$CellContext`a, -$CellContext`b, \
-$CellContext`c, $CellContext`d], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"vanishing Ricci tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"RicciPDB4", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefTensor, ": Defining ", "vanishing Ricci tensor ", 
   $CellContext`RicciPDB4[-$CellContext`a, -$CellContext`b], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"antisymmetric +1 density \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"etaUpB4", "[", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefTensor, ": Defining ", "antisymmetric +1 density ", 
   $CellContext`etaUpB4[$CellContext`a, $CellContext`b, $CellContext`c, \
$CellContext`d], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"antisymmetric -1 density \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"etaDownB4", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}], ",", 
     RowBox[{"-", "d"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefTensor, ": Defining ", "antisymmetric -1 density ", 
   $CellContext`etaDownB4[-$CellContext`a, -$CellContext`b, -$CellContext`c, \
-$CellContext`d], ". ", ""],
  Editable->False]], "Print"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PDBasisExpr", "=", 
  RowBox[{
   RowBox[{"PDB4", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "B4"}]}], "}"}], "]"}], "[", 
   RowBox[{"T", "[", 
    RowBox[{"b", ",", 
     RowBox[{"-", "c"}]}], "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   RowBox[{
    SubscriptBox[
     StyleBox["\[ScriptCapitalD]",
      FontColor->RGBColor[1., 0., 0.]], 
     StyleBox["1",
      FontColor->RGBColor[1., 0., 0.]]], GridBox[{
      {"\[Tau]", 
       StyleBox[GridBox[{
          {"b", " "},
          {" ", "c"}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.], {
              Offset[0.034999999999999996`]}, 
             Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
              Offset[0.]}}, "RowsIndexed" -> {}}],
        FontSize->Rational[39, 4]]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.034999999999999996`]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}]}],
   ShowAutoStyles->False,
   AutoSpacing->False],
  $CellContext`PDB4[{1, -$CellContext`B4}][
   $CellContext`T[$CellContext`b, -$CellContext`c]],
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input"],

Cell[BoxData["\<\"\\\\mathcal{D}_{1}\\\\tau^{b}{}_{c}\"\>"], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"FormatTexBasis", "[", 
  RowBox[{
   RowBox[{"PDB4", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "B4"}]}], "}"}], "]"}], ",", "\"\<\\\\partial_r\>\""}], 
  "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "PDBasisExpr"}]], "Input"],

Cell[BoxData["\<\"\\\\partial_r\\\\tau^{b}{}_{c}\"\>"], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"FormatTexBasis", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "B4"}]}], "}"}], ",", "\"\<\\\\partial_r\>\""}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"FormatTexBasis", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "B4"}], "}"}], ",", "\"\<dr\>\""}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Basis", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "B4"}]}], "}"}], ",", "a"}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[GridBox[{
     {"e", 
      StyleBox[GridBox[{
         {" ", "a"},
         {
          StyleBox["1",
           FontColor->RGBColor[1., 0., 0.]], " "}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.], {
             Offset[0.034999999999999996`]}, 
            Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
             Offset[0.]}}, "RowsIndexed" -> {}}],
       FontSize->Rational[39, 4]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.034999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   ShowAutoStyles->False,
   AutoSpacing->False],
  xAct`xTensor`Basis[{1, -$CellContext`B4}, $CellContext`a],
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input"],

Cell[BoxData["\<\"\\\\partial_r^{a}\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Basis", "[", 
  RowBox[{
   RowBox[{"-", "a"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "B4"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[GridBox[{
     {"e", 
      StyleBox[GridBox[{
         {" ", 
          StyleBox["1",
           FontColor->RGBColor[1., 0., 0.]]},
         {"a", " "}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.], {
             Offset[0.034999999999999996`]}, 
            Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
             Offset[0.]}}, "RowsIndexed" -> {}}],
       FontSize->Rational[39, 4]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.034999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   ShowAutoStyles->False,
   AutoSpacing->False],
  xAct`xTensor`Basis[-$CellContext`a, {1, $CellContext`B4}],
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input"],

Cell[BoxData["\<\"dr_{a}\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"\[Lambda]", "[", "]"}], ",", "M4"}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"\[Lambda]", "[", "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", xAct`xTensor`DefTensor, ": Defining ", "tensor ", 
   $CellContext`\[Lambda][], ". ", ""],
  Editable->False]], "Print"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", 
   RowBox[{"Sqrt", "[", "2", "]"}]}], 
  RowBox[{"T", "[", 
   RowBox[{
    RowBox[{"-", "a"}], ",", 
    RowBox[{"-", "b"}], ",", 
    RowBox[{"-", "c"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  InterpretationBox[
   StyleBox[GridBox[{
      {"\[Tau]", 
       StyleBox[GridBox[{
          {" ", " ", " "},
          {"a", "b", "c"}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.], {
              Offset[0.034999999999999996`]}, 
             Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
              Offset[0.]}}, "RowsIndexed" -> {}}],
        FontSize->Rational[39, 4]]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.034999999999999996`]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`T[-$CellContext`a, -$CellContext`b, -$CellContext`c],
   Editable->False], 
  SqrtBox["2"]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input"],

Cell[BoxData["\<\"\\\\tfrac{1}{\\\\sqrt{2}}\\\\tau_{abc}\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", "3"}], 
  RowBox[{"Sqrt", "[", "2", "]"}], 
  RowBox[{"\[Lambda]", "[", "]"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SqrtBox["2"], " ", 
   InterpretationBox[
    StyleBox["\[Lambda]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[Lambda][],
    Editable->False]}], "3"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"2", "+", 
    RowBox[{"\[Lambda]", "[", "]"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    RowBox[{"\[Lambda]", "[", "]"}]}], ")"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", "+", 
   InterpretationBox[
    StyleBox["\[Lambda]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[Lambda][],
    Editable->False]}], 
  RowBox[{"1", "+", 
   InterpretationBox[
    StyleBox["\[Lambda]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[Lambda][],
    Editable->False]}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input"],

Cell[BoxData["\<\"\\\\frac{2 + \\\\lambda}{1 + \\\\lambda}\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"$TexFractionAsFraction", "=", "False"}], "}"}], ",", 
   RowBox[{"TexPrint", "[", "%%", "]"}]}], "]"}]], "Input"],

Cell[BoxData["\<\"(1 + \\\\lambda)^{-1} (2 + \\\\lambda)\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"1", "/", "3"}], "/", 
   RowBox[{"Sqrt", "[", "2", "]"}]}], "*", 
  RowBox[{"\[Lambda]", "[", "]"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  InterpretationBox[
   StyleBox["\[Lambda]",
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`\[Lambda][],
   Editable->False], 
  RowBox[{"3", " ", 
   SqrtBox["2"]}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input"],

Cell[BoxData["\<\"\\\\tfrac{1}{3 \\\\sqrt{2}}\\\\lambda\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"Sqrt", "[", "2", "]"}]}], "/", 
   RowBox[{"\[Lambda]", "[", "]"}]}], "/", "3"}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   SqrtBox["2"], 
   RowBox[{"3", " ", 
    InterpretationBox[
     StyleBox["\[Lambda]",
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[Lambda][],
     Editable->False]}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input"],

Cell[BoxData["\<\"- \\\\frac{\\\\sqrt{2}}{3 \\\\lambda}\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"$TexFractionAsFraction", "=", "False"}], "}"}], ",", 
   RowBox[{"TexPrint", "[", "%%", "]"}]}], "]"}]], "Input"],

Cell[BoxData["\<\"- \\\\tfrac{1}{3} \\\\sqrt{2} \\\\lambda^{-1}\"\>"], \
"Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", 
   RowBox[{"\[Lambda]", "[", "]"}]}], "/", "3"}]], "Input"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"3", " ", 
   InterpretationBox[
    StyleBox["\[Lambda]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[Lambda][],
    Editable->False]}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input"],

Cell[BoxData["\<\"\\\\frac{1}{3 \\\\lambda}\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"1", "/", 
    RowBox[{"\[Lambda]", "[", "]"}]}], "/", "3"}], "/", 
  RowBox[{"Sqrt", "[", "2", "]"}]}]], "Input"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"3", " ", 
   SqrtBox["2"], " ", 
   InterpretationBox[
    StyleBox["\[Lambda]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[Lambda][],
    Editable->False]}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input"],

Cell[BoxData["\<\"\\\\frac{1}{3 \\\\sqrt{2} \\\\lambda}\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", "3"}], "/", 
  RowBox[{"Sqrt", "[", "2", "]"}]}]], "Input"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"3", " ", 
   SqrtBox["2"]}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input"],

Cell[BoxData["\<\"\\\\tfrac{1}{3 \\\\sqrt{2}}\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[Lambda]", "[", "]"}], "-", "3"}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"1", "-", "\[Lambda]"}], ")"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "3"}], "+", 
   InterpretationBox[
    StyleBox["\[Lambda]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[Lambda][],
    Editable->False]}], 
  RowBox[{"1", "-", "\[Lambda]"}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input"],

Cell[BoxData["\<\"- \\\\frac{3 -  \\\\lambda}{1 -  \\\\lambda}\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"$TexFractionAsFraction", "=", "False"}], "}"}], ",", 
   RowBox[{"TexPrint", "[", "%%", "]"}]}], "]"}]], "Input"],

Cell[BoxData["\<\"(1 -  \\\\lambda)^{-1} (-3 + \\\\lambda)\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", 
   RowBox[{"Sqrt", "[", "2", "]"}]}], "*", 
  RowBox[{
   RowBox[{"T", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], "/", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"\[Lambda]", "[", "]"}]}], ")"}]}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  InterpretationBox[
   StyleBox[GridBox[{
      {"\[Tau]", 
       StyleBox[GridBox[{
          {" ", " ", " "},
          {"a", "b", "c"}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.], {
              Offset[0.034999999999999996`]}, 
             Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
              Offset[0.]}}, "RowsIndexed" -> {}}],
        FontSize->Rational[39, 4]]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.034999999999999996`]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`T[-$CellContext`a, -$CellContext`b, -$CellContext`c],
   Editable->False], 
  RowBox[{
   SqrtBox["2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     InterpretationBox[
      StyleBox["\[Lambda]",
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`\[Lambda][],
      Editable->False]}], ")"}]}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input"],

Cell[BoxData["\<\"\\\\frac{\\\\tau_{abc}}{\\\\sqrt{2} (1 + \
\\\\lambda)}\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"$TexFractionAsFraction", "=", "False"}], "}"}], ",", 
   RowBox[{"TexPrint", "[", "%%", "]"}]}], "]"}]], "Input"],

Cell[BoxData["\<\"\\\\tfrac{1}{\\\\sqrt{2}}\\\\tau_{abc} (1 + \
\\\\lambda)^{-1}\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Lambda]", "[", "]"}], "-", "3"}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"1", "-", "\[Lambda]"}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"1", "/", "3"}], "/", 
   RowBox[{"Sqrt", "[", "2", "]"}]}], "-", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"\[Lambda]", "[", "]"}]}], "/", "3"}], "/", 
   RowBox[{"Sqrt", "[", "2", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"3", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "3"}], "+", 
    InterpretationBox[
     StyleBox["\[Lambda]",
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[Lambda][],
     Editable->False]}], 
   RowBox[{"1", "-", "\[Lambda]"}]], "-", 
  FractionBox["1", 
   RowBox[{"3", " ", 
    SqrtBox["2"], " ", 
    InterpretationBox[
     StyleBox["\[Lambda]",
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[Lambda][],
     Editable->False]}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input"],

Cell[BoxData["\<\"\\\\tfrac{1}{3 \\\\sqrt{2}} -  \\\\frac{3 -  \\\\lambda}{1 \
-  \\\\lambda} -  \\\\frac{1}{3 \\\\sqrt{2} \\\\lambda}\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexBreak", "[", 
  RowBox[{"%", ",", "1", ",", 
   RowBox[{"TexBreakBy", "\[Rule]", "\"\<Term\>\""}]}], "]"}]], "Input"],

Cell[BoxData["\<\"\\\\tfrac{1}{3 \\\\sqrt{2}} \\\\nonumber \\\\\\\\ \\n&& -  \
\\\\frac{3 -  \\\\lambda}{1 -  \\\\lambda} \\\\nonumber \\\\\\\\ \\n&& -  \
\\\\frac{1}{3 \\\\sqrt{2} \\\\lambda}\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Scalar", "[", 
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}], ",", 
      RowBox[{"-", "c"}]}], "]"}], 
    RowBox[{"T", "[", 
     RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "]"}], "^", 
  RowBox[{"(", "2", ")"}]}]], "Input"],

Cell[BoxData[
 SuperscriptBox[
  InterpretationBox[
   StyleBox[
    RowBox[{
     StyleBox["(",
      FontColor->RGBColor[1, 0, 0]], 
     RowBox[{
      InterpretationBox[
       StyleBox[GridBox[{
          {"\[Tau]", 
           StyleBox[GridBox[{
              {" ", " ", " "},
              {"a", "b", "c"}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.], {
                  Offset[0.034999999999999996`]}, 
                 Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                  Offset[0.]}}, "RowsIndexed" -> {}}],
            FontSize->Rational[39, 4]]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Center}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.034999999999999996`]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`T[-$CellContext`a, -$CellContext`b, -$CellContext`c],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[GridBox[{
          {"\[Tau]", 
           StyleBox[GridBox[{
              {"a", "b", "c"},
              {" ", " ", " "}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.], {
                  Offset[0.034999999999999996`]}, 
                 Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                  Offset[0.]}}, "RowsIndexed" -> {}}],
            FontSize->Rational[39, 4]]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Center}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.034999999999999996`]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`T[$CellContext`a, $CellContext`b, $CellContext`c],
       Editable->False]}], 
     StyleBox[")",
      FontColor->RGBColor[1, 0, 0]]}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   xAct`xTensor`Scalar[$CellContext`T[-$CellContext`a, -$CellContext`b, \
-$CellContext`c] $CellContext`T[$CellContext`a, $CellContext`b, \
$CellContext`c]],
   Editable->False], "2"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input"],

Cell[BoxData["\<\"(\\\\tau_{abc} \\\\tau^{abc})^2\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Scalar", "[", 
  RowBox[{
   RowBox[{"T", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], 
   RowBox[{"T", "[", 
    RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   RowBox[{
    StyleBox["(",
     FontColor->RGBColor[1, 0, 0]], 
    RowBox[{
     InterpretationBox[
      StyleBox[GridBox[{
         {"\[Tau]", 
          StyleBox[GridBox[{
             {" ", " ", " "},
             {"a", "b", "c"}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.], {
                 Offset[0.034999999999999996`]}, 
                Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                 Offset[0.]}}, "RowsIndexed" -> {}}],
           FontSize->Rational[39, 4]]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Center}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.034999999999999996`]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`T[-$CellContext`a, -$CellContext`b, -$CellContext`c],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[GridBox[{
         {"\[Tau]", 
          StyleBox[GridBox[{
             {"a", "b", "c"},
             {" ", " ", " "}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.], {
                 Offset[0.034999999999999996`]}, 
                Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                 Offset[0.]}}, "RowsIndexed" -> {}}],
           FontSize->Rational[39, 4]]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Center}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.034999999999999996`]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`T[$CellContext`a, $CellContext`b, $CellContext`c],
      Editable->False]}], 
    StyleBox[")",
     FontColor->RGBColor[1, 0, 0]]}],
   ShowAutoStyles->False,
   AutoSpacing->False],
  xAct`xTensor`Scalar[$CellContext`T[-$CellContext`a, -$CellContext`b, \
-$CellContext`c] $CellContext`T[$CellContext`a, $CellContext`b, \
$CellContext`c]],
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input"],

Cell[BoxData["\<\"(\\\\tau_{abc} \\\\tau^{abc})\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"UndefBasis", "[", "B4", "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"non-symmetric Christoffel tensor\"\>", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "ChristoffelPDB4"}],
  
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", 
   "non-symmetric Christoffel tensor", " ", $CellContext`ChristoffelPDB4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"Ricci tensor\"\>", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "RicciPDB4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "Ricci tensor", 
   " ", $CellContext`RicciPDB4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"Riemann tensor\"\>", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "RiemannPDB4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "Riemann tensor", 
   " ", $CellContext`RiemannPDB4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"torsion tensor\"\>", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "TorsionPDB4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "torsion tensor", 
   " ", $CellContext`TorsionPDB4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefCovD", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"parallel derivative\"\>", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "PDB4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefCovD, ": Undefined ", "parallel derivative", 
   " ", $CellContext`PDB4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"antisymmetric +1 density\"\>", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "etaUpB4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "antisymmetric +1 density",
    " ", $CellContext`etaUpB4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"antisymmetric -1 density\"\>", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "etaDownB4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "antisymmetric -1 density",
    " ", $CellContext`etaDownB4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefBasis", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"basis\"\>", "\[InvisibleSpace]", "\<\" \"\>", 
   "\[InvisibleSpace]", "B4"}],
  SequenceForm[
  "** ", xAct`xCoba`UndefBasis, ": Undefined ", "basis", " ", $CellContext`B4],
  Editable->False]], "Print"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"UndefTensor", "/@", "$Tensors"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"tensor\"\>", "\[InvisibleSpace]", "\<\" \"\>", 
   "\[InvisibleSpace]", "T"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "tensor", 
   " ", $CellContext`T],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"tensor\"\>", "\[InvisibleSpace]", "\<\" \"\>", 
   "\[InvisibleSpace]", "\[Lambda]"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "tensor", 
   " ", $CellContext`\[Lambda]],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Null", ",", "Null"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"<<", "xAct`SymManipulator`"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`SymManipulator`  version \"\>", 
   "\[InvisibleSpace]", "\<\"0.8.6\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2013", ",", "9", ",", "15"}], "}"}]}],
  SequenceForm[
  "Package xAct`SymManipulator`  version ", "0.8.6", ", ", {2013, 9, 15}],
  Editable->False]], "Print"],

Cell[BoxData["\<\"CopyRight (C) 2011-2013, Thomas B\[ADoubleDot]ckdahl, under \
the General Public License.\"\>"], "Print"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"],

Cell[BoxData["\<\"These packages come with ABSOLUTELY NO WARRANTY; for \
details type Disclaimer[]. This is free software, and you are welcome to \
redistribute it under certain conditions. See the General Public License for \
details.\"\>"], "Print"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"T4", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}], ",", 
     RowBox[{"-", "d"}]}], "]"}], ",", "M4", ",", 
   RowBox[{"PrintAs", "\[Rule]", "\"\<T\>\""}]}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"T4", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}], ",", 
     RowBox[{"-", "d"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", xAct`xTensor`DefTensor, ": Defining ", "tensor ", 
   $CellContext`T4[-$CellContext`a, -$CellContext`b, -$CellContext`c, \
-$CellContext`d], ". ", ""],
  Editable->False]], "Print"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"\[CapitalSigma]2", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], ",", "M4", ",", 
   RowBox[{"PrintAs", "\[Rule]", "\"\<\[CapitalSigma]\>\""}]}], 
  "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"\[CapitalSigma]2", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", xAct`xTensor`DefTensor, ": Defining ", "tensor ", 
   $CellContext`\[CapitalSigma]2[-$CellContext`a, -$CellContext`b], ". ", ""],
  
  Editable->False]], "Print"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ImposeSym", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalSigma]2", "[", 
     RowBox[{"d", ",", 
      RowBox[{"-", "f"}]}], "]"}], 
    RowBox[{"T4", "[", 
     RowBox[{
      RowBox[{"-", "c"}], ",", 
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}], ",", "g"}], "]"}]}], ",", 
   RowBox[{"IndexList", "[", 
    RowBox[{
     RowBox[{"-", "f"}], ",", 
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", "d", ",", "g"}], "]"}], ",", 
   RowBox[{"JoinSGS", "[", 
    RowBox[{
     RowBox[{"Symmetric", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}], "]"}], ",", 
     RowBox[{"Antisymmetric", "[", 
      RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}], "]"}]}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[GridBox[{
     {
      RowBox[{
       UnderscriptBox["Sym", 
        StyleBox[
         RowBox[{
          RowBox[{"(", "36", ")"}], "[", "45", "]"}],
         FontSize->Tiny]], "[", "T", "\[CapitalSigma]", "]"}], 
      StyleBox[GridBox[{
         {" ", " ", " ", "g", "d", " "},
         {"c", "a", "b", " ", " ", "f"}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.], {
             Offset[0.034999999999999996`]}, 
            Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
             Offset[0.]}}, "RowsIndexed" -> {}}],
       FontSize->Rational[39, 4]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.034999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   ShowAutoStyles->False,
   AutoSpacing->False],
  xAct`SymManipulator`SymH[{$CellContext`T4, $CellContext`\[CapitalSigma]2}, 
   xAct`xPerm`StrongGenSet[{3, 4, 5, 6}, 
    xAct`xPerm`GenSet[-xAct`xPerm`Cycles[{4, 5}], 
     xAct`xPerm`Cycles[{3, 6}]]], 
   "(36)[45]"][-$CellContext`c, -$CellContext`a, -$CellContext`b, \
$CellContext`g, $CellContext`d, -$CellContext`f],
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input"],

Cell[BoxData["\<\"T_{ca(b}{}^{[g}\\\\Sigma^{d]}{}_{f)}\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "@", 
  RowBox[{"Antisymmetrize", "[", 
   RowBox[{
    RowBox[{"T4", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}], ",", 
      RowBox[{"-", "c"}], ",", 
      RowBox[{"-", "d"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}], ",", 
      RowBox[{"-", "c"}], ",", 
      RowBox[{"-", "d"}]}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "b", "c", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`b, -$CellContext`c, \
-$CellContext`d],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "b", "d", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`b, -$CellContext`d, \
-$CellContext`c],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "c", "b", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`c, -$CellContext`b, \
-$CellContext`d],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "c", "d", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`c, -$CellContext`d, \
-$CellContext`b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "d", "b", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`d, -$CellContext`b, \
-$CellContext`c],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "d", "c", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`d, -$CellContext`c, \
-$CellContext`b],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"b", "a", "c", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, -$CellContext`a, -$CellContext`c, \
-$CellContext`d],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"b", "a", "d", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, -$CellContext`a, -$CellContext`d, \
-$CellContext`c],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"b", "c", "a", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, -$CellContext`c, -$CellContext`a, \
-$CellContext`d],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"b", "c", "d", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, -$CellContext`c, -$CellContext`d, \
-$CellContext`a],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"b", "d", "a", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, -$CellContext`d, -$CellContext`a, \
-$CellContext`c],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"b", "d", "c", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, -$CellContext`d, -$CellContext`c, \
-$CellContext`a],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "a", "b", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`a, -$CellContext`b, \
-$CellContext`d],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "a", "d", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`a, -$CellContext`d, \
-$CellContext`b],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "b", "a", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`b, -$CellContext`a, \
-$CellContext`d],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "b", "d", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`b, -$CellContext`d, \
-$CellContext`a],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "d", "a", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`d, -$CellContext`a, \
-$CellContext`b],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "d", "b", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`d, -$CellContext`b, \
-$CellContext`a],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "a", "b", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`a, -$CellContext`b, \
-$CellContext`c],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "a", "c", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`a, -$CellContext`c, \
-$CellContext`b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "b", "a", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`b, -$CellContext`a, \
-$CellContext`c],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "b", "c", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`b, -$CellContext`c, \
-$CellContext`a],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "c", "a", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`c, -$CellContext`a, \
-$CellContext`b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "c", "b", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`c, -$CellContext`b, \
-$CellContext`a],
    Editable->False]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr2", "=", 
  RowBox[{"%", "/.", 
   RowBox[{
    RowBox[{"T4", "[", 
     RowBox[{
      RowBox[{"-", "b"}], ",", "c_", ",", "d_", ",", "a_"}], "]"}], 
    "\[RightTeeArrow]", 
    RowBox[{
     RowBox[{"T4", "[", 
      RowBox[{
       RowBox[{"-", "b"}], ",", "f", ",", "d", ",", "a"}], "]"}], 
     RowBox[{"\[CapitalSigma]2", "[", 
      RowBox[{"g", ",", 
       RowBox[{"-", "f"}]}], "]"}], 
     RowBox[{"\[CapitalSigma]2", "[", 
      RowBox[{"c", ",", 
       RowBox[{"-", "g"}]}], "]"}]}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "b", "c", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`b, -$CellContext`c, \
-$CellContext`d],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "b", "d", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`b, -$CellContext`d, \
-$CellContext`c],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "c", "b", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`c, -$CellContext`b, \
-$CellContext`d],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "c", "d", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`c, -$CellContext`d, \
-$CellContext`b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "d", "b", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`d, -$CellContext`b, \
-$CellContext`c],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "d", "c", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`d, -$CellContext`c, \
-$CellContext`b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "a", "b", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`a, -$CellContext`b, \
-$CellContext`d],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "a", "d", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`a, -$CellContext`d, \
-$CellContext`b],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "b", "a", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`b, -$CellContext`a, \
-$CellContext`d],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "b", "d", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`b, -$CellContext`d, \
-$CellContext`a],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "d", "a", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`d, -$CellContext`a, \
-$CellContext`b],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "d", "b", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`d, -$CellContext`b, \
-$CellContext`a],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "a", "b", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`a, -$CellContext`b, \
-$CellContext`c],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "a", "c", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`a, -$CellContext`c, \
-$CellContext`b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "b", "a", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`b, -$CellContext`a, \
-$CellContext`c],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "b", "c", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`b, -$CellContext`c, \
-$CellContext`a],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "c", "a", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`c, -$CellContext`a, \
-$CellContext`b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "c", "b", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`c, -$CellContext`b, \
-$CellContext`a],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", "e", " ", " "},
           {"b", " ", "c", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`c, \
-$CellContext`d],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"a", "f"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`a, -$CellContext`f],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {"f", " "},
           {" ", "e"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", "e", " ", " "},
           {"b", " ", "d", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`d, \
-$CellContext`c],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"a", "f"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`a, -$CellContext`f],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {"f", " "},
           {" ", "e"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", "e", " ", " "},
           {"b", " ", "a", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`a, \
-$CellContext`d],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"c", "f"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`c, -$CellContext`f],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {"f", " "},
           {" ", "e"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", "e", " ", " "},
           {"b", " ", "d", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`d, \
-$CellContext`a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"c", "f"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`c, -$CellContext`f],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {"f", " "},
           {" ", "e"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", "e", " ", " "},
           {"b", " ", "a", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`a, \
-$CellContext`c],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"d", "f"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`d, -$CellContext`f],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {"f", " "},
           {" ", "e"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", "e", " ", " "},
           {"b", " ", "c", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`c, \
-$CellContext`a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"d", "f"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`d, -$CellContext`f],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {"f", " "},
           {" ", "e"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
    Editable->False]}]}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexPrintPageWidth", "=", "latextextwidth"}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "expr2"}]], "Input"],

Cell[BoxData["\<\"\\\\tfrac{1}{24} T_{abcd} -  \\\\tfrac{1}{24} T_{abdc} -  \
\\\\tfrac{1}{24} T_{acbd} + \\\\tfrac{1}{24} T_{acdb} + \\\\tfrac{1}{24} \
T_{adbc} -  \\\\tfrac{1}{24} T_{adcb} + \\\\tfrac{1}{24} T_{cabd} -  \
\\\\tfrac{1}{24} T_{cadb} -  \\\\tfrac{1}{24} T_{cbad} + \\\\tfrac{1}{24} \
T_{cbda} + \\\\tfrac{1}{24} T_{cdab} -  \\\\tfrac{1}{24} T_{cdba} -  \
\\\\tfrac{1}{24} T_{dabc} + \\\\tfrac{1}{24} T_{dacb} + \\\\tfrac{1}{24} \
T_{dbac} -  \\\\tfrac{1}{24} T_{dbca} -  \\\\tfrac{1}{24} T_{dcab} + \
\\\\tfrac{1}{24} T_{dcba} -  \\\\tfrac{1}{24} T_{b}{}^{e}{}_{cd} \
\\\\Sigma_{af} \\\\Sigma^{f}{}_{e} + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{dc} \
\\\\Sigma_{af} \\\\Sigma^{f}{}_{e} + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{ad} \
\\\\Sigma_{cf} \\\\Sigma^{f}{}_{e} -  \\\\tfrac{1}{24} T_{b}{}^{e}{}_{da} \
\\\\Sigma_{cf} \\\\Sigma^{f}{}_{e} -  \\\\tfrac{1}{24} T_{b}{}^{e}{}_{ac} \
\\\\Sigma_{df} \\\\Sigma^{f}{}_{e} + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{ca} \
\\\\Sigma_{df} \\\\Sigma^{f}{}_{e}\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexBreak", "[", 
  RowBox[{"%", ",", "210", ",", " ", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"TexBreakBy", "\[Rule]", "\"\<TexPoint\>\""}]}], "]"}]], "Input"],

Cell[BoxData["\<\"\\\\tfrac{1}{24} T_{abcd} -  \\\\tfrac{1}{24} T_{abdc} -  \
\\\\tfrac{1}{24} T_{acbd} + \\\\tfrac{1}{24} T_{acdb} \\\\nonumber \\\\\\\\ \
\\n&& + \\\\tfrac{1}{24} T_{adbc} -  \\\\tfrac{1}{24} T_{adcb} + \
\\\\tfrac{1}{24} T_{cabd} -  \\\\tfrac{1}{24} T_{cadb} \\\\nonumber \\\\\\\\ \
\\n&& -  \\\\tfrac{1}{24} T_{cbad} + \\\\tfrac{1}{24} T_{cbda} + \
\\\\tfrac{1}{24} T_{cdab} -  \\\\tfrac{1}{24} T_{cdba} \\\\nonumber \\\\\\\\ \
\\n&& -  \\\\tfrac{1}{24} T_{dabc} + \\\\tfrac{1}{24} T_{dacb} + \
\\\\tfrac{1}{24} T_{dbac} -  \\\\tfrac{1}{24} T_{dbca} \\\\nonumber \\\\\\\\ \
\\n&& -  \\\\tfrac{1}{24} T_{dcab} + \\\\tfrac{1}{24} T_{dcba} -  \
\\\\tfrac{1}{24} T_{b}{}^{e}{}_{cd} \\\\Sigma_{af} \\\\Sigma^{f}{}_{e} \
\\\\nonumber \\\\\\\\ \\n&& + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{dc} \
\\\\Sigma_{af} \\\\Sigma^{f}{}_{e} + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{ad} \
\\\\Sigma_{cf} \\\\Sigma^{f}{}_{e} \\\\nonumber \\\\\\\\ \\n&& -  \
\\\\tfrac{1}{24} T_{b}{}^{e}{}_{da} \\\\Sigma_{cf} \\\\Sigma^{f}{}_{e} -  \
\\\\tfrac{1}{24} T_{b}{}^{e}{}_{ac} \\\\Sigma_{df} \\\\Sigma^{f}{}_{e} \
\\\\nonumber \\\\\\\\ \\n&& + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{ca} \
\\\\Sigma_{df} \\\\Sigma^{f}{}_{e}\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalSigma]2", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], 
   RowBox[{"\[CapitalSigma]2", "[", 
    RowBox[{
     RowBox[{"-", "c"}], ",", 
     RowBox[{"-", "d"}]}], "]"}]}], "==", "expr2"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"a", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`a, -$CellContext`b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"c", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`c, -$CellContext`d],
    Editable->False]}], "\[Equal]", 
  RowBox[{
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"a", "b", "c", "d"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`a, -$CellContext`b, -$CellContext`c, \
-$CellContext`d],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"a", "b", "d", "c"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`a, -$CellContext`b, -$CellContext`d, \
-$CellContext`c],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"a", "c", "b", "d"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`a, -$CellContext`c, -$CellContext`b, \
-$CellContext`d],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"a", "c", "d", "b"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`a, -$CellContext`c, -$CellContext`d, \
-$CellContext`b],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"a", "d", "b", "c"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`a, -$CellContext`d, -$CellContext`b, \
-$CellContext`c],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"a", "d", "c", "b"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`a, -$CellContext`d, -$CellContext`c, \
-$CellContext`b],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"c", "a", "b", "d"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`c, -$CellContext`a, -$CellContext`b, \
-$CellContext`d],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"c", "a", "d", "b"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`c, -$CellContext`a, -$CellContext`d, \
-$CellContext`b],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"c", "b", "a", "d"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`c, -$CellContext`b, -$CellContext`a, \
-$CellContext`d],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"c", "b", "d", "a"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`c, -$CellContext`b, -$CellContext`d, \
-$CellContext`a],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"c", "d", "a", "b"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`c, -$CellContext`d, -$CellContext`a, \
-$CellContext`b],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"c", "d", "b", "a"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`c, -$CellContext`d, -$CellContext`b, \
-$CellContext`a],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"d", "a", "b", "c"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`d, -$CellContext`a, -$CellContext`b, \
-$CellContext`c],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"d", "a", "c", "b"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`d, -$CellContext`a, -$CellContext`c, \
-$CellContext`b],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"d", "b", "a", "c"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`d, -$CellContext`b, -$CellContext`a, \
-$CellContext`c],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"d", "b", "c", "a"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`d, -$CellContext`b, -$CellContext`c, \
-$CellContext`a],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"d", "c", "a", "b"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`d, -$CellContext`c, -$CellContext`a, \
-$CellContext`b],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"d", "c", "b", "a"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`d, -$CellContext`c, -$CellContext`b, \
-$CellContext`a],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", "e", " ", " "},
            {"b", " ", "c", "d"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`c, \
-$CellContext`d],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {" ", " "},
            {"a", "f"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[-$CellContext`a, -$CellContext`f],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {"f", " "},
            {" ", "e"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", "e", " ", " "},
            {"b", " ", "d", "c"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`d, \
-$CellContext`c],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {" ", " "},
            {"a", "f"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[-$CellContext`a, -$CellContext`f],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {"f", " "},
            {" ", "e"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", "e", " ", " "},
            {"b", " ", "a", "d"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`a, \
-$CellContext`d],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {" ", " "},
            {"c", "f"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[-$CellContext`c, -$CellContext`f],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {"f", " "},
            {" ", "e"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", "e", " ", " "},
            {"b", " ", "d", "a"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`d, \
-$CellContext`a],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {" ", " "},
            {"c", "f"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[-$CellContext`c, -$CellContext`f],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {"f", " "},
            {" ", "e"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", "e", " ", " "},
            {"b", " ", "a", "c"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`a, \
-$CellContext`c],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {" ", " "},
            {"d", "f"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[-$CellContext`d, -$CellContext`f],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {"f", " "},
            {" ", "e"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", "e", " ", " "},
            {"b", " ", "c", "a"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`c, \
-$CellContext`a],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {" ", " "},
            {"d", "f"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[-$CellContext`d, -$CellContext`f],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {"f", " "},
            {" ", "e"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
     Editable->False]}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrintAlignedEquations", "@", "%"}]], "Input"],

Cell[BoxData["\<\"\\\\begin{align}\\n\\\\Sigma_{ab} \
\\\\Sigma_{cd}={}&\\\\tfrac{1}{24} T_{abcd}\\n -  \\\\tfrac{1}{24} \
T_{abdc}\\n -  \\\\tfrac{1}{24} T_{acbd}\\n + \\\\tfrac{1}{24} T_{acdb}\\n + \
\\\\tfrac{1}{24} T_{adbc}\\n -  \\\\tfrac{1}{24} T_{adcb}\\n + \
\\\\tfrac{1}{24} T_{cabd}\\\\nonumber\\\\\\\\\\n& -  \\\\tfrac{1}{24} \
T_{cadb}\\n -  \\\\tfrac{1}{24} T_{cbad}\\n + \\\\tfrac{1}{24} T_{cbda}\\n + \
\\\\tfrac{1}{24} T_{cdab}\\n -  \\\\tfrac{1}{24} T_{cdba}\\n -  \
\\\\tfrac{1}{24} T_{dabc}\\\\nonumber\\\\\\\\\\n& + \\\\tfrac{1}{24} T_{dacb}\
\\n + \\\\tfrac{1}{24} T_{dbac}\\n -  \\\\tfrac{1}{24} T_{dbca}\\n -  \
\\\\tfrac{1}{24} T_{dcab}\\n + \\\\tfrac{1}{24} \
T_{dcba}\\\\nonumber\\\\\\\\\\n& -  \\\\tfrac{1}{24} T_{b}{}^{e}{}_{cd} \
\\\\Sigma_{af} \\\\Sigma^{f}{}_{e}\\n + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{dc} \
\\\\Sigma_{af} \\\\Sigma^{f}{}_{e}\\n + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{ad} \
\\\\Sigma_{cf} \\\\Sigma^{f}{}_{e}\\\\nonumber\\\\\\\\\\n& -  \
\\\\tfrac{1}{24} T_{b}{}^{e}{}_{da} \\\\Sigma_{cf} \\\\Sigma^{f}{}_{e}\\n -  \
\\\\tfrac{1}{24} T_{b}{}^{e}{}_{ac} \\\\Sigma_{df} \\\\Sigma^{f}{}_{e}\\n + \
\\\\tfrac{1}{24} T_{b}{}^{e}{}_{ca} \\\\Sigma_{df} \
\\\\Sigma^{f}{}_{e}.\\n\\\\end{align}\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"UndefTensor", "/@", "$Tensors"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"tensor\"\>", "\[InvisibleSpace]", "\<\" \"\>", 
   "\[InvisibleSpace]", "T4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "tensor", 
   " ", $CellContext`T4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"tensor\"\>", "\[InvisibleSpace]", "\<\" \"\>", 
   "\[InvisibleSpace]", "\[CapitalSigma]2"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "tensor", 
   " ", $CellContext`\[CapitalSigma]2],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Null", ",", "Null"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"UndefManifold", "[", "M4", "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefVBundle", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"vbundle\"\>", "\[InvisibleSpace]", "\<\" \"\>", 
   "\[InvisibleSpace]", 
   InterpretationBox[
    StyleBox["\[DoubleStruckCapitalT]M4",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`TangentM4,
    Editable->False]}],
  SequenceForm[
  "** ", xAct`xTensor`UndefVBundle, ": Undefined ", "vbundle", 
   " ", $CellContext`TangentM4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefManifold", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"manifold\"\>", "\[InvisibleSpace]", "\<\" \"\>", 
   "\[InvisibleSpace]", "M4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefManifold, ": Undefined ", "manifold", 
   " ", $CellContext`M4],
  Editable->False]], "Print"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1005, 604},
WindowMargins->{{Automatic, 85}, {7, Automatic}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
ShowSelection->True,
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb",
$CellContext`TrackCellChangeTimes -> False
]
